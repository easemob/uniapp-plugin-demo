(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([["app-service"],{"00df":function(e,t,n){"use strict";n.r(t);var i=n("3bc1"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"0149":function(e,t,n){"use strict";n.r(t);var i=n("da2f"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"0170":function(e,t,n){"use strict";n.r(t);var i=n("fe6f"),o=n("d94d");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"01d4":function(e,t){e.exports={IMAGE:"img",TEXT:"txt",LOCATION:"location",VIDEO:"video",AUDIO:"audio",EMOJI:"emoji",FILE:"chat",chatType:{SINGLE_CHAT:"singleChat",CHAT_ROOM:"chatRoom"}}},"01d47":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("01d4"),r=n("25e4"),s=n("92be"),a={data:function(){return{inputMessage:"",userMessage:"",isIPX:!1}},components:{},props:{username:{type:Object,default:function(){return{}}},chatType:{type:String,default:o.chatType.SINGLE_CHAT}},created:function(){this.setData({isIPX:getApp().globalData.isIPX})},beforeMount:function(){},moved:function(){},destroyed:function(){},mounted:function(){},methods:{focus:function(){this.$emit("inputFocused",null,{bubbles:!0})},blur:function(){this.$emit("inputBlured",null,{bubbles:!0})},isGroupChat:function(){return this.chatType==o.chatType.CHAT_ROOM},getSendToParam:function(){return this.isGroupChat()?this.username.groupId:this.username.your},bindMessage:function(e){this.setData({userMessage:e.detail.value})},emojiAction:function(e){var t,n=this.userMessage.length-1;if(e&&"[del]"!=e)t=this.userMessage+e;else if("[del]"==e){var i=this.userMessage.lastIndexOf("["),o=this.userMessage.lastIndexOf("]"),r=o-i;t=-1!=o&&o==n&&r>=3&&r<=4?this.userMessage.slice(0,i):this.userMessage.slice(0,n)}this.userMessage=t,this.inputMessage=t},sendMessage:function(){var t=this;if(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},this.userMessage.trim()){var n=i.conn.getUniqueId(),s=new i.message(o.TEXT,n);s.set({msg:this.userMessage,from:this.username.myName,to:this.getSendToParam(),chatType:this.chatType,success:function(n,i){e("log","\u6210\u529f\u4e86"," at components/chat/inputbar/suit/main/main.vue:149"),t.$parent.cancelEmoji(),t.$parent.closeFunModal(),r.fire("em.chat.sendSuccess",n,t.userMessage)},fail:function(t,n){e("log","\u5931\u8d25\u4e86"," at components/chat/inputbar/suit/main/main.vue:156")}}),this.chatType==o.chatType.CHAT_ROOM&&s.setChatType("groupchat");try{i.conn.send(s.body);var a={msg:s,type:o.TEXT};this.saveSendMsg(a)}catch(c){e("log","error",c," at components/chat/inputbar/suit/main/main.vue:172")}this.userMessage="",this.inputMessage="",uni.hideKeyboard()}},saveSendMsg:function(e){s.saveMsg(e.msg,e.type)},openEmoji:function(){this.$emit("openEmoji")},openRecordModal:function(){this.$emit("openRecordModal")},openFunModal:function(){this.$emit("openFunModal")}}};t.default=a}).call(this,n("0de9")["default"])},"01d8":function(e,t,n){"use strict";n.r(t);var i=n("1ccd"),o=n("5736");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"02ef":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("7df6"));function o(e){return e&&e.__esModule?e:{default:e}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-mm-dd";e||(e=Number(new Date)),10==e.toString().length&&(e*=1e3);var n=+new Date(Number(e)),o=(Number(new Date)-n)/1e3,r="";switch(!0){case o<300:r="\u521a\u521a";break;case o>=300&&o<3600:r=parseInt(o/60)+"\u5206\u949f\u524d";break;case o>=3600&&o<86400:r=parseInt(o/3600)+"\u5c0f\u65f6\u524d";break;case o>=86400&&o<2592e3:r=parseInt(o/86400)+"\u5929\u524d";break;default:r=!1===t?o>=2592e3&&o<31536e3?parseInt(o/2592e3)+"\u4e2a\u6708\u524d":parseInt(o/31536e3)+"\u5e74\u524d":(0,i.default)(n,t)}return r}var s=r;t.default=s},"0300":function(e,t,n){"use strict";n.r(t);var i=n("4cca"),o=n("f505");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"0b99":function(e,t,n){"use strict";function i(e){return/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(e)}function o(e){return/^1[23456789]\d{9}$/.test(e)}function r(e){return/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w-.\/?%&=]*)?/.test(e)}function s(e){return!/Invalid|NaN/.test(new Date(e).toString())}function a(e){return/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)}function c(e){return/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)}function u(e){return/^\d+$/.test(e)}function d(e){return/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(e)}function l(e){var t=/^[\u4eac\u6d25\u6caa\u6e1d\u5180\u8c6b\u4e91\u8fbd\u9ed1\u6e58\u7696\u9c81\u65b0\u82cf\u6d59\u8d63\u9102\u6842\u7518\u664b\u8499\u9655\u5409\u95fd\u8d35\u7ca4\u9752\u85cf\u5ddd\u5b81\u743c\u4f7f\u9886A-Z]{1}[A-Z]{1}(([0-9]{5}[DF]$)|([DF][A-HJ-NP-Z0-9][0-9]{4}$))/,n=/^[\u4eac\u6d25\u6caa\u6e1d\u5180\u8c6b\u4e91\u8fbd\u9ed1\u6e58\u7696\u9c81\u65b0\u82cf\u6d59\u8d63\u9102\u6842\u7518\u664b\u8499\u9655\u5409\u95fd\u8d35\u7ca4\u9752\u85cf\u5ddd\u5b81\u743c\u4f7f\u9886A-Z]{1}[A-Z]{1}[A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9\u6302\u5b66\u8b66\u6e2f\u6fb3]{1}$/;return 7===e.length?n.test(e):8===e.length&&t.test(e)}function f(e){return/^[1-9]\d*(,\d{3})*(\.\d{1,2})?$|^0\.\d{1,2}$/.test(e)}function p(e){var t=/^[\u4e00-\u9fa5]+$/gi;return t.test(e)}function h(e){return/^[a-zA-Z]*$/.test(e)}function m(e){var t=/^[0-9a-zA-Z]*$/g;return t.test(e)}function g(e,t){return e.indexOf(t)>=0}function _(e,t){return e>=t[0]&&e<=t[1]}function v(e,t){return e.length>=t[0]&&e.length<=t[1]}function y(e){var t=/^\d{3,4}-\d{7,8}(-\d{3,4})?$/;return t.test(e)}function b(e){switch(typeof e){case"undefined":return!0;case"string":if(0==e.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"").length)return!0;break;case"boolean":if(!e)return!0;break;case"number":if(0===e||isNaN(e))return!0;break;case"object":if(null===e||0===e.length)return!0;for(var t in e)return!1;return!0}return!1}function w(e){if("string"==typeof e)try{var t=JSON.parse(e);return!("object"!=typeof t||!t)}catch(n){return!1}return!1}function S(e){return"function"===typeof Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function I(e){return"[object Object]"===Object.prototype.toString.call(e)}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return new RegExp("^\\d{".concat(t,"}$")).test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var x={email:i,mobile:o,url:r,date:s,dateISO:a,number:c,digits:u,idCard:d,carNo:l,amount:f,chinese:p,letter:h,enOrNum:m,contains:g,range:_,rangeLength:v,empty:b,isEmpty:b,jsonString:w,landline:y,object:I,array:S,code:C};t.default=x},"0bdb":function(e,t,n){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=e.WebIM=n("0c53")["default"],r=n("92be"),s=n("01d4"),a=n("25e4"),c=uni.emedia=n("e30e");function u(e){var t=e.id,n=new o.message("read",o.conn.getUniqueId());n.set({id:t,to:e.from}),o.conn.send(n.body)}function d(e){return"error"!==e.type||(uni.showToast({title:e.errorText}),!1)}function l(){var e=getCurrentPages();if(e.length>0){var t=e[e.length-1];return t.route}return"/"}function f(e){var t=uni.getStorageSync("myUsername");uni.getStorageInfo({success:function(n){var i=n.keys,o=[];i.forEach((function(e){e.indexOf(t)>-1&&-1==e.indexOf("rendered_")&&o.push(e)}));var r=o.reduce((function(e,t,n){var i;return i=uni.getStorageSync(t)||[],e+i.length}),0);getApp().globalData.unReadMessageNum=r,a.fire("em.unreadspot",e)}})}function p(){return o.conn.getGroup({limit:50,success:function(e){uni.setStorage({key:"listGroup",data:e.data})},error:function(e){i("log",e," at App.vue:101")}})}c.config({useUniappPlugin:!0});var h={globalData:{unReadMessageNum:0,userInfo:null,saveFriendList:[],saveGroupInvitedList:[],isIPX:!1,conn:{closed:!1,curOpenOpt:{},open:function(e){uni.showLoading({title:"\u6b63\u5728\u521d\u59cb\u5316\u5ba2\u6237\u7aef..",mask:!0}),this.curOpenOpt=e,o.conn.open(e),this.closed=!1},reopen:function(){this.closed&&(o.conn.open(this.curOpenOpt),this.closed=!1)}},onLoginSuccess:function(e){uni.hideLoading(),uni.redirectTo({url:"../chat/chat?myName="+e})},getUserInfo:function(e){var t=this;this.userInfo?"function"==typeof e&&e(this.userInfo):uni.login({success:function(){uni.getUserInfo({success:function(n){t.userInfo=n.userInfo,"function"==typeof e&&e(t.userInfo)}})}})},checkIsIPhoneX:function(){var e=this;uni.getSystemInfo({success:function(t){t.model&&-1!=t.model.search("iPhone X")&&(e.isIPX=!0)}})}},onLaunch:function(){var e=this,t=uni.getStorageSync("logs")||[];t.unshift(Date.now()),uni.setStorageSync("logs",t),a.on("em.main.ready",(function(){f()})),a.on("em.chatroom.leave",(function(){f()})),a.on("em.chat.session.remove",(function(){f()})),a.on("em.chat.audio.fileLoaded",(function(){f()})),a.on("em.main.deleteFriend",(function(){f()})),a.on("em.chat.audio.fileLoaded",(function(){f()})),o.conn.listen({onOpened:function(t){"pages/login/login"!=l()&&"pages/login_token/login_token"!=l()||e.globalData.onLoginSuccess(uni.getStorageSync("myUsername").toLowerCase())},onReconnect:function(){uni.showToast({title:"\u91cd\u8fde\u4e2d...",duration:2e3})},onSocketConnected:function(){uni.showToast({title:"socket\u8fde\u63a5\u6210\u529f",duration:2e3})},onClosed:function(){uni.showToast({title:"\u7f51\u7edc\u5df2\u65ad\u5f00",icon:"none",duration:2e3}),uni.redirectTo({url:"../login/login"}),e.globalData.conn.closed=!0,o.conn.close()},onInviteMessage:function(t){e.globalData.saveGroupInvitedList.push(t),a.fire("em.invite.joingroup",t)},onReadMessage:function(e){},onPresence:function(t){switch(t.type){case"unsubscribe":break;case"subscribe":for(var n=0;n<e.globalData.saveFriendList.length;n++)if(e.globalData.saveFriendList[n].from===t.from)return e.globalData.saveFriendList[n]=t,void a.fire("em.subscribe");r.saveReceiveMsg(t,"INFORM"),e.globalData.saveFriendList.push(t),a.fire("em.subscribe");break;case"subscribed":uni.showToast({title:"\u6dfb\u52a0\u6210\u529f",duration:1e3}),a.fire("em.subscribed");break;case"unsubscribed":a.fire("em.unsubscribed");break;case"direct_joined":p(),uni.showToast({title:"\u5df2\u8fdb\u7fa4",duration:1e3});break;case"memberJoinPublicGroupSuccess":p(),uni.showToast({title:"\u5df2\u8fdb\u7fa4",duration:1e3});break;case"invite":for(var i=0;i<e.globalData.saveGroupInvitedList.length;i++)if(e.globalData.saveGroupInvitedList[i].from===t.from)return e.globalData.saveGroupInvitedList[i]=t,void a.fire("em.invite.joingroup");e.globalData.saveGroupInvitedList.push(t),a.fire("em.invite.joingroup"),r.saveReceiveMsg(t,"INFORM");break;case"unavailable":a.fire("em.contacts.remove"),a.fire("em.group.leaveGroup",t);break;case"deleteGroupChat":a.fire("em.invite.deleteGroup",t);break;case"leaveGroup":a.fire("em.group.leaveGroup",t);break;case"removedFromGroup":a.fire("em.group.leaveGroup",t);break;default:break}},onRoster:function(e){},onVideoMessage:function(e){i("log","onVideoMessage: ",e," at App.vue:355"),e&&r.saveReceiveMsg(e,s.VIDEO),f(e),u(e)},onAudioMessage:function(e){i("log","onAudioMessage",e," at App.vue:366"),e&&(d(e)&&r.saveReceiveMsg(e,s.AUDIO),f(e),u(e))},onCmdMessage:function(e){i("log","onCmdMessage",e," at App.vue:379"),e&&(d(e)&&r.saveReceiveMsg(e,s.CMD),f(e),u(e))},onTextMessage:function(e){i("log","onTextMessage",e," at App.vue:398"),e&&(d(e)&&r.saveReceiveMsg(e,s.TEXT),f(e),u(e))},onEmojiMessage:function(e){i("log","onEmojiMessage",e," at App.vue:411"),e&&(d(e)&&r.saveReceiveMsg(e,s.EMOJI),f(e),u(e))},onPictureMessage:function(e){i("log","onPictureMessage",e," at App.vue:424"),e&&(d(e)&&r.saveReceiveMsg(e,s.IMAGE),f(e),u(e))},onFileMessage:function(e){i("log","onFileMessage",e," at App.vue:437"),e&&(d(e)&&r.saveReceiveMsg(e,s.FILE),f(e),u(e))},onError:function(e){i("log",e," at App.vue:451"),e.type==o.statusCode.WEBIM_CONNCTION_OPEN_ERROR&&(uni.hideLoading(),a.fire("em.error.passwordErr")),e.type==o.statusCode.WEBIM_CONNCTION_AUTH_ERROR&&(uni.hideLoading(),a.fire("em.error.tokenErr")),"socket_error"==e.type&&(i("log","socket_errorsocket_error",e," at App.vue:494"),uni.showToast({title:"\u7f51\u7edc\u5df2\u65ad\u5f00",icon:"none",duration:2e3}),a.fire("em.error.sendMsgErr",e))}}),this.globalData.checkIsIPhoneX()},methods:{}};t.default=h}).call(this,n("fe07")["default"],n("0de9")["default"])},"0c53":function(e,t,n){"use strict";var i=r(n("f098")),o=r(n("ce34"));function r(e){return e&&e.__esModule?e:{default:e}}console.group=console.group||{},console.groupEnd=console.groupEnd||{};var s={},a=s.WebIM=uni.WebIM=i.default;s.WebIM.config=o.default,a.isDebug=function(e){function t(e){}e&&(a.config.isDebug=e.isDebug,t(a.config.isDebug))},a.config.autoSignIn=!1,a.config.autoSignIn&&(a.config.autoSignInName="lwz2",a.config.autoSignInPwd="1"),a.parseEmoji=function(e){if("undefined"===typeof a.Emoji||"undefined"===typeof a.Emoji.map)return e;var t=a.Emoji,n=null,i=[],o=[];for(var r in t.map)if(t.map.hasOwnProperty(r))while(e.indexOf(r)>-1)e=e.replace(r,"^"+t.map[r]+"^");for(var s=e.split("^"),c=(n=/^e.*g$/,0);c<s.length;c++)""!=s[c]&&i.push(s[c]);for(c=0;c<i.length;c++)if(n.test(i[c])){var u={};u.data=i[c],u.type="emoji",o.push(u)}else{u={};u.data=i[c],u.type="txt",o.push(u)}return o},a.time=function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),i=e.getSeconds(),o=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+(t<10?"0"+t:t)+":"+(n<10?"0"+n:n)+":"+(i<10?"0"+i:i);return o},a.Emoji={path:"../static/images/faces/",map:{"[):]":"ee_1.png","[:D]":"ee_2.png","[;)]":"ee_3.png","[:-o]":"ee_4.png","[:p]":"ee_5.png","[(H)]":"ee_6.png","[:@]":"ee_7.png","[:s]":"ee_8.png","[:$]":"ee_9.png","[:(]":"ee_10.png","[:'(]":"ee_11.png","[<o)]":"ee_12.png","[(a)]":"ee_13.png","[8o|]":"ee_14.png","[8-|]":"ee_15.png","[+o(]":"ee_16.png","[|-)]":"ee_17.png","[:|]":"ee_18.png","[*-)]":"ee_19.png","[:-#]":"ee_20.png","[^o)]":"ee_21.png","[:-*]":"ee_22.png","[8-)]":"ee_23.png","[del]":"btn_del.png","[(|)]":"ee_24.png","[(u)]":"ee_25.png","[(S)]":"ee_26.png","[(*)]":"ee_27.png","[(#)]":"ee_28.png","[(R)]":"ee_29.png","[({)]":"ee_30.png","[(})]":"ee_31.png","[(k)]":"ee_32.png","[(F)]":"ee_33.png","[(W)]":"ee_34.png","[(D)]":"ee_35.png"}},a.EmojiObj={path:"../static/images/faces/",map1:{"[):]":"ee_1.png","[:D]":"ee_2.png","[;)]":"ee_3.png","[:-o]":"ee_4.png","[:p]":"ee_5.png","[(H)]":"ee_6.png","[:@]":"ee_7.png"},map2:{"[:s]":"ee_8.png","[:$]":"ee_9.png","[:(]":"ee_10.png","[:'(]":"ee_11.png","[<o)]":"ee_12.png","[(a)]":"ee_13.png","[8o|]":"ee_14.png"},map3:{"[8-|]":"ee_15.png","[+o(]":"ee_16.png","[|-)]":"ee_17.png","[:|]":"ee_18.png","[*-)]":"ee_19.png","[:-#]":"ee_20.png","[del]":"del.png"},map4:{"[^o)]":"ee_21.png","[:-*]":"ee_22.png","[8-)]":"ee_23.png","[(|)]":"ee_24.png","[(u)]":"ee_25.png","[(S)]":"ee_26.png","[(*)]":"ee_27.png"},map5:{"[(#)]":"ee_28.png","[(R)]":"ee_29.png","[({)]":"ee_30.png","[(})]":"ee_31.png","[(k)]":"ee_32.png","[(F)]":"ee_33.png","[(W)]":"ee_34.png","[(D)]":"ee_35.png"},map6:{"[del]":"del.png"}},a.conn=new a.connection({appKey:a.config.appkey,isMultiLoginSessions:a.config.isMultiLoginSessions,https:"boolean"===typeof a.config.https?a.config.https:"https:"===location.protocol,url:a.config.xmppURL,apiUrl:a.config.apiURL,isAutoLogin:!1,heartBeatWait:a.config.heartBeatWait,autoReconnectNumMax:a.config.autoReconnectNumMax,autoReconnectInterval:a.config.autoReconnectInterval,isDebug:!1}),e.exports={default:a}},"0c5d":function(e,t,n){"use strict";n.r(t);var i=n("b08a"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"0c91":function(e,t,n){"use strict";n.r(t);var i=n("7787"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"0d8c":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o={data:function(){return{friendList:[],groupName:"",groupDec:"",allowJoin:!0,allowApprove:!1,noAllowJoin:!1,allowInvite:!1,inviteFriend:[],owner:""}},props:{},onLoad:function(e){this.setData({owner:JSON.parse(e.owner).myName})},onShow:function(){var e=this;i.conn.getRoster({success:function(t){for(var n=[],i=0;i<t.length;i++)"both"==t[i].subscription&&n.push(t[i]);e.setData({friendList:n})}})},methods:{getGroupName:function(e){this.setData({groupName:e.detail.value})},getGroupDec:function(e){this.setData({groupDec:e.detail.value})},allowJoinFun:function(e){this.setData({allowJoin:Boolean(e.detail.value)||!1})},allowApproveFun:function(e){this.setData({allowApprove:Boolean(e.detail.value)||!1})},noAllowJoinFun:function(e){this.setData({noAllowJoin:Boolean(e.detail.value)||!1})},allowInviteFun:function(e){this.setData({allowInvite:Boolean(e.detail.value)||!1})},inviteFriendFun:function(e){this.setData({inviteFriend:e.detail.value})},createGroup:function(){var e=this,t=getApp().globalData.groupList;if(this.groupName.trim())if(t.reduce((function(t,n,i){return t||n.name==e.groupName}),!1))uni.showModal({title:"\u7fa4\u540d\u88ab\u5360\u7528",confirmText:"OK",showCancel:!1});else{var n={data:{groupname:this.groupName,desc:this.groupDec,members:this.inviteFriend,public:this.allowJoin,owner:this.owner},success:function(e){uni.showToast({title:"\u6dfb\u52a0\u6210\u529f",duration:2e3,success:function(e){setTimeout((function(){return uni.redirectTo({url:"../main/main?myName="+uni.getStorageSync("myUsername")})}),1e3)}})},error:function(e){uni.showToast({title:e.data.error_description,icon:"none"})}};i.conn.createGroupNew(n)}else uni.showModal({title:"\u8bf7\u8f93\u5165\u7fa4\u540d",confirmText:"OK",showCancel:!1})}}};t.default=o},"0de9":function(e,t,n){"use strict";function i(e){var t=Object.prototype.toString.call(e);return t.substring(8,t.length-1)}function o(){return"string"===typeof __channelId__&&__channelId__}function r(e,t){switch(i(t)){case"Function":return"function() { [native code] }";default:return t}}function s(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];console[e].apply(console,n)}function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=t.shift();if(o())return t.push(t.pop().replace("at ","uni-app:///")),console[s].apply(console,t);var a=t.map((function(e){var t=Object.prototype.toString.call(e).toLowerCase();if("[object object]"===t||"[object array]"===t)try{e="---BEGIN:JSON---"+JSON.stringify(e,r)+"---END:JSON---"}catch(o){e=t}else if(null===e)e="---NULL---";else if(void 0===e)e="---UNDEFINED---";else{var n=i(e).toUpperCase();e="NUMBER"===n||"BOOLEAN"===n?"---BEGIN:"+n+"---"+e+"---END:"+n+"---":String(e)}return e})),c="";if(a.length>1){var u=a.pop();c=a.join("---COMMA---"),0===u.indexOf(" at ")?c+=u:c+="---COMMA---"+u}else c=a[0];console[s](c)}n.r(t),n.d(t,"log",(function(){return s})),n.d(t,"default",(function(){return a}))},"0e6b":function(e,t,n){"use strict";n.r(t);var i=n("eeb3"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"10d6":function(e,t,n){"use strict";function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both";return"both"==t?e.replace(/^\s+|\s+$/g,""):"left"==t?e.replace(/^\s*/,""):"right"==t?e.replace(/(\s*$)/g,""):"all"==t?e.replace(/\s+/g,""):e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i;t.default=o},"12bc":function(e,t,n){"use strict";n.r(t);var i=n("3d95"),o=n("2e1d");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"138c":function(e,t,n){"use strict";n.r(t);var i=n("3d62"),o=n("ca3a");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},1550:function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.sort((function(){return Math.random()-.5}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i;t.default=o},"195c":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("01d4"),r=n("92be"),s={data:function(){return{}},components:{},props:{username:{type:Object,default:function(){return{}}},chatType:{type:String,default:o.chatType.SINGLE_CHAT}},methods:{isGroupChat:function(){return this.chatType==o.chatType.CHAT_ROOM},getSendToParam:function(){return this.isGroupChat()?this.username.groupId:this.username.your},sendLocation:function(){var t=this;uni.authorize({scope:"scope.userLocation",fail:function(){uni.showToast({title:"\u5df2\u62d2\u7edd",icon:"none"})},success:function(){uni.chooseLocation({fail:function(){e("log",arguments," at components/chat/inputbar/suit/location/location.vue:48")},complete:function(){e("log",arguments," at components/chat/inputbar/suit/location/location.vue:52")},success:function(e){var n=i.conn.getUniqueId(),r=new i.message(o.LOCATION,n);r.set({msg:"",from:t.username.myName,to:t.getSendToParam(),roomType:!1,lng:e.longitude,lat:e.latitude,addr:e.address,chatType:t.chatType,success:function(e,t){}}),t.chatType==o.chatType.CHAT_ROOM&&r.setGroup("groupchat"),i.conn.send(r.body);var s={msg:r,type:o.IMAGE};t.saveSendMsg(s)}})}})},saveSendMsg:function(e){r.saveMsg(e.msg,e.type)}}};t.default=s}).call(this,n("0de9")["default"])},"1adc":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("551b"),o=n("a833"),r={data:function(){return{playStatus:o,curStatus:o.STOP,time:"0'",opcity:1,__comps__:{audioCtx:null},style:""}},components:{},props:{msg:{type:Object,val:{}}},obeyMuteSwitch:!1,autoplay:!0,created:function(){},beforeMount:function(){this.setData({time:this.msg.msg.length+"''",style:this.msg.style})},moved:function(){},destroyed:function(){var e=this.$data.__comps__.audioCtx=i.getCtx(this.msg.mid);this.audioPause(e),this.delEvent()},mounted:function(){var e=this,t=this.$data.__comps__.audioCtx=i.getCtx(this.msg.mid);t.autoplay=!1,t.loop=!1,this.onPlaying=function(){e.setData({curStatus:o.PLAYING}),uni.inter&&clearInterval(uni.inter),uni.inter=setInterval((function(){var t=e.opcity;e.setData({opcity:1==t?.4:1})}),500)},this.onPause=function(){parseInt(e.time,10)<1||e.setData({curStatus:o.PAUSE,opcity:1})},this.onDone=function(){e.setData({curStatus:o.STOP,opcity:1}),clearInterval(uni.inter)},this.onTimeUpdate=function(){e.setData({time:(t.currentTime>>0)+"'"})},this.onWait=function(){uni.showToast({title:"\u4e0b\u8f7d\u4e2d...",duration:1e3})},this.addEvent()},methods:{audioPlay:function(){if("alipay"!==uni.getSystemInfo().app){uni.inter&&clearInterval(uni.inter);var t=this.$data.__comps__.audioCtx,n="";uni.downloadFile({url:this.msg.msg.data,header:{"X-Requested-With":"XMLHttpRequest",Accept:"audio/mp3",Authorization:"Bearer "+this.msg.msg.token},success:function(i){n=i.tempFilePath,e("log","\u97f3\u9891\u672c\u5730",t," at components/chat/msglist/type/audio/audio.vue:141"),t.src=n,t.play()},fail:function(t){e("log","downloadFile failed",t," at components/chat/msglist/type/audio/audio.vue:148"),uni.showToast({title:"\u4e0b\u8f7d\u5931\u8d25",duration:1e3})}})}else uni.showToast({duration:2e3,title:"\u652f\u4ed8\u5b9d\u5c0f\u7a0b\u5e8f\u4e0d\u652f\u6301\u97f3\u9891\u6d88\u606f"})},audioPause:function(e){var t=this.$data.__comps__.audioCtx=i.getCtx(this.msg.mid)||e;t&&t.pause()},addEvent:function(){var e=this.$data.__comps__.audioCtx;e.onPlay(this.onPlaying),e.onPause(this.onPause),e.onWaiting(this.onPause),e.onStop(this.onDone),e.onEnded(this.onDone),e.onError(this.onDone),e.onWaiting(this.onWait)},delEvent:function(){var e=this.$data.__comps__.audioCtx;e.offPlay(this.onPlaying),e.offPause(this.onPause),e.offWaiting(this.onPause),e.offStop(this.onDone),e.offEnded(this.onDone),e.offError(this.onDone),e.offWaiting(this.onWait)}}};t.default=r}).call(this,n("0de9")["default"])},"1b39":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e._$s(0,"i",e.showPop)?n("view",{staticClass:e._$s(0,"sc","shade"),attrs:{_i:0},on:{click:e.hidePop}},[n("view",{staticClass:e._$s(1,"sc","pop"),class:e._$s(1,"c",{show:e.showPop}),style:e._$s(1,"s",e.popStyle),attrs:{_i:1}},e._l(e._$s(2,"f",{forItems:e.popButton}),(function(t,i,o,r){return n("view",{key:e._$s(2,"f",{forIndex:o,key:i}),attrs:{"data-index":e._$s("2-"+r,"a-data-index",i),_i:"2-"+r},on:{click:e.pickerMenu}},[e._v(e._$s("2-"+r,"t0-0",e._s(t)))])})),0)]):e._e()},r=[]},"1ccd":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[e._$s(1,"i",e.search_btn)?n("view",{staticClass:e._$s(1,"sc","search"),attrs:{_i:1}},[n("view",{attrs:{_i:2},on:{click:e.openSearch}},[n("icon",{}),n("text")])]):e._e(),e._$s(5,"i",e.search_chats)?n("view",{staticClass:e._$s(5,"sc","search_input"),attrs:{_i:5}},[n("view",[n("icon",{}),n("input",{attrs:{value:e._$s(8,"a-value",e.input_code),_i:8},on:{confirm:e.onSearch,input:e.onInput}}),e._$s(9,"i",e.show_clear)?n("icon",{attrs:{_i:9},on:{click:function(t){return t.stopPropagation(),e.clearInput(t)}}}):e._e()]),n("text",{attrs:{_i:10},on:{click:e.cancel}})]):e._e(),e._$s(11,"i",e.show_clear)?n("view",{staticClass:e._$s(11,"sc","address_bottom"),attrs:{_i:11}},[n("image",{attrs:{_i:12}}),n("text",[e._v(e._$s(13,"t0-0",e._s(e.friend_name)))]),n("button",{attrs:{disabled:e._$s(14,"a-disabled",e.isdisable),_i:14},on:{click:e.add_friend}})]):e._e(),e._$s(15,"i",!e.show_clear)?n("view",{staticClass:e._$s(15,"sc","add_nobody"),attrs:{_i:15}}):e._e()])},r=[]},"1ce7":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","room_bar"),attrs:{_i:0}},[n("chatSuitEmoji",{ref:"chatSuitEmoji",attrs:{_i:1},on:{newEmojiStr:e.emojiAction}}),n("chatSuitMain",{ref:"chatSuitMain",attrs:{username:e.username,chatType:e.chatType,_i:2},on:{inputFocused:e.closeAllModal,openEmoji:e.openEmoji,openRecordModal:e.toggleRecordModal,openFunModal:e.openFunModal}}),n("chatSuitImage",{ref:"chatSuitImage",attrs:{username:e.username,chatType:e.chatType,_i:3}}),n("chatSuitPtopcall",{ref:"chatSuitPtopcall",attrs:{chatType:e.chatType,_i:4},on:{makeVideoCall:e.onMakeVideoCall}}),n("swiper",{class:e._$s(5,"c",e.showFunModal),attrs:{_i:5}},[n("swiper-item",[n("view",{class:e._$s(7,"c","other_func "+(e.isIPX?"other_func_X":"")),attrs:{_i:7}},[n("view",{staticClass:e._$s(8,"sc","open_camera"),attrs:{_i:8},on:{click:e.openCamera}},[n("image",{attrs:{_i:9}})]),n("view",{staticClass:e._$s(10,"sc","send_image"),attrs:{_i:10},on:{click:e.sendImage}},[n("image",{attrs:{_i:11}})]),n("view",{directives:[{name:"show",rawName:"v-show",value:e._$s(12,"v-show","chatRoom"===e.chatType),expression:"_$s(12,'v-show',chatType === 'chatRoom')"}],staticClass:e._$s(12,"sc","send_image"),attrs:{_i:12},on:{click:e.edit_group}},[n("image",{attrs:{_i:13}})]),e._$s(14,"i",e.username.groupId)?n("view",{staticClass:e._$s(14,"sc","v-record"),attrs:{_i:14},on:{click:e.callVideo}},[n("image",{attrs:{_i:15}})]):e._e()])])])],1)},r=[]},2171:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{attrs:{_i:0},on:{click:e.bindViewTap}},[n("view",{staticClass:e._$s(1,"sc","container"),attrs:{_i:1}},[n("view",{staticClass:e._$s(2,"sc","userinfo"),attrs:{_i:2}},[n("image",{staticClass:e._$s(3,"sc","userinfo-avatar"),attrs:{src:e._$s(3,"a-src",e.userInfo.avatarUrl),_i:3}}),n("text",{staticClass:e._$s(4,"sc","userinfo-nickname"),attrs:{_i:4}},[e._v(e._$s(4,"t0-0",e._s(e.userInfo.nickName)))])]),n("view",{staticClass:e._$s(5,"sc","usermotto"),attrs:{_i:5}},[n("text",{staticClass:e._$s(6,"sc","user-motto"),attrs:{_i:6}},[e._v(e._$s(6,"t0-0",e._s(e.motto)))])])]),n("view",{staticClass:e._$s(7,"sc","jump"),attrs:{_i:7}},[n("button")])])},r=[]},2188:function(e,t,n){"use strict";n.r(t);var i=n("4a1f"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"218e":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view")},r=[]},"21a6":function(e,t,n){"use strict";n.r(t);var i=n("4de6"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"22d6":function(e,t,n){"use strict";function i(){return uni.getSystemInfoSync().platform}function o(){return uni.getSystemInfoSync()}Object.defineProperty(t,"__esModule",{value:!0}),t.os=i,t.sys=o},2324:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","swipedelete-wrapper"),style:e._$s(0,"s","transform:translateX("+e.translateX+"rpx)"),attrs:{_i:0},on:{touchmove:e.touchMoveHandler,touchstart:e.touchStartHandler}},[e._t("default",null,{_i:1}),n("view",{staticClass:e._$s(2,"sc","swipedelete-btn"),attrs:{_i:2},on:{click:e.deleteItem}})],2)},r=[]},2424:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("25e4"),r={data:function(){return{search_btn:!0,search_friend:!1,show_mask:!1,groupList:[],myName:""}},components:{},props:{},onLoad:function(e){var t=this;o.on("em.invite.joingroup",(function(){var e=getCurrentPages();e[e.length-1].route===t.__route__&&t.listGroups()})),o.on("em.invite.deleteGroup",(function(){var e=getCurrentPages();e[e.length-1].route===t.__route__&&t.listGroups()})),this.setData({myName:e.myName})},onShow:function(){this.listGroups()},methods:{listGroups:function(){var e=this;i.conn.getGroup({limit:100,success:function(t){e.setData({groupList:t.data}),getApp().globalData.groupList=t.data||[]},error:function(){}})},openSearch:function(){this.setData({search_btn:!1,search_friend:!0,show_mask:!0})},cancel:function(){this.setData({search_btn:!0,search_friend:!1,show_mask:!1})},close_mask:function(){this.setData({search_btn:!0,search_friend:!1,show_mask:!1})},into_room:function(e){var t={myName:this.myName,your:e.currentTarget.dataset.username,groupId:e.currentTarget.dataset.roomid};uni.username=t,uni.navigateTo({url:"../groupChatRoom/groupChatRoom?username="+JSON.stringify(t)})},build_group:function(){var e=this,t={myName:e.myName};uni.navigateTo({url:"../add_groups/add_groups?owner="+JSON.stringify(t)})},edit_group:function(e){var t={myName:this.myName,groupName:e.currentTarget.dataset.username,roomId:e.currentTarget.dataset.roomid};uni.navigateTo({url:"../groupSetting/groupSetting?groupInfo="+JSON.stringify(t)})}}};t.default=r},2465:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e._$s(0,"i",e.visible)?n("view",{staticClass:e._$s(0,"sc","wraper"),attrs:{_i:0}},[n("view",[n("button",{attrs:{_i:2},on:{click:e.callVideo}}),n("button",{attrs:{_i:3},on:{click:e.cancel}})])]):e._e()},r=[]},"25e4":function(e,t,n){var i=n("c4a8");e.exports=new i},"275d":function(e,t,n){"use strict";n.r(t);var i=n("ee5d"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"2a9d":function(e,t){e.exports="/static/images/inform.png"},"2aa9":function(e,t,n){"use strict";n.r(t);var i=n("deec"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"2ac4":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","wraper"),attrs:{_i:0}},[n("view",{staticClass:e._$s(1,"sc","infoConnecting"),attrs:{_i:1}}),n("live-pusher",{ref:"livePusher",staticClass:e._$s(2,"sc","live-pusher"),attrs:{url:e._$s(2,"a-url",e.pubUrl),id:"livePusher",_i:2},on:{netstatus:e.netstatusChange,statechange:e.statechange,error:e.error}}),e._l(e._$s(3,"f",{forItems:e.subUrls}),(function(t,i,o,r){return e._$s("3-"+r,"i",e.subUrls.length>0)?n("view",{key:e._$s(3,"f",{forIndex:o,key:"3-"+r})},[n("video",{attrs:{id:e._$s("4-"+r,"a-id",t.streamId),src:e._$s("4-"+r,"a-src",t.subUrl),_i:"4-"+r}},[n("view",{staticClass:e._$s("5-"+r,"sc","userName"),attrs:{_i:"5-"+r}},[e._v(e._$s("5-"+r,"t0-0",e._s(t.memName)))])])]):e._e()}))],2)},r=[]},"2c05":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));try{i={uButton:n("c901").default}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. \u6392\u67e5\u7ec4\u4ef6\u540d\u79f0\u62fc\u5199\u662f\u5426\u6b63\u786e"),console.error("2. \u6392\u67e5\u7ec4\u4ef6\u662f\u5426\u7b26\u5408 easycom \u89c4\u8303\uff0c\u6587\u6863\uff1ahttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. \u82e5\u7ec4\u4ef6\u4e0d\u7b26\u5408 easycom \u89c4\u8303\uff0c\u9700\u624b\u52a8\u5f15\u5165\uff0c\u5e76\u5728 components \u4e2d\u6ce8\u518c\u8be5\u7ec4\u4ef6")}var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","inform"),attrs:{_i:0}},[e._$s(1,"i",!e.groupList.length>0)?n("text",{staticClass:e._$s(1,"sc","defaultText"),attrs:{_i:1}}):e._e(),e._l(e._$s(2,"f",{forItems:e.groupList}),(function(t,i,o,r){return n("view",{key:e._$s(2,"f",{forIndex:o,key:i}),staticClass:e._$s("2-"+r,"sc","itemBar"),attrs:{_i:"2-"+r}},[n("view",{staticClass:e._$s("3-"+r,"sc","notInfoDetContent"),attrs:{_i:"3-"+r}},[n("view",{staticClass:e._$s("4-"+r,"sc","headContent"),attrs:{_i:"4-"+r}},[n("image",{attrs:{_i:"5-"+r}})]),n("view",{staticClass:e._$s("6-"+r,"sc","infoContent"),attrs:{_i:"6-"+r}},[n("text",{staticClass:e._$s("7-"+r,"sc","itemName"),attrs:{_i:"7-"+r}},[e._v(e._$s("7-"+r,"t0-0",e._s(t.from)))]),n("text",[e._v(e._$s("8-"+r,"t0-0",e._s(t.gid)))])])]),n("view",{staticClass:e._$s("9-"+r,"sc","buttonContent"),attrs:{_i:"9-"+r}},[e._$s("10-"+r,"i",!t.typeText)?n("view",{staticClass:e._$s("10-"+r,"sc","rejectBtn"),attrs:{"data-from":e._$s("10-"+r,"a-data-from",t.gid),_i:"10-"+r},on:{click:e.reject}}):e._e(),e._$s("11-"+r,"i",!t.typeText)?n("view",{staticClass:e._$s("11-"+r,"sc","centerLine"),attrs:{_i:"11-"+r}}):e._e(),e._$s("12-"+r,"i",!t.typeText)?n("view",{staticClass:e._$s("12-"+r,"sc","agreeBtn"),attrs:{"data-from":e._$s("12-"+r,"a-data-from",t.gid),_i:"12-"+r},on:{click:e.agree}}):e._e(),e._$s("13-"+r,"i",t.typeText)?n("view",{staticClass:e._$s("13-"+r,"sc","actionDone"),attrs:{_i:"13-"+r}},[e._v(e._$s("13-"+r,"t0-0",e._s(t.typeText)))]):e._e()])])})),n("view",{staticClass:e._$s(14,"sc","black"),attrs:{_i:14}},[n("u-button",{attrs:{ripple:!0,_i:15},on:{click:e.into_chat}},[e._v("")])],1)],2)},r=[]},"2e1d":function(e,t,n){"use strict";n.r(t);var i=n("92ae"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"31fe":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={toast:10090,noNetwork:10080,popup:10075,mask:10070,navbar:980,topTips:975,sticky:970,indexListSticky:965};t.default=i},"358d":function(e,t,n){"use strict";n.r(t);var i=n("67e8"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},3722:function(e,t,n){"use strict";n.r(t);var i=n("2324"),o=n("6ffe");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"38cb":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("view",{staticClass:e._$s(1,"sc","login"),attrs:{_i:1}},[n("view",{staticClass:e._$s(2,"sc","login_title"),attrs:{_i:2}},[n("text")]),n("view",{class:e._$s(4,"c","login_user "+e.nameFocus),attrs:{_i:4}},[n("input",{attrs:{_i:5},on:{input:e.bindUsername,focus:e.onFocusName,blur:e.onBlurName}})]),n("view",{class:e._$s(6,"c","login_pwd "+e.psdFocus),attrs:{_i:6}},[n("input",{attrs:{_i:7},on:{input:e.bindPassword,focus:e.onFocusPsd,blur:e.onBlurPsd}})]),n("view",{staticClass:e._$s(8,"sc","login_btn"),attrs:{_i:8}},[n("button",{attrs:{_i:9},on:{click:e.login}})]),n("view",{staticClass:e._$s(10,"sc","login_text"),attrs:{_i:10}},[n("navigator",{}),n("navigator",{})])])])},r=[]},"3bc1":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("25e4"),r={data:function(){return{friendList:[],myName:""}},onLoad:function(e){var t=this;o.on("em.subscribe",(function(){t.setData({friendList:getApp().globalData.saveFriendList}),uni.setStorageSync("friendNotiData",getApp().globalData.saveFriendList)})),this.setData({myName:uni.getStorageSync("myUsername"),friendList:uni.getStorageSync("friendNotiData")})},onShow:function(){uni.hideHomeButton()},methods:{removeAndRefresh:function(e){var t;this.friendList.forEach((function(n,i){n.from===e&&(t=i)})),this.friendList.splice(t,1),getApp().globalData.saveFriendList.splice(t,1)},agree:function(e){var t=this;i.conn.subscribed({to:e.currentTarget.dataset.from,message:"[resp:true]"}),this.friendList.forEach((function(n){n.from==e.currentTarget.dataset.from&&(n.type="subscribed",n.typeText="\u5df2\u540c\u610f",uni.setStorageSync("friendNotiData",t.friendList),t.setData({friendList:t.friendList}))})),this.removeAndRefresh(e.currentTarget.dataset.from),this.getRoster()},getRoster:function(){var t={success:function(e){for(var t=[],n=0;n<e.length;n++)"both"==e[n].subscription&&t.push(e[n]);uni.setStorage({key:"member",data:t})},error:function(t){e("log",t," at pages/notification_friendDetail/friendDetail.vue:149")}};i.conn.getRoster(t)},reject:function(e){var t=this;i.conn.unsubscribed({to:e.currentTarget.dataset.from,message:"rejectAddFriend"}),this.friendList.forEach((function(n){n.from==e.currentTarget.dataset.from&&(n.type="unsubscribed",n.typeText="\u5df2\u62d2\u7edd",uni.setStorageSync("friendNotiData",t.friendList),t.setData({friendList:t.friendList}))})),this.removeAndRefresh(e.currentTarget.dataset.from)},into_chat:function(){uni.redirectTo({url:"../chat/chat"})}}};t.default=r}).call(this,n("0de9")["default"])},"3d62":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","inform"),attrs:{_i:0}},[e._$s(1,"i",!e.friendList.length>0)?n("text",{staticClass:e._$s(1,"sc","defaultText"),attrs:{_i:1}}):e._e(),e._l(e._$s(2,"f",{forItems:e.friendList}),(function(t,i,o,r){return n("view",{key:e._$s(2,"f",{forIndex:o,key:i}),staticClass:e._$s("2-"+r,"sc","itemBar"),attrs:{_i:"2-"+r}},[n("text",{staticClass:e._$s("3-"+r,"sc","itemName"),attrs:{_i:"3-"+r}},[e._v(e._$s("3-"+r,"t0-0",e._s(t.from)))]),n("button",{staticClass:e._$s("4-"+r,"sc","rejectBtn"),attrs:{"data-from":e._$s("4-"+r,"a-data-from",t.from),_i:"4-"+r},on:{click:e.reject}}),n("button",{staticClass:e._$s("5-"+r,"sc","agreeBtn"),attrs:{"data-from":e._$s("5-"+r,"a-data-from",t.from),_i:"5-"+r},on:{click:e.agree}})])}))],2)},r=[]},"3d95":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("view",{staticClass:e._$s(1,"sc","register"),attrs:{_i:1}},[n("image",{staticClass:e._$s(2,"sc","bg-img"),attrs:{_i:2}}),n("view",{staticClass:e._$s(3,"sc","register_title"),attrs:{_i:3}},[n("text")]),n("view",{class:e._$s(5,"c","register_user "+e.nameFocus),attrs:{_i:5}},[n("input",{attrs:{_i:6},on:{input:e.bindUsername,focus:e.onFocusName,blur:e.onBlurName}})]),n("view",{class:e._$s(7,"c","register_pwd "+e.psdFocus),attrs:{_i:7}},[n("input",{attrs:{type:e._$s(8,"a-type","password"==e.type?"text":e.type),password:e._$s(8,"a-password",!e.showPassword),_i:8},on:{input:e.bindPassword,focus:e.onFocusPsd,blur:e.onBlurPsd}}),n("image",{staticClass:e._$s(9,"sc","psdIcon"),attrs:{src:e._$s(9,"a-src",e.showPassword?"/static/images/eye.png":"/static/images/eye-fill.png"),_i:9},on:{click:function(t){e.showPassword=!e.showPassword}}})]),n("view",{staticClass:e._$s(10,"sc","register_btn"),attrs:{_i:10}},[n("button",{attrs:{_i:11},on:{click:e.register}})]),n("view",{staticClass:e._$s(12,"sc","register_back"),attrs:{_i:12}},[n("navigator",{})])])])},r=[]},"3ea4":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("25e4"),r={data:function(){return{friendList:[],myName:""}},components:{},props:{},onLoad:function(e){var t=this;o.on("em.subscribe",(function(){t.setData({friendList:getApp().globalData.saveFriendList})})),this.setData({myName:e.myName,friendList:getApp().globalData.saveFriendList})},methods:{removeAndRefresh:function(e){var t;this.friendList.forEach((function(n,i){n.from===e&&(t=i)})),this.friendList.splice(t,1),getApp().globalData.saveFriendList.splice(t,1),this.friendList.length?this.setData({friendList:this.friendList}):uni.navigateBack({url:"../main/main?myName="+this.myName})},agree:function(e){var t=this;i.conn.subscribed({to:e.currentTarget.dataset.from,message:"[resp:true]"}),i.conn.subscribe({to:e.currentTarget.dataset.from,message:"[resp:true]"}),setTimeout((function(){t.removeAndRefresh(e.currentTarget.dataset.from)}),1e3)},reject:function(e){var t=this;i.conn.unsubscribed({to:e.currentTarget.dataset.from,message:"rejectAddFriend"}),uni.showToast({title:"\u5df2\u62d2\u7edd",duration:1e3}),setTimeout((function(){t.removeAndRefresh(e.currentTarget.dataset.from)}),1e3)}}};t.default=r},4115:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:e._$s(0,"sc","u-btn u-line-1 u-fix-ios-appearance"),class:e._$s(0,"c",["u-size-"+e.size,e.plain?"u-btn--"+e.type+"--plain":"",e.loading?"u-loading":"","circle"==e.shape?"u-round-circle":"",e.hairLine?e.showHairLineBorder:"u-btn--bold-border","u-btn--"+e.type,e.disabled?"u-btn--"+e.type+"--disabled":""]),style:e._$s(0,"s",[e.customStyle,{overflow:e.ripple?"hidden":"visible"}]),attrs:{id:"u-wave-btn","hover-start-time":e._$s(0,"a-hover-start-time",Number(e.hoverStartTime)),"hover-stay-time":e._$s(0,"a-hover-stay-time",Number(e.hoverStayTime)),disabled:e._$s(0,"a-disabled",e.disabled),"form-type":e._$s(0,"a-form-type",e.formType),"open-type":e._$s(0,"a-open-type",e.openType),"app-parameter":e._$s(0,"a-app-parameter",e.appParameter),"hover-stop-propagation":e._$s(0,"a-hover-stop-propagation",e.hoverStopPropagation),"send-message-title":e._$s(0,"a-send-message-title",e.sendMessageTitle),lang:e._$s(0,"a-lang",e.lang),"data-name":e._$s(0,"a-data-name",e.dataName),"session-from":e._$s(0,"a-session-from",e.sessionFrom),"send-message-img":e._$s(0,"a-send-message-img",e.sendMessageImg),"show-message-card":e._$s(0,"a-show-message-card",e.showMessageCard),"hover-class":e._$s(0,"a-hover-class",e.getHoverClass),loading:e._$s(0,"a-loading",e.loading),_i:0},on:{getphonenumber:e.getphonenumber,getuserinfo:e.getuserinfo,error:e.error,opensetting:e.opensetting,launchapp:e.launchapp,click:function(t){return t.stopPropagation(),e.click(t)}}},[e._t("default",null,{_i:1}),e._$s(2,"i",e.ripple)?n("view",{staticClass:e._$s(2,"sc","u-wave-ripple"),class:e._$s(2,"c",[e.waveActive?"u-wave-active":""]),style:e._$s(2,"s",{top:e.rippleTop+"px",left:e.rippleLeft+"px",width:e.fields.targetWidth+"px",height:e.fields.targetWidth+"px","background-color":e.rippleBgColor||"rgba(0, 0, 0, 0.15)"}),attrs:{_i:2}}):e._e()],2)},r=[]},4219:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("735c"));function o(e){return e&&e.__esModule?e:{default:e}}var r=n("25e4"),s={data:function(){return{username:{your:""}}},components:{chat:i.default},props:{},onLoad:function(e){var t=JSON.parse(e.username);this.setData({username:t}),uni.username=t,uni.setNavigationBarTitle({title:t.your})},onUnload:function(){r.fire("em.chatroom.leave")},onPullDownRefresh:function(){uni.showNavigationBarLoading(),this.$refs.chat.getMore(),uni.hideNavigationBarLoading(),uni.stopPullDownRefresh()},methods:{onClickMsg:function(e){e.action="join",uni.navigateTo({url:"../emedia/index?srcData="+JSON.stringify(e)})}}};t.default=s},"425f":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("3722"));function o(e){return e&&e.__esModule?e:{default:e}}var r=n("0c53")["default"],s=n("25e4"),a=!1,c=[],u={data:function(){return{search_btn:!0,search_friend:!1,show_mask:!1,myName:"",member:[],messageNum:"",unReadSpotNum:0,unReadNoticeNum:0,unReadTotalNotNum:0,isActive:null,listMain:[],listTitles:[],toView:"inToView0",oHeight:[],scroolHeight:0,show_clear:!1,isHideLoadMore:!0,isIPX:!1,gotop:!1,input_code:"",showFixedTitile:!1}},components:{swipeDelete:i.default},props:{},onLoad:function(e){var t=this;getApp().globalData;s.on("em.subscribe",(function(){t.setData({messageNum:getApp().globalData.saveFriendList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length})})),s.on("em.contacts.remove",(function(e){var n=getCurrentPages();n[n.length-1].route===t.__route__&&t.getRoster()})),s.on("em.unreadspot",(function(){t.setData({unReadSpotNum:getApp().globalData.unReadMessageNum>99?"99+":getApp().globalData.unReadMessageNum})})),s.on("em.invite.joingroup",(function(){t.setData({unReadNoticeNum:getApp().globalData.saveGroupInvitedList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length})})),s.on("em.subscribed",(function(){var e=getCurrentPages();e[e.length-1].route===t.__route__&&t.getRoster()})),s.on("em.unsubscribed",(function(){var e=getCurrentPages();e[e.length-1].route===t.__route__&&t.getRoster()})),this.setData({myName:e.myName})},mounted:function(){this.getRoster()},onShow:function(){uni.hideHomeButton(),this.setData({messageNum:getApp().globalData.saveFriendList.length,unReadSpotNum:getApp().globalData.unReadMessageNum>99?"99+":getApp().globalData.unReadMessageNum,unReadNoticeNum:getApp().globalData.saveGroupInvitedList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length}),getApp().globalData.isIPX&&this.setData({isIPX:!0})},methods:{getRoster:function(){var t=this,n={success:function(e){for(var n=[],i=0;i<e.length;i++)"both"==e[i].subscription&&n.push(e[i]);uni.setStorage({key:"member",data:n}),t.setData({member:n}),a||(s.fire("em.main.ready"),a=!0),t.getBrands(n)},error:function(t){e("log","[main:getRoster]",t," at pages/main/main.vue:306")}};r.conn.getRoster(n)},moveFriend:function(e){var t=this,n={success:function(e){for(var n=[],i=0;i<e.length;i++)"both"==e[i].subscription&&n.push(e[i]);t.setData({member:n})}};"unsubscribe"!=e.type&&"unsubscribed"!=e.type||r.conn.removeRoster({to:e.from,success:function(){r.conn.unsubscribed({to:e.from}),r.conn.getRoster(n)}})},handleFriendMsg:function(e){uni.showModal({title:"\u6dfb\u52a0\u597d\u53cb\u8bf7\u6c42",content:e.from+"\u8bf7\u6c42\u52a0\u4e3a\u597d\u53cb",success:function(t){1==t.confirm?(r.conn.subscribed({to:e.from,message:"[resp:true]"}),r.conn.subscribe({to:e.from,message:"[resp:true]"})):r.conn.unsubscribed({to:e.from,message:"rejectAddFriend"})},fail:function(e){}})},delete_friend:function(e){var t=this,n=e.currentTarget.dataset.username,i=uni.getStorageSync("myUsername");uni.showModal({title:"\u786e\u8ba4\u5220\u9664\u597d\u53cb"+n,cancelText:"\u53d6\u6d88",confirmText:"\u5220\u9664",success:function(e){1==e.confirm&&(r.conn.removeRoster({to:n}),uni.showToast({title:"\u5220\u9664\u6210\u529f"}),uni.setStorageSync(n+i,""),uni.setStorageSync("rendered_"+n+i,""),t.getRoster(),s.fire("em.main.deleteFriend"))}})},openSearch:function(){this.setData({search_btn:!1,search_friend:!0,show_mask:!0,gotop:!0})},clearInput:function(){this.setData({input_code:"",show_clear:!1})},onInput:function(e){var t=e.detail.value;t?this.setData({show_clear:!0}):this.setData({show_clear:!1})},cancel:function(){this.setData({search_btn:!0,search_friend:!1,gotop:!1}),this.getBrands(this.member)},onSearch:function(e){var t=e.detail.value,n=this.member,i=[];n.forEach((function(e,n){-1!=String(e.name).indexOf(t)&&i.push(e)})),this.getBrands(i)},add_new:function(){uni.navigateTo({url:"../add_new/add_new"})},tab_chat:function(){uni.redirectTo({url:"../chat/chat"})},close_mask:function(){this.setData({search_btn:!0,search_friend:!1})},tab_setting:function(){uni.redirectTo({url:"../setting/setting"})},tab_notification:function(){uni.redirectTo({url:"../notification/notification"})},into_inform:function(){uni.navigateTo({url:"../inform/inform?myName="+this.myName})},into_groups:function(){uni.navigateTo({url:"../groups/groups?myName="+this.myName})},into_room:function(e){var t={myName:this.myName,your:e.target.dataset.username};uni.navigateTo({url:"../chatroom/chatroom?username="+JSON.stringify(t)})},into_info:function(e){uni.navigateTo({url:"../friend_info/friend_info?yourname="+e.target.dataset.username})},scrollToViewFn:function(e){for(var t=this,n=e.target.dataset.id,i=0;i<t.listMain.length;++i)if(t.listMain[i].id===n){t.setData({isActive:n,toView:"inToView"+n});break}},getBrands:function(e){var t=this,n=this,i=/[a-z]/i;e.forEach((function(e){i.test(e.name.substring(0,1))?e.initial=e.name.substring(0,1).toUpperCase():e.initial="#"})),e.sort((function(e,t){return e.initial.charCodeAt(0)-t.initial.charCodeAt(0)}));for(var o=null,r=[],s=0;s<e.length;s++){var a={brandId:e[s].jid,name:e[s].name};if("#"==e[s].initial){if(!u)var u={id:s,region:"#",brands:[]};u.brands.push(a)}else{if(e[s].initial!=o){o=e[s].initial;var d={id:s,region:o,brands:[]};r.push(d)}d.brands.push(a)}}r.sort((function(e,t){return e.region.charCodeAt(0)-t.region.charCodeAt(0)})),u&&r.push(u),n.setData({listMain:r}),n.setData({isActive:r.length>0?r[0].id:""});for(var l=0,f=function(e){var n=uni.createSelectorQuery().in(t);n.select("#inToView".concat(r[e].id)).boundingClientRect((function(n){if(n){l=n.height+l;var i=[{height:l,key:n.dataset.id,name:r[e].region}];c=c.concat(i)}else t.$nextTick((function(){}))})).exec()},p=0;p<r.length;++p)f(p)}}};t.default=u}).call(this,n("0de9")["default"])},4422:function(e,t,n){"use strict";n.r(t);var i=n("9cbd"),o=n("bb10");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"446c":function(e,t,n){"use strict";n.r(t);var i=n("77e3"),o=n("cd12");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"48e2":function(e,t,n){"use strict";n.r(t);var i=n("2171"),o=n("79fe");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},4972:function(e,t){e.exports={RecordDesc:{0:"\u957f\u6309\u5f00\u59cb\u5f55\u97f3",2:"\u5411\u4e0a\u6ed1\u52a8\u53d6\u6d88",3:"\u677e\u5f00\u624b\u53d6\u6d88"},RecordStatus:{SHOW:0,HIDE:1,HOLD:2,SWIPE:3,RELEASE:4}}},"4a1f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("735c"));function o(e){return e&&e.__esModule?e:{default:e}}var r=n("25e4"),s={data:function(){return{username:{your:""}}},components:{chat:i.default},props:{groupId:{type:String,default:""}},onLoad:function(e){var t=JSON.parse(e.username);this.setData({username:t}),uni.username=t,uni.setNavigationBarTitle({title:t.your})},onUnload:function(){r.fire("em.chatroom.leave")},onPullDownRefresh:function(){uni.showNavigationBarLoading(),this.$refs.chat.getMore(),uni.hideNavigationBarLoading(),uni.stopPullDownRefresh()},methods:{makeVideoCall:function(e){uni.navigateTo({url:"../emedia/index?srcData="+JSON.stringify(e)})},onClickMsg:function(e){}}};t.default=s},"4b97":function(e,t,n){"use strict";n.r(t);var i=n("f9c3"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"4bbc":function(e,t,n){"use strict";n.r(t);var i=n("938c"),o=n("0c91");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"4cca":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("view",{staticClass:e._$s(1,"sc","notification_title"),attrs:{_i:1}},[n("text")]),n("view",{staticClass:e._$s(3,"sc","address_bottom"),attrs:{_i:3},on:{click:e.into_friendNot}},[n("image",{attrs:{_i:4}}),n("text"),e._$s(6,"i",e.messageNum>0)?n("text",{staticClass:e._$s(6,"sc","notification_dot"),attrs:{_i:6}},[e._v(e._$s(6,"t0-0",e._s(e.messageNum)))]):e._e()]),n("view",{staticClass:e._$s(7,"sc","address_bottom"),attrs:{_i:7},on:{click:e.into_groupNot}},[n("image",{attrs:{_i:8}}),n("text"),e._$s(10,"i",e.groupInviteNum>0)?n("text",{staticClass:e._$s(10,"sc","notification_dot"),attrs:{_i:10}},[e._v(e._$s(10,"t0-0",e._s(e.groupInviteNum)))]):e._e()]),n("view",{class:e._$s(11,"c",e.isIPX?"chatRoom_tab_X":"chatRoom_tab"),attrs:{_i:11}},[n("view",{staticClass:e._$s(12,"sc","tableBar"),attrs:{_i:12},on:{click:e.tab_chat}},[e._$s(13,"i",e.unReadSpotNum>0)?n("view",{class:e._$s(13,"c","em-unread-spot "+("99+"==e.unReadSpotNum?"em-unread-spot-litleFont":"")),attrs:{_i:13}},[e._v(e._$s(13,"t0-0",e._s("99+"==e.unReadSpotNum?e.unReadSpotNum:e.unReadSpotNum+e.unReadTotalNotNum)))]):e._e(),n("image",{class:e._$s(14,"c",e.unReadSpotNum>0?"haveSpot":""),attrs:{_i:14}}),n("text",{staticClass:e._$s(15,"sc","activeText"),attrs:{_i:15}})]),n("view",{staticClass:e._$s(16,"sc","tableBar"),attrs:{_i:16},on:{click:e.tab_contact}},[n("image",{attrs:{_i:17}}),n("text")]),n("view",{staticClass:e._$s(19,"sc","tableBar"),attrs:{_i:19},on:{click:e.tab_setting}},[n("image",{attrs:{_i:20}}),n("text")])])])},r=[]},"4d3b":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("a34a"));function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,i,o,r,s){try{var a=e[r](s),c=a.value}catch(u){return void n(u)}a.done?t(c):Promise.resolve(c).then(i,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){r(s,i,o,a,c,"next",e)}function c(e){r(s,i,o,a,c,"throw",e)}a(void 0)}))}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}var d=function(){function e(){a(this,e),this.config={type:"navigateTo",url:"",delta:1,params:{},animationType:"pop-in",animationDuration:300,intercept:!1},this.route=this.route.bind(this)}return u(e,[{key:"addRootPath",value:function(e){return"/"===e[0]?e:"/".concat(e)}},{key:"mixinParam",value:function(e,t){e=e&&this.addRootPath(e);var n="";return/.*\/.*\?.*=.*/.test(e)?(n=uni.$u.queryParams(t,!1),e+"&"+n):(n=uni.$u.queryParams(t),e+n)}},{key:"route",value:function(){var e=s(i.default.mark((function e(){var t,n,o,r,s=arguments;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},n=s.length>1&&void 0!==s[1]?s[1]:{},o={},"string"===typeof t?(o.url=this.mixinParam(t,n),o.type="navigateTo"):(o=uni.$u.deepClone(t,this.config),o.url=this.mixinParam(t.url,t.params)),n.intercept&&(this.config.intercept=n.intercept),o.params=n,o=uni.$u.deepMerge(this.config,o),"function"!==typeof uni.$u.routeIntercept){e.next=14;break}return e.next=10,new Promise((function(e,t){uni.$u.routeIntercept(o,e)}));case 10:r=e.sent,r&&this.openPage(o),e.next=15;break;case 14:this.openPage(o);case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"openPage",value:function(e){var t=e.url,n=(e.type,e.delta),i=e.animationType,o=e.animationDuration;"navigateTo"!=e.type&&"to"!=e.type||uni.navigateTo({url:t,animationType:i,animationDuration:o}),"redirectTo"!=e.type&&"redirect"!=e.type||uni.redirectTo({url:t}),"switchTab"!=e.type&&"tab"!=e.type||uni.switchTab({url:t}),"reLaunch"!=e.type&&"launch"!=e.type||uni.reLaunch({url:t}),"navigateBack"!=e.type&&"back"!=e.type||uni.navigateBack({delta:n})}}]),e}(),l=(new d).route;t.default=l},"4d98":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("view",{staticClass:e._$s(1,"sc","setting_head"),attrs:{_i:1}},[n("view",{staticClass:e._$s(2,"sc","head_pic"),attrs:{_i:2}},[n("image",{attrs:{_i:3}}),n("view",[n("text",{staticClass:e._$s(5,"sc","setting_username"),attrs:{_i:5}},[e._v(e._$s(5,"t0-0",e._s(e.yourname)))]),n("text",{staticClass:e._$s(6,"sc","setting_username2"),attrs:{_i:6}})])])]),n("view",{staticClass:e._$s(7,"sc","setting_list"),attrs:{_i:7}},[n("view",{staticClass:e._$s(8,"sc","setting_listContent"),attrs:{_i:8},on:{click:e.goGeneralSetting}},[n("text"),n("image",{staticClass:e._$s(10,"sc","list_right"),attrs:{_i:10}})])]),n("view",{staticClass:e._$s(11,"sc","setting_list"),attrs:{_i:11}},[n("view",{staticClass:e._$s(12,"sc","setting_listContent"),attrs:{_i:12},on:{click:e.logout}},[n("text",{staticClass:e._$s(13,"sc","setting_redtext"),attrs:{_i:13}})])]),n("view",{class:e._$s(14,"c",e.isIPX?"chatRoom_tab_X":"chatRoom_tab"),attrs:{_i:14}},[n("view",{staticClass:e._$s(15,"sc","tableBar"),attrs:{_i:15},on:{click:e.tab_chat}},[e._$s(16,"i",e.unReadSpotNum>0||"99+"==e.unReadSpotNum)?n("view",{class:e._$s(16,"c","em-unread-spot "+("99+"==e.unReadSpotNum?"em-unread-spot-litleFont":"")),attrs:{_i:16}},[e._v(e._$s(16,"t0-0",e._s(e.unReadSpotNum+e.unReadTotalNotNum)))]):e._e(),n("image",{class:e._$s(17,"c",e.unReadSpotNum>0||"99+"==e.unReadSpotNum?"haveSpot":""),attrs:{_i:17}}),n("text")]),n("view",{staticClass:e._$s(19,"sc","tableBar"),attrs:{_i:19},on:{click:e.tab_contact}},[n("image",{attrs:{_i:20}}),n("text")]),n("view",{staticClass:e._$s(22,"sc","tableBar"),attrs:{_i:22}},[n("image",{attrs:{_i:23}}),n("text",{staticClass:e._$s(24,"sc","activeText"),attrs:{_i:24}})])])])},r=[]},"4de6":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=c(n("ad3a")),o=c(n("4422")),r=c(n("9896")),s=c(n("8234")),a=c(n("7338"));function c(e){return e&&e.__esModule?e:{default:e}}var u=n("4972").RecordStatus,d=n("01d4"),l={OPENED:"showFunModal",CLOSED:"fun_list"},f={data:function(){return{recordStatus:u.HIDE,RecordStatus:u,__comps__:{main:null,emoji:null,image:null,location:null,video:null},isIPX:"",showFunModal:l.CLOSED}},components:{chatSuitEmoji:i.default,chatSuitImage:o.default,chatSuitLocation:r.default,chatSuitMain:s.default,chatSuitPtopcall:a.default},props:{username:{type:Object,default:function(){return{}}},chatType:{type:String,default:d.chatType.SINGLE_CHAT}},created:function(){},beforeMount:function(){},moved:function(){},destroyed:function(){},onLoad:function(){this.setData({isIPX:!1})},methods:{toggleRecordModal:function(){this.$emit("tapSendAudio",null,{bubbles:!0,composed:!0})},openCamera:function(){this.$refs.chatSuitImage.openCamera()},openEmoji:function(){var e=this;setTimeout((function(){e.setData({showFunModal:l.CLOSED})}),100),this.$refs.chatSuitEmoji.openEmoji()},cancelEmoji:function(){this.$refs.chatSuitEmoji.cancelEmoji()},sendImage:function(){this.$refs.chatSuitImage.sendImage()},sendLocation:function(){},emojiAction:function(e){this.$refs.chatSuitMain.emojiAction(e.msg)},callVideo:function(){this.$refs.chatSuitPtopcall.show()},onMakeVideoCall:function(){e("log","onMakeVideoCall -> inputbar"," at components/chat/inputbar/inputbar.vue:199"),this.$emit("makeVideoCall",null,"single")},openFunModal:function(){this.setData({showFunModal:l.OPENED}),this.cancelEmoji()},closeFunModal:function(){this.setData({showFunModal:l.CLOSED}),this.cancelEmoji()},closeAllModal:function(){this.cancelEmoji(),this.closeFunModal()},edit_group:function(){var e={myName:this.username.myName,groupName:this.username.your,roomId:this.username.groupId};uni.navigateTo({url:"../groupSetting/groupSetting?groupInfo="+JSON.stringify(e)})}}};t.default=f}).call(this,n("0de9")["default"])},"508f":function(e,t,n){"use strict";n.r(t);var i=n("805c"),o=n("cdeb");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"50d5":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={primary:"#2979ff",primaryDark:"#2b85e4",primaryDisabled:"#a0cfff",primaryLight:"#ecf5ff",bgColor:"#f3f4f6",info:"#909399",infoDark:"#82848a",infoDisabled:"#c8c9cc",infoLight:"#f4f4f5",warning:"#ff9900",warningDark:"#f29100",warningDisabled:"#fcbd71",warningLight:"#fdf6ec",error:"#fa3534",errorDark:"#dd6161",errorDisabled:"#fab6b6",errorLight:"#fef0f0",success:"#19be6b",successDark:"#18b566",successDisabled:"#71d5a1",successLight:"#dbf1e1",mainColor:"#303133",contentColor:"#606266",tipsColor:"#909399",lightColor:"#c0c4cc",borderColor:"#e4e7ed"},o=i;t.default=o},5504:function(e,t,n){"use strict";n.r(t);var i=n("c678"),o=n("b1a0");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"551b":function(e,t){var n={},i=null,o={};function r(e){var t=e.play,n=e.pause;function o(){i&&i!=this&&i.pause(),t.call(this),i=this}function r(){i==this&&n.call(this)}e.play=o,e.pause=r}e.exports={getCtx:function(e){var t=n[e];return t||(t=uni.createInnerAudioContext(),n[e]=t,r(t)),t},getAllCtx:function(){return uni.setStorageSync("allCtx",JSON.stringify(Object.keys(n))),n},getCommponet:function(e,t){var n=o[e];return n||(o[e]=t),o}}},5597:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=T(n("e645")),o=T(n("6240")),r=T(n("79d8")),s=T(n("4d3b")),a=T(n("7df6")),c=T(n("02ef")),u=T(n("fc21")),d=T(n("88ee")),l=T(n("50d5")),f=T(n("d2e0")),p=T(n("1550")),h=T(n("c27b")),m=T(n("a8e9")),g=T(n("e0f1")),_=T(n("0b99")),v=T(n("765b")),y=T(n("10d6")),b=T(n("9a75")),w=T(n("6fd6")),S=T(n("b021")),I=n("22d6"),C=T(n("96e7")),x=T(n("8145")),E=T(n("fc17")),O=T(n("31fe"));function T(e){return e&&e.__esModule?e:{default:e}}function N(e){0}var R={queryParams:r.default,route:s.default,timeFormat:a.default,date:a.default,timeFrom:c.default,colorGradient:u.default.colorGradient,colorToRgba:u.default.colorToRgba,guid:d.default,color:l.default,sys:I.sys,os:I.os,type2icon:f.default,randomArray:p.default,wranning:N,get:o.default.get,post:o.default.post,put:o.default.put,delete:o.default.delete,hexToRgb:u.default.hexToRgb,rgbToHex:u.default.rgbToHex,test:_.default,random:v.default,deepClone:h.default,deepMerge:m.default,getParent:w.default,$parent:S.default,addUnit:g.default,trim:y.default,type:["primary","success","error","warning","info"],http:o.default,toast:b.default,config:E.default,zIndex:O.default,debounce:C.default,throttle:x.default};uni.$u=R;var M=function(e){e.mixin(i.default),e.prototype.openShare&&e.mixin(mpShare),e.filter("timeFormat",(function(e,t){return(0,a.default)(e,t)})),e.filter("date",(function(e,t){return(0,a.default)(e,t)})),e.filter("timeFrom",(function(e,t){return(0,c.default)(e,t)})),e.prototype.$u=R},k={install:M};t.default=k},5736:function(e,t,n){"use strict";n.r(t);var i=n("e27d"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"57f1":function(e,t,n){"use strict";n.r(t);var i=n("2424"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"5a2d":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"long-press-modal",props:{winSize:{type:Object,default:function(){return{witdh:375,height:603}}},showPop:{type:Boolean,default:!1},popButton:{type:Array,default:function(){return[]}},popStyle:{type:String,default:""},change:{type:Function}},methods:{hidePop:function(){this.$emit("hidePop")},pickerMenu:function(){this.$emit("change"),this.hidePop()}}};t.default=i},"5b4c":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("view",[i("view",[e._$s(2,"i",e.search_btn)?i("view",{staticClass:e._$s(2,"sc","search"),attrs:{_i:2}},[i("view",{attrs:{_i:3},on:{click:e.openSearch}},[i("icon",{}),i("text")])]):e._e()]),i("scroll-view",{class:e._$s(6,"c","chat_list_wraper "+(e.gotop?e.isIPX?"goTopX":"goTop":"goback")),style:e._$s(6,"s","padding-bottom: "+(e.isIPX?"270rpx":"226rpx")),attrs:{_i:6}},[e._$s(7,"i",e.search_chats)?i("view",{staticClass:e._$s(7,"sc","search_input"),attrs:{_i:7}},[i("view",[i("icon",{}),i("input",{attrs:{value:e._$s(10,"a-value",e.input_code),_i:10},on:{confirm:e.onSearch,input:e.onInput}}),e._$s(11,"i",e.show_clear)?i("icon",{attrs:{_i:11},on:{click:function(t){return t.stopPropagation(),e.clearInput(t)}}}):e._e()]),i("text",{attrs:{_i:12},on:{click:e.cancel}})]):e._e(),e._l(e._$s(13,"f",{forItems:e.arr}),(function(t,o,r,s){return i("view",{key:e._$s(13,"f",{forIndex:r,key:o}),staticClass:e._$s("13-"+s,"sc","chat_list"),attrs:{"data-item":e._$s("13-"+s,"a-data-item",t),_i:"13-"+s},on:{longpress:e.longpress,click:function(t){return t.stopPropagation(),e.del_chat(t)}}},[i("swipe-delete",{attrs:{_i:"14-"+s}},[e._$s("15-"+s,"i","INFORM"==t.chatType)?i("view",{staticClass:e._$s("15-"+s,"sc","tap_mask"),attrs:{"data-item":e._$s("15-"+s,"a-data-item",t),_i:"15-"+s},on:{click:function(t){return t.stopPropagation(),e.into_inform(t)}}},[i("view",{staticClass:e._$s("16-"+s,"sc","list_box"),attrs:{_i:"16-"+s}},[i("view",{staticClass:e._$s("17-"+s,"sc","list_left"),attrs:{_i:"17-"+s}},[i("view",{staticClass:e._$s("18-"+s,"sc","list_pic"),attrs:{_i:"18-"+s}},[e._$s("19-"+s,"i",e.unReadTotalNotNum>0)?i("view",{staticClass:e._$s("19-"+s,"sc","em-unread-spot2"),attrs:{_i:"19-"+s}},[e._v(e._$s("19-"+s,"t0-0",e._s(e.unReadTotalNotNum)))]):e._e(),i("image",{class:e._$s("20-"+s,"c",e.unReadTotalNotNum>0?"haveSpot":""),attrs:{src:e._$s("20-"+s,"a-src",n("2a9d")),_i:"20-"+s}})]),i("view",{staticClass:e._$s("21-"+s,"sc","list_text"),attrs:{_i:"21-"+s}},[i("text",{staticClass:e._$s("22-"+s,"sc","list_user"),attrs:{_i:"22-"+s}}),e._$s("23-"+s,"i","INFORM"==t.chatType)?i("text",{staticClass:e._$s("23-"+s,"sc","list_word"),attrs:{_i:"23-"+s}},[e._v(e._$s("23-"+s,"t0-0",e._s(t.info.from)))]):e._e()])]),i("view",{staticClass:e._$s("24-"+s,"sc","list_right"),attrs:{_i:"24-"+s}},[i("text",{attrs:{"data-username":e._$s("25-"+s,"a-data-username",t.username),_i:"25-"+s}},[e._v(e._$s("25-"+s,"t0-0",e._s(t.time)))])])])]):i("view",{staticClass:e._$s("26-"+s,"sc","tap_mask"),attrs:{"data-item":e._$s("26-"+s,"a-data-item",t),_i:"26-"+s},on:{click:function(t){return t.stopPropagation(),e.into_chatRoom(t)}}},[i("view",{staticClass:e._$s("27-"+s,"sc","list_box"),attrs:{_i:"27-"+s}},[i("view",{staticClass:e._$s("28-"+s,"sc","list_left"),attrs:{"data-username":e._$s("28-"+s,"a-data-username",t.username),_i:"28-"+s}},[i("view",{staticClass:e._$s("29-"+s,"sc","list_pic"),attrs:{_i:"29-"+s}},[e._$s("30-"+s,"i",t.unReadCount>0||"99+"==t.unReadCount)?i("view",{staticClass:e._$s("30-"+s,"sc","em-msgNum"),attrs:{_i:"30-"+s}},[e._v(e._$s("30-"+s,"t0-0",e._s(t.unReadCount)))]):e._e(),i("image",{attrs:{src:e._$s("31-"+s,"a-src","groupchat"==t.chatType||"chatRoom"==t.chatType?"../../static/images/groupTheme.png":"../../static/images/theme2x.png"),_i:"31-"+s}})]),i("view",{staticClass:e._$s("32-"+s,"sc","list_text"),attrs:{_i:"32-"+s}},[i("text",{staticClass:e._$s("33-"+s,"sc","list_user"),attrs:{_i:"33-"+s}},[e._v(e._$s("33-"+s,"t0-0",e._s("groupchat"==t.chatType||"chatRoom"==t.chatType||t.groupName?t.groupName:t.username)))]),e._$s("34-"+s,"i",t.msg.data[0].data)?i("text",{staticClass:e._$s("34-"+s,"sc","list_word"),attrs:{_i:"34-"+s}},[e._v(e._$s("34-"+s,"t0-0",e._s(t.msg.data[0].data)))]):e._e(),e._$s("35-"+s,"i","img"==t.msg.type)?i("text",{staticClass:e._$s("35-"+s,"sc","list_word"),attrs:{_i:"35-"+s}}):e._e(),e._$s("36-"+s,"i","audio"==t.msg.type)?i("text",{staticClass:e._$s("36-"+s,"sc","list_word"),attrs:{_i:"36-"+s}}):e._e()])]),i("view",{staticClass:e._$s("37-"+s,"sc","list_right"),attrs:{_i:"37-"+s}},[i("text",{attrs:{"data-username":e._$s("38-"+s,"a-data-username",t.username),_i:"38-"+s}},[e._v(e._$s("38-"+s,"t0-0",e._s(t.time)))])])])])])],1)})),i("long-press-modal",{attrs:{winSize:e.winSize,popButton:e.popButton,showPop:e.showPop,popStyle:e.popStyle,_i:39},on:{change:e.pickerMenuChange,hidePop:e.hidePop}}),e._$s(40,"i",0==e.arr.length)?i("view",{staticClass:e._$s(40,"sc","chat_noChat"),attrs:{_i:40}},[i("image",{staticClass:e._$s(41,"sc","ctbg"),attrs:{_i:41}})]):e._e()],2),i("view"),e._$s(43,"i",e.show_mask)?i("view",{staticClass:e._$s(43,"sc","mask"),attrs:{_i:43},on:{click:e.close_mask}}):e._e(),i("view",{class:e._$s(44,"c",e.isIPX?"chatRoom_tab_X":"chatRoom_tab"),attrs:{_i:44}},[i("view",{staticClass:e._$s(45,"sc","tableBar"),attrs:{_i:45}},[e._$s(46,"i",e.unReadSpotNum>0||"99+"==e.unReadSpotNum)?i("view",{class:e._$s(46,"c","em-unread-spot "+("99+"==e.unReadSpotNum?"em-unread-spot-litleFont":"")),attrs:{_i:46}},[e._v(e._$s(46,"t0-0",e._s("99+"==e.unReadSpotNum?e.unReadSpotNum:e.unReadSpotNum+e.unReadTotalNotNum)))]):e._e(),i("image",{class:e._$s(47,"c",e.unReadSpotNum>0||"99+"==e.unReadSpotNum?"haveSpot":""),attrs:{_i:47}}),i("text",{staticClass:e._$s(48,"sc","activeText"),attrs:{_i:48}})]),i("view",{staticClass:e._$s(49,"sc","tableBar"),attrs:{_i:49},on:{click:e.tab_contacts}},[i("image",{attrs:{_i:50}}),i("text")]),i("view",{staticClass:e._$s(52,"sc","tableBar"),attrs:{_i:52},on:{click:e.tab_setting}},[i("image",{attrs:{_i:53}}),i("text")])])])},r=[]},"5b60":function(e,t,n){"use strict";n.r(t);var i=n("4d98"),o=n("358d");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},6240:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("a8e9")),o=r(n("0b99"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}var u=function(){function e(){var t=this;s(this,e),this.config={baseUrl:"",header:{},method:"POST",dataType:"json",responseType:"text",showLoading:!0,loadingText:"\u8bf7\u6c42\u4e2d...",loadingTime:800,timer:null,originalData:!1,loadingMask:!0},this.interceptor={request:null,response:null},this.get=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.request({method:"GET",url:e,header:i,data:n})},this.post=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.request({url:e,method:"POST",header:i,data:n})},this.put=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.request({url:e,method:"PUT",header:i,data:n})},this.delete=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.request({url:e,method:"DELETE",header:i,data:n})}}return c(e,[{key:"setConfig",value:function(e){this.config=(0,i.default)(this.config,e)}},{key:"request",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.interceptor.request&&"function"===typeof this.interceptor.request){var n=this.interceptor.request(t);if(!1===n)return new Promise((function(){}));this.options=n}return t.dataType=t.dataType||this.config.dataType,t.responseType=t.responseType||this.config.responseType,t.url=t.url||"",t.params=t.params||{},t.header=Object.assign(this.config.header,t.header),t.method=t.method||this.config.method,new Promise((function(n,i){t.complete=function(t){if(uni.hideLoading(),clearTimeout(e.config.timer),e.config.timer=null,e.config.originalData)if(e.interceptor.response&&"function"===typeof e.interceptor.response){var o=e.interceptor.response(t);!1!==o?n(o):i(t)}else n(t);else if(200==t.statusCode)if(e.interceptor.response&&"function"===typeof e.interceptor.response){var r=e.interceptor.response(t.data);!1!==r?n(r):i(t.data)}else n(t.data);else i(t)},t.url=o.default.url(t.url)?t.url:e.config.baseUrl+(0==t.url.indexOf("/")?t.url:"/"+t.url),e.config.showLoading&&!e.config.timer&&(e.config.timer=setTimeout((function(){uni.showLoading({title:e.config.loadingText,mask:e.config.loadingMask}),e.config.timer=null}),e.config.loadingTime)),uni.request(t)}))}}]),e}(),d=new u;t.default=d},6765:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={data:function(){return{visible:!1}},methods:{show:function(){this.setData({visible:!0})},cancel:function(){e("log","\u53d6\u6d88"," at components/chat/inputbar/suit/ptopcall/ptopcall.vue:27"),this.setData({visible:!1})},callAudio:function(){this.$emit("makeAudioCall",null,"single"),this.cancel()},callVideo:function(){e("log","callVideo"," at components/chat/inputbar/suit/ptopcall/ptopcall.vue:40"),this.$emit("makeVideoCall",null,"single"),this.cancel()}}};t.default=n}).call(this,n("0de9")["default"])},"67e8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("25e4"),r={data:function(){return{yourname:"",messageNum:0,unReadSpotNum:0,unReadNoticeNum:0,unReadTotalNotNum:0,isIPX:!1}},components:{},props:{},onLoad:function(e){var t=this;this.setData({yourname:uni.getStorageSync("myUsername")}),o.on("em.subscribe",(function(){t.setData({messageNum:getApp().globalData.saveFriendList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length})})),o.on("em.unreadspot",(function(){t.setData({unReadSpotNum:getApp().globalData.unReadMessageNum})})),o.on("em.invite.joingroup",(function(e){t.setData({unReadNoticeNum:getApp().globalData.saveGroupInvitedList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length})}))},onShow:function(){uni.hideHomeButton(),this.setData({messageNum:getApp().globalData.saveFriendList.length,unReadSpotNum:getApp().globalData.unReadMessageNum>99?"99+":getApp().globalData.unReadMessageNum,unReadNoticeNum:getApp().globalData.saveGroupInvitedList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length}),getApp().globalData.isIPX&&this.setData({isIPX:!0})},methods:{tab_contact:function(){uni.redirectTo({url:"../main/main?myName="+uni.getStorageSync("myUsername")})},tab_chat:function(){uni.redirectTo({url:"../chat/chat"})},tab_notification:function(){uni.redirectTo({url:"../notification/notification"})},goGeneralSetting:function(){uni.navigateTo({url:"../setting_general/setting_general"})},logout:function(){uni.showModal({title:"\u662f\u5426\u9000\u51fa\u767b\u5f55",success:function(e){e.confirm&&(uni.setStorageSync("INFORM",[]),i.conn.close(),uni.redirectTo({url:"../login/login"}))}})}}};t.default=r},"6d90":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("25e4"),r={data:function(){return{groupList:[]}},onLoad:function(e){var t=this;o.on("em.invite.joingroup",(function(){t.setData({groupList:getApp().globalData.saveGroupInvitedList}),uni.setStorageSync("groupNotiData",getApp().globalData.saveGroupInvitedList)})),this.setData({groupList:uni.getStorageSync("groupNotiData")})},onShow:function(){uni.hideHomeButton(),this.listGroups()},methods:{removeAndRefresh:function(t){var n;e("log","removeId>>",t," at pages/notification_groupDetail/groupDetail.vue:78"),this.groupList.forEach((function(i,o){e("log","v>>",i," at pages/notification_groupDetail/groupDetail.vue:81"),i.gid===t&&(n=o)})),e("log","idx>>",n," at pages/notification_groupDetail/groupDetail.vue:86"),this.groupList.splice(n,1),getApp().globalData.saveGroupInvitedList.splice(n,1)},listGroups:function(){return i.conn.getGroup({success:function(e){uni.setStorage({key:"listGroup",data:e})},error:function(t){e("log",t," at pages/notification_groupDetail/groupDetail.vue:101")}})},agree:function(t){var n=this;e("log","event",t,"groupList>>",this.groupList," at pages/notification_groupDetail/groupDetail.vue:106");i.conn.agreeInviteIntoGroup({invitee:i.conn.context.userId,groupId:t.currentTarget.dataset.from,success:function(){uni.showToast({title:"\u52a0\u5165\u6210\u529f",duration:1e3})}}),this.groupList.forEach((function(e){e.gid==t.currentTarget.dataset.from&&(uni.setStorageSync("groupNotiData",n.groupList),e.typeText="\u5df2\u540c\u610f",n.setData({groupList:n.groupList}))})),this.removeAndRefresh(t.currentTarget.dataset.from),this.listGroups()},reject:function(e){var t=this;i.conn.rejectInviteIntoGroup({invitee:i.conn.context.userId,groupId:e.currentTarget.dataset.from,success:function(){uni.showToast({title:"\u5df2\u62d2\u7edd",duration:1e3})}}),this.groupList.forEach((function(n){n.gid==e.currentTarget.dataset.from&&(n.typeText="\u5df2\u62d2\u7edd",uni.setStorageSync("groupNotiData",t.groupList),t.setData({groupList:t.groupList}))})),this.removeAndRefresh(e.currentTarget.dataset.from)},into_chat:function(){uni.redirectTo({url:"../chat/chat"})}}};t.default=r}).call(this,n("0de9")["default"])},"6fd6":function(e,t,n){"use strict";function i(e,t){var n=this.$parent;while(n)if(n.$options.name!==e)n=n.$parent;else{var i=function(){var e={};if(Array.isArray(t))t.map((function(t){e[t]=n[t]?n[t]:""}));else for(var i in t)Array.isArray(t[i])?t[i].length?e[i]=t[i]:e[i]=n[i]:t[i].constructor===Object?Object.keys(t[i]).length?e[i]=t[i]:e[i]=n[i]:e[i]=t[i]||!1===t[i]?t[i]:n[i];return{v:e}}();if("object"===typeof i)return i.v}return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},"6ffe":function(e,t,n){"use strict";n.r(t);var i=n("e6c8"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"71bf":function(e,t,n){"use strict";n.r(t);var i=n("0bdb"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"723d":function(e,t,n){"use strict";n.r(t);var i=n("1b39"),o=n("acf2");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"9996b632",null,!1,i["a"],s);t["default"]=c.exports},7338:function(e,t,n){"use strict";n.r(t);var i=n("2465"),o=n("ff9a");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"735c":function(e,t,n){"use strict";n.r(t);var i=n("b1f0"),o=n("0c5d");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},7617:function(e,t,n){"use strict";n("cbda");var i=s(n("8bbf")),o=s(n("ebe7")),r=s(n("5597"));function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}i.default.use(r.default),i.default.config.productionTip=!1,i.default.mixin({methods:{setData:function(e,t){var n,i,o=this,r=[];Object.keys(e).forEach((function(t){r=t.split("."),n=e[t],i=o.$data,r.forEach((function(e,t){t+1==r.length?o.$set(i,e,n):i[e]||o.$set(i,e,{}),i=i[e]}))})),t&&t()}}}),o.default.mpType="app";var d=new i.default(c({},o.default));d.$mount()},"761e":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("swiper",{class:e._$s(0,"c",e.show),attrs:{"indicator-dots":e._$s(0,"a-indicator-dots",e.indicatorDots),autoplay:e._$s(0,"a-autoplay",e.autoplay),interval:e._$s(0,"a-interval",e.interval),duration:e._$s(0,"a-duration",e.duration),_i:0}},[[n("swiper-item",[n("view",{staticClass:e._$s(3,"sc","emoji_item"),attrs:{_i:3}},e._l(e._$s(4,"f",{forItems:e.emojiObj.map1}),(function(t,i,o,r){return n("image",{key:e._$s(4,"f",{forIndex:o,key:i}),attrs:{src:e._$s("4-"+r,"a-src","../../../../"+e.emojiObj.path+t),"data-emoji":e._$s("4-"+r,"a-data-emoji",i),_i:"4-"+r},on:{click:e.sendEmoji}})})),0),n("view",{staticClass:e._$s(5,"sc","emoji_item"),attrs:{_i:5}},e._l(e._$s(6,"f",{forItems:e.emojiObj.map2}),(function(t,i,o,r){return n("image",{key:e._$s(6,"f",{forIndex:o,key:i}),attrs:{src:e._$s("6-"+r,"a-src","../../../../"+e.emojiObj.path+t),"data-emoji":e._$s("6-"+r,"a-data-emoji",i),_i:"6-"+r},on:{click:e.sendEmoji}})})),0),n("view",{staticClass:e._$s(7,"sc","emoji_item"),attrs:{_i:7}},e._l(e._$s(8,"f",{forItems:e.emojiObj.map3}),(function(t,i,o,r){return n("image",{key:e._$s(8,"f",{forIndex:o,key:i}),attrs:{src:e._$s("8-"+r,"a-src","../../../../"+e.emojiObj.path+t),"data-emoji":e._$s("8-"+r,"a-data-emoji",i),_i:"8-"+r},on:{click:e.sendEmoji}})})),0)])],[n("swiper-item",[n("view",{staticClass:e._$s(11,"sc","emoji_item"),attrs:{_i:11}},e._l(e._$s(12,"f",{forItems:e.emojiObj.map4}),(function(t,i,o,r){return n("image",{key:e._$s(12,"f",{forIndex:o,key:i}),attrs:{src:e._$s("12-"+r,"a-src","../../../../"+e.emojiObj.path+t),"data-emoji":e._$s("12-"+r,"a-data-emoji",i),_i:"12-"+r},on:{click:e.sendEmoji}})})),0),n("view",{staticClass:e._$s(13,"sc","emoji_item"),attrs:{_i:13}},e._l(e._$s(14,"f",{forItems:e.emojiObj.map5}),(function(t,i,o,r){return n("image",{key:e._$s(14,"f",{forIndex:o,key:i}),attrs:{src:e._$s("14-"+r,"a-src","../../../../"+e.emojiObj.path+t),"data-emoji":e._$s("14-"+r,"a-data-emoji",i),_i:"14-"+r},on:{click:e.sendEmoji}})})),0),n("view",{staticClass:e._$s(15,"sc","emoji_item last_item"),attrs:{_i:15}},e._l(e._$s(16,"f",{forItems:e.emojiObj.map6}),(function(t,i,o,r){return n("image",{key:e._$s(16,"f",{forIndex:o,key:i}),attrs:{src:e._$s("16-"+r,"a-src","../../../../"+e.emojiObj.path+t),"data-emoji":e._$s("16-"+r,"a-data-emoji",i),_i:"16-"+r},on:{click:e.sendEmoji}})})),0)])]],2)},r=[]},"765b":function(e,t,n){"use strict";function i(e,t){if(e>=0&&t>0&&t>=e){var n=t-e+1;return Math.floor(Math.random()*n+e)}return 0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i;t.default=o},7787:function(e,t,n){"use strict";(function(e,n){var i;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{search_btn:!0,search_friend:!1,groupMember:[],serchList:[],checkedValue:[],renderList:[],buttonText:"\u53d1\u8d77\u4f1a\u8bae",second_height:450,show_clear:!1}},props:{username:{type:Object,default:function(){return{}}},action:{type:String,default:""}},mounted:function(){e("log","\u9080\u8bf7\u9875\u9762\u7684\u53c2\u6570",this," at components/chat/emediaInvite/emediaInvite.vue:83"),e("log",this.properties," at components/chat/emediaInvite/emediaInvite.vue:84");var t=this;n.getSystemInfo({success:function(n){e("log","height="+n.windowHeight," at components/chat/emediaInvite/emediaInvite.vue:89"),e("log","width="+n.windowWidth," at components/chat/emediaInvite/emediaInvite.vue:90"),t.setData({second_height:n.windowHeight-n.windowWidth/750*300})}}),"invite"==this.action&&this.setData({buttonText:"\u9080\u8bf7"});var i=this.username&&this.username.groupId;e("log","roomId",this.username," at components/chat/emediaInvite/emediaInvite.vue:106"),i&&this.getGroupMember(i)},methods:(i={getGroupMember:function(t){var n=this,i=1,o=1e3,r={pageNum:i,pageSize:o,groupId:t,success:function(t){e("log","\u83b7\u53d6\u7fa4\u6210\u5458",t," at components/chat/emediaInvite/emediaInvite.vue:120"),t&&t.data&&(n.setData({groupMember:t.data}),n.getRenderList(t.data))},error:function(e){}};uni.WebIM.conn.listGroupMember(r)},getRenderList:function(t){var i=this;e("log","this.checkedValue",this.checkedValue," at components/chat/emediaInvite/emediaInvite.vue:136");var o=t.map((function(e){for(var t=0;t<i.checkedValue.length;t++){if(e.member&&-1!=e.member.indexOf(i.checkedValue[t])||e.owner&&-1!=e.owner.indexOf(i.checkedValue[t]))return e.checked=!0,e;e.checked=!1}return e}));o.forEach((function(e){e.member!=n.WebIM.conn.context.userId&&e.owner!=n.WebIM.conn.context.userId||(e.disabled=!0)})),this.setData({renderList:o}),e("log","serchList >>>>",o," at components/chat/emediaInvite/emediaInvite.vue:159")},checkboxChange:function(t){if(e("log","checkbox\u53d1\u751fchange\u4e8b\u4ef6\uff0c\u643a\u5e26value\u503c\u4e3a\uff1a",t," at components/chat/emediaInvite/emediaInvite.vue:165"),-1==this.checkedValue.indexOf(t.detail.value)&&t.detail.value[0])this.checkedValue.push(t.detail.value[0]),e("log",this.checkedValue," at components/chat/emediaInvite/emediaInvite.vue:168");else{var n=t.target.dataset.item.name;this.checkedValue.splice(this.checkedValue.indexOf(n),1),e("log",this.checkedValue," at components/chat/emediaInvite/emediaInvite.vue:172")}},openSearch:function(){this.setData({search_btn:!1,search_friend:!0,show_mask:!0,gotop:!0})},cancel:function(){this.setData({search_btn:!0,search_friend:!1,gotop:!1})},onInput:function(e){var t=e.detail.value;t?this.setData({show_clear:!0}):this.setData({show_clear:!1})},clearInput:function(){this.setData({input_code:"",show_clear:!1})}},o(i,"cancel",(function(){this.setData({search_btn:!0,search_friend:!1});var e=this.groupMember||[];this.getRenderList(e)})),o(i,"onSearch",(function(e){var t=e.detail.value,n=this.groupMember,i=[];n.forEach((function(e,n){-1==String(e.member).indexOf(t)&&-1==String(e.owner).indexOf(t)||i.push(e)})),this.getRenderList(i)})),o(i,"startConfr",(function(){this.$emit("onStartConfr",{confrMember:this.checkedValue,action:this.action,groupId:this.username.groupId}),this.setData({checkedValue:[]})})),o(i,"goBack",(function(){this.setData({checkedValue:[]}),this.$emit("goBack")})),o(i,"into_room",(function(){})),i)};t.default=r}).call(this,n("0de9")["default"],n("fe07")["default"])},"77e3":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","audio-player"),style:e._$s(0,"s","opacity: "+e.opcity),attrs:{_i:0},on:{click:e.audioPlay}},[n("text",{staticClass:e._$s(1,"sc","time"),attrs:{_i:1}},[e._v(e._$s(1,"t0-0",e._s(e.time)))]),n("view",{staticClass:e._$s(2,"sc","controls play-btn"),attrs:{_i:2},on:{click:e.audioPlay}},[n("image",{attrs:{src:e._$s(3,"a-src","self"==e.style?"../../../../../static/images/voicemsgmy.png":"../../../../../static/images/voicemsg.png"),_i:3}})])])},r=[]},"79d8":function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"brackets",i=t?"?":"",o=[];-1==["indices","brackets","repeat","comma"].indexOf(n)&&(n="brackets");var r=function(t){var i=e[t];if(["",void 0,null].indexOf(i)>=0)return"continue";if(i.constructor===Array)switch(n){case"indices":for(var r=0;r<i.length;r++)o.push(t+"["+r+"]="+i[r]);break;case"brackets":i.forEach((function(e){o.push(t+"[]="+e)}));break;case"repeat":i.forEach((function(e){o.push(t+"="+e)}));break;case"comma":var s="";i.forEach((function(e){s+=(s?",":"")+e})),o.push(t+"="+s);break;default:i.forEach((function(e){o.push(t+"[]="+e)}))}else o.push(t+"="+i)};for(var s in e)r(s);return o.length?i+o.join("&"):""}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i;t.default=o},"79fe":function(e,t,n){"use strict";n.r(t);var i=n("8906"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},"7b63":function(e,t,n){"use strict";n.r(t);var i=n("b186"),o=n("00df");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"7df6":function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-mm-dd";e||(e=Number(new Date)),10==e.toString().length&&(e*=1e3);var n,i=new Date(Number(e)),o={"y+":i.getFullYear().toString(),"m+":(i.getMonth()+1).toString(),"d+":i.getDate().toString(),"h+":i.getHours().toString(),"M+":i.getMinutes().toString(),"s+":i.getSeconds().toString()};for(var r in o)n=new RegExp("("+r+")").exec(t),n&&(t=t.replace(n[1],1==n[1].length?o[r]:o[r].padStart(n[1].length,"0")));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,String.prototype.padStart||(String.prototype.padStart=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";if("[object String]"!==Object.prototype.toString.call(t))throw new TypeError("fillString must be String");var n=this;if(n.length>=e)return String(n);var i=e-n.length,o=Math.ceil(i/t.length);while(o>>=1)t+=t,1===o&&(t+=t);return t.slice(0,i)+n});var o=i;t.default=o},"805c":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e._$s(0,"i",e.recordStatus!=e.RecordStatus.HIDE)?n("view",{staticClass:e._$s(0,"sc","modal modal-record"),attrs:{_i:0},on:{click:e.toggleRecordModal}},[n("view",{staticClass:e._$s(1,"sc","modal-body"),attrs:{_i:1},on:{click:function(t){return t.stopPropagation(),e.toggleWithoutAction(t)}}},[n("view",{staticClass:e._$s(2,"sc","sound-waves"),attrs:{_i:2}},[e._l(e._$s(3,"f",{forItems:e.radomheight}),(function(t,i,o,r){return n("view",{key:e._$s(3,"f",{forIndex:o,key:i}),style:e._$s("3-"+r,"s","height:"+t+"rpx;margin-top:-"+t/2+"rpx"),attrs:{_i:"3-"+r}})})),n("view")],2),n("text",{staticClass:e._$s(5,"sc","desc"),attrs:{_i:5}},[e._v(e._$s(5,"t0-0",e._s(e.RecordDesc[e.recordStatus])))]),n("view",{staticClass:e._$s(6,"sc","dot"),attrs:{_i:6},on:{touchstart:e.handleRecording,touchmove:e.handleRecordingMove,touchend:e.handleRecordingCancel}},[n("image",{staticClass:e._$s(7,"sc","icon-mic"),attrs:{_i:7}})])])]):e._e()},r=[]},8145:function(e,t,n){"use strict";var i;function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n?i||(i=!0,"function"===typeof e&&e(),setTimeout((function(){i=!1}),t)):i||(i=!0,setTimeout((function(){i=!1,"function"===typeof e&&e()}),t))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o;t.default=r},8168:function(e,t,n){"use strict";n.r(t);var i=n("e3de"),o=n("2188");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},8234:function(e,t,n){"use strict";n.r(t);var i=n("b966"),o=n("c94e");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"82ed":function(e,t,n){var i=n("0c53")["default"],o=n("01d4");e.exports=function(e,t,n){var r=i.time(),s={info:{from:e.body.from,to:e.body.to},username:e.body.from==n?e.body.to:e.body.from,yourname:e.body.from,msg:{type:t,url:e.body.url?e.body.url:"",data:a(e,t),ext:e.body.ext},style:e.body.from==n?"self":"",time:r,mid:e.type+e.id,chatType:e.body.chatType};return t==o.IMAGE?s.msg.size={width:e.body.body.size.width,height:e.body.body.size.height}:t==o.AUDIO?s.msg.length=e.body.length:t==o.FILE&&(s.msg.data=[{data:"[\u5f53\u524d\u4e0d\u652f\u6301\u6b64\u683c\u5f0f\u6d88\u606f\u5c55\u793a]",type:"txt"}],s.msg.type="txt"),s;function a(e,t){return t==o.TEXT?i.parseEmoji(e.value.replace(/\n/gm,"")):t==o.EMOJI?e.value:t==o.IMAGE||t==o.VIDEO||t==o.AUDIO?e.body.body.url:t==o.FILE?e.body.body.msg:""}}},"88ee":function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(n=n||i.length,e)for(var r=0;r<e;r++)o[r]=i[0|Math.random()*n];else{var s;o[8]=o[13]=o[18]=o[23]="-",o[14]="4";for(var a=0;a<36;a++)o[a]||(s=0|16*Math.random(),o[a]=i[19==a?3&s|8:s])}return t?(o.shift(),"u"+o.join("")):o.join("")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i;t.default=o},8906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;getApp().globalData;var i={data:function(){return{motto:"\u73af\u4fe1\u5373\u65f6\u901a\u8baf\u4e91",userInfo:{},login:!1}},components:{},props:{},onLoad:function(){var e=this;this.timeOut=setTimeout((function(){uni.redirectTo({url:"../login/login"})}),3e3),getApp().globalData.getUserInfo((function(t){e.setData({userInfo:t})}))},methods:{bindViewTap:function(){clearTimeout(this.timeOut),uni.redirectTo({url:"../login/login"})}}};t.default=i},"8bbf":function(e,t){e.exports=Vue},"8d25":function(e,t,n){"use strict";n.r(t);var i=n("a429"),o=n("57f1");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"92ae":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o={data:function(){return{username:"",password:"",psdFocus:"",nameFocus:"",showPassword:!1,type:"text"}},components:{},props:{},onLoad:function(){getApp().globalData},methods:{bindUsername:function(e){this.setData({username:e.detail.value})},bindPassword:function(e){this.setData({password:e.detail.value})},onFocusPsd:function(){this.setData({psdFocus:"psdFocus"})},onBlurPsd:function(){this.setData({psdFocus:""})},onFocusName:function(){this.setData({nameFocus:"nameFocus"})},onBlurName:function(){this.setData({nameFocus:""})},register:function(){var e=this;if(""==e.username)return uni.showToast({title:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\uff01",icon:"none"});if(""==e.password)return uni.showToast({title:"\u8bf7\u8f93\u5165\u5bc6\u7801\uff01",icon:"none"});var t={apiUrl:i.config.apiURL,username:e.username.toLowerCase(),password:e.password,nickname:"",appKey:i.config.appkey,success:function(t){uni.showToast({title:"\u6ce8\u518c\u6210\u529f"});i.config.apiURL,e.username.toLowerCase(),e.password,i.config.appkey;uni.setStorage({key:"myUsername",data:e.username})},error:function(e){if("200"!==e.statusCode){if("400"==e.statusCode&&"illegal_argument"==e.data.error)return uni.showToast({title:"\u7528\u6237\u540d\u975e\u6cd5",icon:"none"});uni.showToast({title:"\u7528\u6237\u540d\u5df2\u88ab\u5360\u7528",icon:"none"})}}};i.conn.registerUser(t)}}};t.default=o},"92be":function(e,t,n){var i=n("c4a8"),o=n("82ed"),r=n("01d4"),s=new i,a=n("25e4");s.saveReceiveMsg=function(e,t){var n;if(t==r.IMAGE)n={id:e.id,type:t,body:{id:e.id,from:e.from,to:e.to,type:e.type,ext:e.ext,chatType:e.type,toJid:"",body:{type:t,url:e.url,filename:e.filename,filetype:e.filetype,size:{width:e.width,height:e.height}}}};else if(t==r.TEXT||t==r.EMOJI)n={id:e.id,type:t,body:{id:e.id,from:e.from,to:e.to,type:e.type,ext:e.ext,chatType:e.type,toJid:"",body:{type:t,msg:e.data}},value:e.data};else if("INFORM"==t)n={body:{from:e.from,to:e.to,chatType:"INFORM",gid:e.gid?e.gid:"",type:e.type}};else if(t==r.FILE)n={id:e.id,type:t,body:{id:e.id,length:e.file_length,from:e.from,to:e.to,type:e.type,ext:e.ext,chatType:e.type,toJid:"",body:{type:t,url:e.url,filename:e.filename,msg:"\u5f53\u524d\u4e0d\u652f\u6301\u6b64\u683c\u5f0f\u6d88\u606f\u5c55\u793a"}},value:e.data};else if(t==r.AUDIO)n={id:e.id,type:t,accessToken:e.token||e.accessToken,body:{id:e.id,length:e.length,from:e.from,to:e.to,type:e.type,ext:e.ext,chatType:t,toJid:"",body:{type:t,url:e.url,filename:e.filename,filetype:e.filetype,from:e.from,to:e.to}}};else{if(t!=r.VIDEO)return;n={id:e.id,type:t,accessToken:e.token||e.accessToken,body:{id:e.id,length:e.length,from:e.from,to:e.to,type:e.type,ext:e.ext,chatType:t,toJid:"",body:{type:t,url:e.url,filename:e.filename,filetype:e.filetype,from:e.from,to:e.to}}}}this.saveMsg(n,t,e)},s.saveMsg=function(e,t,n){var i,s=this,c=uni.getStorageSync("myUsername");i=n&&"groupchat"==n.type?n.to+c:"INFORM"===e.body.chatType?"INFORM":e.body.from==c?e.body.to+c:e.body.from+c;var u=uni.getStorageSync(i)||[],d=o(e,t,c);function l(){uni.setStorage({key:i,data:u,success:function(){t!=r.AUDIO&&t!=r.VIDEO||a.fire("em.chat.audio.fileLoaded"),s.fire("newChatMsg",d,t,u,i)}})}t==r.AUDIO&&(d.msg.length=e.body.length,d.msg.token=e.accessToken),u.push(d),t==r.AUDIO&&(d.msg.token=e.accessToken),l()},e.exports=s},"938c":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("view",{staticClass:e._$s(0,"sc","wraper"),attrs:{_i:0}},[e._$s(1,"i",e.search_btn)?i("view",{staticClass:e._$s(1,"sc","search"),attrs:{_i:1}},[i("view",{},[i("icon",{}),i("text")])]):e._e(),e._$s(5,"i",e.search_friend)?i("view",{staticClass:e._$s(5,"sc","search_input"),attrs:{_i:5}},[i("view",[i("icon",{}),i("input",{attrs:{value:e._$s(8,"a-value",e.input_code),_i:8}}),e._$s(9,"i",e.show_clear)?i("icon",{}):e._e()]),i("text",{})]):e._e(),i("scroll-view",{staticClass:e._$s(11,"sc","content"),style:e._$s(11,"s",{height:e.second_height+"px"}),attrs:{_i:11}},e._l(e._$s(12,"f",{forItems:e.renderList}),(function(t,o,r,s){return i("checkbox-group",{key:e._$s(12,"f",{forIndex:r,key:t.member||t.owner}),attrs:{"data-item":e._$s("12-"+s,"a-data-item",t),id:e._$s("12-"+s,"a-id",t.id),"data-id":e._$s("12-"+s,"a-data-id",t.id),_i:"12-"+s},on:{change:e.checkboxChange}},[i("view",{staticClass:e._$s("13-"+s,"sc","tap_mask"),attrs:{"data-username":e._$s("13-"+s,"a-data-username",t.member||t.owner),_i:"13-"+s},on:{click:e.into_room}},[i("view",{staticClass:e._$s("14-"+s,"sc","address_bottom"),attrs:{"data-username":e._$s("14-"+s,"a-data-username",t.member||t.owner),_i:"14-"+s},on:{click:e.into_room}},[i("image",{attrs:{src:e._$s("15-"+s,"a-src",n("e3db")),"data-username":e._$s("15-"+s,"a-data-username",t.member||t.owner),_i:"15-"+s},on:{click:e.into_room}}),i("text",{attrs:{"data-username":e._$s("16-"+s,"a-data-username",t.member||t.owner),_i:"16-"+s},on:{click:e.into_room}},[e._v(e._$s("16-"+s,"t0-0",e._s(t.member||t.owner)))]),i("checkbox",{attrs:{value:e._$s("17-"+s,"a-value",t.member||t.owner),checked:e._$s("17-"+s,"a-checked",t.checked),disabled:e._$s("17-"+s,"a-disabled",t.disabled),_i:"17-"+s}})])])])})),0),i("view",{staticClass:e._$s(18,"sc","btnWraper"),attrs:{_i:18}},[i("button",{staticClass:e._$s(19,"sc","button"),attrs:{_i:19},on:{click:e.startConfr}},[e._v(e._$s(19,"t0-0",e._s(e.buttonText)))]),i("button",{staticClass:e._$s(20,"sc","button red"),attrs:{_i:20},on:{click:e.goBack}})])])},r=[]},9680:function(e,t,n){"use strict";n.r(t);var i=n("a845"),o=n("a58c");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"96cf":function(e,t){!function(t){"use strict";var n,i=Object.prototype,o=i.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag",u="object"===typeof e,d=t.regeneratorRuntime;if(d)u&&(e.exports=d);else{d=t.regeneratorRuntime=u?e.exports:{},d.wrap=b;var l="suspendedStart",f="suspendedYield",p="executing",h="completed",m={},g={};g[s]=function(){return this};var _=Object.getPrototypeOf,v=_&&_(_(k([])));v&&v!==i&&o.call(v,s)&&(g=v);var y=C.prototype=S.prototype=Object.create(g);I.prototype=y.constructor=C,C.constructor=I,C[c]=I.displayName="GeneratorFunction",d.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===I||"GeneratorFunction"===(t.displayName||t.name))},d.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(y),e},d.awrap=function(e){return{__await:e}},x(E.prototype),E.prototype[a]=function(){return this},d.AsyncIterator=E,d.async=function(e,t,n,i){var o=new E(b(e,t,n,i));return d.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},x(y),y[c]="Generator",y[s]=function(){return this},y.toString=function(){return"[object Generator]"},d.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){while(t.length){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},d.values=k,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(i,o){return a.type="throw",a.arg=e,t.next=i,o&&(t.method="next",t.arg=n),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=o.call(s,"catchLoc"),u=o.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:k(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=n),m}}}function b(e,t,n,i){var o=t&&t.prototype instanceof S?t:S,r=Object.create(o.prototype),s=new M(i||[]);return r._invoke=O(e,n,s),r}function w(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}function S(){}function I(){}function C(){}function x(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function E(e){function t(n,i,r,s){var a=w(e[n],e,i);if("throw"!==a.type){var c=a.arg,u=c.value;return u&&"object"===typeof u&&o.call(u,"__await")?Promise.resolve(u.__await).then((function(e){t("next",e,r,s)}),(function(e){t("throw",e,r,s)})):Promise.resolve(u).then((function(e){c.value=e,r(c)}),(function(e){return t("throw",e,r,s)}))}s(a.arg)}var n;function i(e,i){function o(){return new Promise((function(n,o){t(e,i,n,o)}))}return n=n?n.then(o,o):o()}this._invoke=i}function O(e,t,n){var i=l;return function(o,r){if(i===p)throw new Error("Generator is already running");if(i===h){if("throw"===o)throw r;return A()}n.method=o,n.arg=r;while(1){var s=n.delegate;if(s){var a=T(s,n);if(a){if(a===m)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===l)throw i=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var c=w(e,t,n);if("normal"===c.type){if(i=n.done?h:f,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=h,n.method="throw",n.arg=c.arg)}}}function T(e,t){var i=e.iterator[t.method];if(i===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,T(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var o=w(i,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,m;var r=o.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function k(e){if(e){var t=e[s];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,r=function t(){while(++i<e.length)if(o.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=n,t.done=!0,t};return r.next=r}}return{next:A}}function A(){return{value:n,done:!0}}}(function(){return this||"object"===typeof self&&self}()||Function("return this")())},"96e7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=null;function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null!==i&&clearTimeout(i),n){var o=!i;i=setTimeout((function(){i=null}),t),o&&"function"===typeof e&&e()}else i=setTimeout((function(){"function"===typeof e&&e()}),t)}var r=o;t.default=r},"981e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"u-button",props:{hairLine:{type:Boolean,default:!0},type:{type:String,default:"default"},size:{type:String,default:"default"},shape:{type:String,default:"square"},plain:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},openType:{type:String,default:""},formType:{type:String,default:""},appParameter:{type:String,default:""},hoverStopPropagation:{type:Boolean,default:!1},lang:{type:String,default:"en"},sessionFrom:{type:String,default:""},sendMessageTitle:{type:String,default:""},sendMessagePath:{type:String,default:""},sendMessageImg:{type:String,default:""},showMessageCard:{type:Boolean,default:!1},hoverBgColor:{type:String,default:""},rippleBgColor:{type:String,default:""},ripple:{type:Boolean,default:!1},hoverClass:{type:String,default:""},customStyle:{type:Object,default:function(){return{}}},dataName:{type:String,default:""},throttleTime:{type:[String,Number],default:1e3},hoverStartTime:{type:[String,Number],default:20},hoverStayTime:{type:[String,Number],default:150}},computed:{getHoverClass:function(){if(this.loading||this.disabled||this.ripple||this.hoverClass)return"";var e="";return e=this.plain?"u-"+this.type+"-plain-hover":"u-"+this.type+"-hover",e},showHairLineBorder:function(){return["primary","success","error","warning"].indexOf(this.type)>=0&&!this.plain?"":"u-hairline-border"}},data:function(){return{rippleTop:0,rippleLeft:0,fields:{},waveActive:!1}},methods:{click:function(e){var t=this;this.$u.throttle((function(){!0!==t.loading&&!0!==t.disabled&&(t.ripple&&(t.waveActive=!1,t.$nextTick((function(){this.getWaveQuery(e)}))),t.$emit("click",e))}),this.throttleTime)},getWaveQuery:function(e){var t=this;this.getElQuery().then((function(n){var i=n[0];if(i.width&&i.width&&(i.targetWidth=i.height>i.width?i.height:i.width,i.targetWidth)){t.fields=i;var o="",r="";o=e.touches[0].clientX,r=e.touches[0].clientY,t.rippleTop=r-i.top-i.targetWidth/2,t.rippleLeft=o-i.left-i.targetWidth/2,t.$nextTick((function(){t.waveActive=!0}))}}))},getElQuery:function(){var e=this;return new Promise((function(t){var n="";n=uni.createSelectorQuery().in(e),n.select(".u-btn").boundingClientRect(),n.exec((function(e){t(e)}))}))},getphonenumber:function(e){this.$emit("getphonenumber",e)},getuserinfo:function(e){this.$emit("getuserinfo",e)},error:function(e){this.$emit("error",e)},opensetting:function(e){this.$emit("opensetting",e)},launchapp:function(e){this.$emit("launchapp",e)}}};t.default=i},9896:function(e,t,n){"use strict";n.r(t);var i=n("218e"),o=n("a714");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},"9a75":function(e,t,n){"use strict";function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500;uni.showToast({title:e,icon:"none",duration:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i;t.default=o},"9cbd":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view")},r=[]},"9eb0":function(e,t,n){"use strict";n.r(t);var i=n("f3d8"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},a03d:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("view",{staticClass:e._$s(1,"sc","login"),attrs:{_i:1}},[n("image",{staticClass:e._$s(2,"sc","bg-img"),attrs:{_i:2}}),n("view",{staticClass:e._$s(3,"sc","login_title"),attrs:{_i:3}},[n("image",{attrs:{_i:4}})]),n("view",{class:e._$s(5,"c","login_user "+e.nameFocus),attrs:{_i:5}},[n("input",{attrs:{_i:6},on:{input:e.bindUsername,focus:e.onFocusName,blur:e.onBlurName}})]),n("view",{class:e._$s(7,"c","login_pwd "+e.psdFocus),attrs:{_i:7}},[n("input",{attrs:{type:e._$s(8,"a-type","password"==e.type?"text":e.type),password:e._$s(8,"a-password",!e.showPassword),_i:8},on:{input:e.bindPassword,focus:e.onFocusPsd,blur:e.onBlurPsd}}),n("image",{staticClass:e._$s(9,"sc","psdIcon"),attrs:{src:e._$s(9,"a-src",e.showPassword?"/static/images/eye.png":"/static/images/eye-fill.png"),_i:9},on:{click:function(t){e.showPassword=!e.showPassword}}})]),n("view",{staticClass:e._$s(10,"sc","login_btn"),attrs:{_i:10}},[n("button",{attrs:{_i:11},on:{click:e.login}})]),n("view",{staticClass:e._$s(12,"sc","login_text"),attrs:{_i:12}},[n("navigator",{})])])])},r=[]},a34a:function(e,t,n){e.exports=n("bbdd")},a429:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[e._$s(1,"i",e.search_friend)?n("view",{staticClass:e._$s(1,"sc","search_input"),attrs:{_i:1}},[n("view",[n("icon",{}),n("input",{attrs:{_i:4}})]),n("text",{attrs:{_i:5},on:{click:e.cancel}})]):e._e(),n("view",{staticClass:e._$s(6,"sc","contain"),attrs:{_i:6}},[n("view",{staticClass:e._$s(7,"sc","build_group"),attrs:{_i:7},on:{click:e.build_group}},[n("image",{attrs:{_i:8}}),n("text"),n("image",{staticClass:e._$s(10,"sc","next2"),attrs:{_i:10}})]),e._l(e._$s(11,"f",{forItems:e.groupList}),(function(t,i,o,r){return n("view",{key:e._$s(11,"f",{forIndex:o,key:i}),staticClass:e._$s("11-"+r,"sc","groupList"),attrs:{_i:"11-"+r}},[n("view",{staticClass:e._$s("12-"+r,"sc","info"),attrs:{_i:"12-"+r}},[n("image",{attrs:{"data-username":e._$s("13-"+r,"a-data-username",t.groupname),_i:"13-"+r}})]),n("view",{staticClass:e._$s("14-"+r,"sc","nbr_body"),attrs:{"data-username":e._$s("14-"+r,"a-data-username",t.groupname),"data-roomid":e._$s("14-"+r,"a-data-roomid",t.groupid),_i:"14-"+r},on:{click:e.into_room}},[n("text",{attrs:{"data-username":e._$s("15-"+r,"a-data-username",t.groupname),_i:"15-"+r}},[e._v(e._$s("15-"+r,"t0-0",e._s(t.groupname)))])]),n("view",{staticClass:e._$s("16-"+r,"sc","edit"),attrs:{"data-username":e._$s("16-"+r,"a-data-username",t.groupname),"data-roomid":e._$s("16-"+r,"a-data-roomid",t.groupid),_i:"16-"+r},on:{click:e.edit_group}},[n("image",{attrs:{"data-username":e._$s("17-"+r,"a-data-username",t.groupname),_i:"17-"+r}})])])}))],2),e._$s(18,"i",e.show_mask)?n("view",{staticClass:e._$s(18,"sc","mask"),attrs:{_i:18},on:{click:e.close_mask}}):e._e()])},r=[]},a52c:function(e,t,n){"use strict";n.r(t);var i=n("981e"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},a58c:function(e,t,n){"use strict";n.r(t);var i=n("0d8c"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},a714:function(e,t,n){"use strict";n.r(t);var i=n("195c"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},a833:function(e,t){e.exports={PLAYING:"playing",PAUSE:"pause",STOP:"stop"}},a845:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","createGroup"),attrs:{_i:0}},[n("view",{staticClass:e._$s(1,"sc","create_input"),attrs:{_i:1}},[n("view",[n("input",{attrs:{_i:3},on:{input:e.getGroupName}})])]),n("view",{staticClass:e._$s(4,"sc","create_textarea"),attrs:{_i:4}},[n("text"),n("view",[n("textarea",{attrs:{_i:7},on:{input:e.getGroupDec}})])]),n("view",{staticClass:e._$s(8,"sc","friend_list"),attrs:{_i:8}},[n("view",[n("text",{staticClass:e._$s(10,"sc","invite_text"),attrs:{_i:10}}),n("checkbox-group",{staticClass:e._$s(11,"sc","checkbox-group"),attrs:{_i:11},on:{change:e.inviteFriendFun}},e._l(e._$s(12,"f",{forItems:e.friendList}),(function(t,i,o,r){return n("label",{key:e._$s(12,"f",{forIndex:o,key:i}),staticClass:e._$s("12-"+r,"sc","checkbox labelStyle"),attrs:{_i:"12-"+r}},[n("checkbox",{attrs:{value:e._$s("13-"+r,"a-value",t.name),_i:"13-"+r}}),n("image",{attrs:{_i:"14-"+r}}),n("text",[e._v(e._$s("15-"+r,"t0-0",e._s(t.name)))])])})),0)])]),n("view",{staticClass:e._$s(16,"sc","create_btn"),attrs:{_i:16}},[n("button",{attrs:{_i:17},on:{click:e.createGroup}})])])},r=[]},a8e9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("c27b"));function o(e){return e&&e.__esModule?e:{default:e}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e=(0,i.default)(e),"object"!==typeof e||"object"!==typeof t)return!1;for(var n in t)t.hasOwnProperty(n)&&(n in e?"object"!==typeof e[n]||"object"!==typeof t[n]?e[n]=t[n]:e[n].concat&&t[n].concat?e[n]=e[n].concat(t[n]):e[n]=r(e[n],t[n]):e[n]=t[n]);return e}var s=r;t.default=s},ac83:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("view",{staticClass:e._$s(1,"sc","setting_list"),attrs:{_i:1}},[n("view",{staticClass:e._$s(2,"sc","setting_listContent"),attrs:{_i:2}},[n("text"),n("text")])]),n("view",{staticClass:e._$s(5,"sc","setting_list"),attrs:{_i:5}},[n("view",{staticClass:e._$s(6,"sc","setting_listContent"),attrs:{_i:6}},[n("text"),n("switch",{attrs:{checked:e._$s(8,"a-checked",!!e.switchStatus),_i:8},on:{change:e.openDebug}})])])])},r=[]},acf2:function(e,t,n){"use strict";n.r(t);var i=n("5a2d"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},ad3a:function(e,t,n){"use strict";n.r(t);var i=n("761e"),o=n("9eb0");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},ae08:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("01d4"),r=n("25e4"),s=n("92be"),a={data:function(){return{}},components:{},props:{username:{type:Object,default:function(){return{}}},chatType:{type:String,default:o.chatType.SINGLE_CHAT}},methods:{openCamera:function(){var e=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["camera"],success:function(t){e.upLoadImage(t)}})},sendImage:function(){var t=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(n){e("log","\u9009\u62e9\u7684\u56fe\u7247",n," at components/chat/inputbar/suit/image/image.vue:48"),t.upLoadImage(n)}})},isGroupChat:function(){return this.chatType==o.chatType.CHAT_ROOM},getSendToParam:function(){return this.isGroupChat()?this.username.groupId:this.username.your},upLoadImage:function(t){var n=this,s=t.tempFilePaths,a=i.conn.context.accessToken;uni.getImageInfo({src:t.tempFilePaths[0],success:function(t){var c={jpg:!0,jpeg:!0,gif:!0,png:!0,bmp:!0},u=i.config.appkey.split("#"),d=t.width,l=t.height,f=t.path.lastIndexOf(".");e("log","index>>",f," at components/chat/inputbar/suit/image/image.vue:82");var p=~f&&t.path.slice(f+1)||"";t.type||uni.showToast({title:"H5\u7aef\uff0cuni-app\u6682\u672a\u652f\u6301",icon:"none"}),(p.toLowerCase()in c||t.type in c)&&uni.uploadFile({url:"https://a1.easemob.com/"+u[0]+"/"+u[1]+"/chatfiles",filePath:s[0],fileType:"image",name:"file",header:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+a},success:function(t){if(e("log","\u4e0a\u4f20\u56fe\u7247\u6210\u529f",t," at components/chat/inputbar/suit/image/image.vue:102"),400==t.statusCode)return uni.showToast({title:"\u56fe\u7247\u68c0\u6d4b\u4e0d\u5408\u6cd5",duration:1e3}),!1;var a=t.data,c=JSON.parse(a),u=i.conn.getUniqueId(),f=new i.message(o.IMAGE,u),h={type:o.IMAGE,size:{width:d,height:l},url:c.uri+"/"+c.entities[0].uuid,filetype:p,filename:s[0]};f.set({apiUrl:i.config.apiURL,body:h,from:n.username.myName,to:n.getSendToParam(),roomType:!1,chatType:n.chatType,success:function(e){r.fire("em.chat.sendSuccess",u)}}),n.chatType==o.chatType.CHAT_ROOM&&f.setGroup("groupchat"),i.conn.send(f.body);var m={msg:f,type:o.IMAGE};n.saveSendMsg(m)},fail:function(t){e("log","\u4e0a\u4f20\u5931\u8d25",t," at components/chat/inputbar/suit/image/image.vue:153")},complete:function(t){e("log","\u4e0a\u4f20\u5b8c\u6210",t," at components/chat/inputbar/suit/image/image.vue:156")}})}})},saveSendMsg:function(e){s.saveMsg(e.msg,e.type)}}};t.default=a}).call(this,n("0de9")["default"])},b021:function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=this.$parent;while(t){if(!t.$options||t.$options.name===e)return t;t=t.$parent}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},b08a:function(e,t,n){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n("f21b")),r=u(n("b94c")),s=u(n("508f")),a=u(n("4bbc")),c=u(n("e765"));function u(e){return e&&e.__esModule?e:{default:e}}var d=n("92be"),l=n("01d4"),f={data:function(){return{__comps__:{msglist:null,inputbar:null,audio:null},inputbarVisible:"block",action:null,pubUrl:"",subUrl:"",showEmedia:!1,showmultiEmedia:!1,showEmediaInvite:!1,emediaAction:null,multiEmediaVisible:"block",confrId:"",groupId:"",confrMember:[]}},components:{chatMsglist:o.default,chatInputbar:r.default,chatSuitAudio:s.default,chatEmediaInvite:a.default,chatMultiEmedia:c.default},props:{username:{type:Object,default:function(){return{}}},chatType:{type:String,default:l.chatType.SINGLE_CHAT}},computed:{computedUserName:function(){return this.username}},mounted:function(){this.username=uni.username,uni.$on("createConfrSuccess",this.onCreateConfrSuccess)},moved:function(){},destroyed:function(){},methods:{toggleRecordModal:function(){this.$refs.chatSuitAudio.toggleRecordModal()},normalScroll:function(){this.$refs.chatMsglist.normalScroll(),this.$refs.chatInputbar.cancelEmoji(),this.$refs.chatInputbar.closeFunModal()},clickMsg:function(t){this.$emit("onClickInviteMsg",t),e("log","\u70b9\u51fb\u6d88\u606f\u4e0a\u4e00\u7ea7",t," at components/chat/chat.vue:130")},shortScroll:function(){this.$refs.chatMsglist.shortScroll()},saveSendMsg:function(e){d.saveMsg(e.msg,e.type),this.$refs.chatInputbar.cancelEmoji(),this.$refs.chatInputbar.closeFunModal()},getMore:function(){this.$refs.chatMsglist.getHistoryMsg()},onMakeVideoCall:function(){this.setData({showEmediaInvite:!0,inputbarVisible:"none",action:"create"}),e("log",this.showEmediaInvite," at components/chat/chat.vue:153")},onStartConfr:function(t){e("log","\u53d1\u8d77\u9080\u8bf7\u7684\u56de\u8c03",t," at components/chat/chat.vue:156"),this.setData({showEmediaInvite:!1,showmultiEmedia:!0,multiEmediaVisible:"block",inputbarVisible:"none",confrMember:t.confrMember,emediaAction:{action:"create"}}),this.$emit("onMakeVideoCall",{confrMember:t.confrMember,groupId:this.username.groupId})},onCreateConfrSuccess:function(t){e("log","\u521b\u5efa\u4f1a\u6210\u529f\u8bae\u56de\u8c03",t," at components/chat/chat.vue:174"),this.setData({confrId:t.confrId}),getApp().globalData.confrId=t.confrId,this.sendInviteMsg(this.confrMember,t.confrId,t)},onGoBack:function(){this.setData({showEmediaInvite:!1,showmultiEmedia:!0,multiEmediaVisible:"block",inputbarVisible:"none",confrMember:[]})},onInviteMember:function(e){var t=this.username;this.username.groupId||(t.groupId=e.detail),this.setData({action:"invite",showEmediaInvite:!0,inputbarVisible:"none",multiEmediaVisible:"none"})},onMakeAudioCall:function(){this.setData({showEmediaInvite:!0,showmultiEmedia:!1,inputbarVisible:"none"})},onClickInviteMsg:function(t){e("log","\u6536\u5230\u9080\u8bf7\u6d88\u606f"," at components/chat/chat.vue:214"),e("log",t," at components/chat/chat.vue:215");var n=t.conferenceId,i="string"==typeof t.msg_extension?JSON.parse(t.msg_extension):t.msg_extension,o=t.password||"";this.setData({emediaAction:{action:"join",confrId:n,password:o,roomName:t.roomName||""},showEmediaInvite:!1,showmultiEmedia:!0,inputbarVisible:"none",groupId:i.group_id})},onHangup:function(){this.setData({showEmediaInvite:!1,showmultiEmedia:!1,inputbarVisible:"block"}),getApp().globalData.confrId=""},sendInviteMsg:function(t,n,o){var r=this;e("log","%c members","background: green"," at components/chat/chat.vue:241"),e("log",t," at components/chat/chat.vue:242"),e("log","\u8fdb\u5165\u53d1\u9080\u8bf7\u7684\u51fd\u6570",t," at components/chat/chat.vue:243"),e("log","this.username.groupId----",this.username.groupId," at components/chat/chat.vue:244"),e("log","confrId",n," at components/chat/chat.vue:246"),e("log","data",o," at components/chat/chat.vue:247"),t&&t.forEach((function(t){var n=uni.WebIM.conn.getUniqueId(),o=new uni.WebIM.message("txt",n);o.set({msg:i.WebIM.conn.context.userId+" invite you to video call",from:i.WebIM.conn.context.userId,to:t,roomType:!1,chatType:"singleChat",ext:{msg_extension:JSON.stringify({inviter:i.WebIM.conn.context.userId,group_id:r.username.groupId}),password:"123456",conferenceId:getApp().globalData.confrId},success:function(n,i){e("log","\u53d1\u9001\u9080\u8bf7\u6d88\u606f\u6210\u529f to: "+t," at components/chat/chat.vue:268")},fail:function(t,n){e("log","\u53d1\u9001\u9080\u8bf7\u6d88\u606f\u5931\u8d25\u4e86"," at components/chat/chat.vue:272")}}),e("log","\u53d1\u9001\u9080\u8bf7",o.body," at components/chat/chat.vue:279"),uni.WebIM.conn.send(o.body)}))}}};t.default=f}).call(this,n("0de9")["default"],n("fe07")["default"])},b186:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));try{i={uButton:n("c901").default}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. \u6392\u67e5\u7ec4\u4ef6\u540d\u79f0\u62fc\u5199\u662f\u5426\u6b63\u786e"),console.error("2. \u6392\u67e5\u7ec4\u4ef6\u662f\u5426\u7b26\u5408 easycom \u89c4\u8303\uff0c\u6587\u6863\uff1ahttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. \u82e5\u7ec4\u4ef6\u4e0d\u7b26\u5408 easycom \u89c4\u8303\uff0c\u9700\u624b\u52a8\u5f15\u5165\uff0c\u5e76\u5728 components \u4e2d\u6ce8\u518c\u8be5\u7ec4\u4ef6")}var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","inform"),attrs:{_i:0}},[e._$s(1,"i",!e.friendList.length>0)?n("text",{staticClass:e._$s(1,"sc","defaultText"),attrs:{_i:1}}):e._e(),e._l(e._$s(2,"f",{forItems:e.friendList}),(function(t,i,o,r){return n("view",{key:e._$s(2,"f",{forIndex:o,key:i}),staticClass:e._$s("2-"+r,"sc","itemBar"),attrs:{_i:"2-"+r}},[n("view",{staticClass:e._$s("3-"+r,"sc","notInfoDetContent"),attrs:{_i:"3-"+r}},[n("view",{staticClass:e._$s("4-"+r,"sc","headContent"),attrs:{_i:"4-"+r}},[n("image",{attrs:{_i:"5-"+r}})]),n("view",{staticClass:e._$s("6-"+r,"sc","infoContent"),attrs:{_i:"6-"+r}},[n("text",{staticClass:e._$s("7-"+r,"sc","itemName"),attrs:{_i:"7-"+r}},[e._v(e._$s("7-"+r,"t0-0",e._s(t.from)))]),n("text")])]),n("view",{staticClass:e._$s("9-"+r,"sc","buttonContent"),attrs:{_i:"9-"+r}},[e._$s("10-"+r,"i",!t.typeText)?n("view",{staticClass:e._$s("10-"+r,"sc","rejectBtn"),attrs:{"data-from":e._$s("10-"+r,"a-data-from",t.from),_i:"10-"+r},on:{click:e.reject}}):e._e(),e._$s("11-"+r,"i",!t.typeText)?n("view",{staticClass:e._$s("11-"+r,"sc","centerLine"),attrs:{_i:"11-"+r}}):e._e(),e._$s("12-"+r,"i",!t.typeText)?n("view",{staticClass:e._$s("12-"+r,"sc","agreeBtn"),attrs:{"data-from":e._$s("12-"+r,"a-data-from",t.from),_i:"12-"+r},on:{click:e.agree}}):e._e(),e._$s("13-"+r,"i",t.typeText)?n("view",{staticClass:e._$s("13-"+r,"sc","actionDone"),attrs:{_i:"13-"+r}},[e._v(e._$s("13-"+r,"t0-0",e._s(t.typeText)))]):e._e()])])})),n("view",{staticClass:e._$s(14,"sc","black"),attrs:{_i:14}},[n("u-button",{attrs:{ripple:!0,_i:15},on:{click:e.into_chat}},[e._v("")])],1)],2)},r=[]},b1a0:function(e,t,n){"use strict";n.r(t);var i=n("c4bd"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},b1f0:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","main"),attrs:{_i:0}},[n("view",{staticClass:e._$s(1,"sc","main"),attrs:{_i:1}},[n("chatSuitAudio",{ref:"chatSuitAudio",attrs:{username:e.username,chatType:e.chatType,_i:2},on:{newAudioMsg:e.saveSendMsg}}),n("chatMsglist",{ref:"chatMsglist",attrs:{username:e.username,id:"chat-msglist",_i:3},on:{msglistTap:e.normalScroll,clickMsg:e.clickMsg}})],1),n("chatInputbar",{directives:[{name:"show",rawName:"v-show",value:e._$s(4,"v-show",!e.showEmediaInvite),expression:"_$s(4,'v-show',!showEmediaInvite)"}],ref:"chatInputbar",attrs:{username:e.username,chatType:e.chatType,_i:4},on:{newTextMsg:e.saveSendMsg,newImageMsg:e.saveSendMsg,newLocationMsg:e.saveSendMsg,newVideoMsg:e.saveSendMsg,tapSendAudio:e.toggleRecordModal,inputFocused:e.shortScroll,inputBlured:e.normalScroll,makeVideoCall:e.onMakeVideoCall,makeAudioCall:e.onMakeAudioCall}}),e._$s(5,"i",e.showEmediaInvite)?n("chatEmediaInvite",{attrs:{username:e.username,action:e.action,_i:5},on:{onStartConfr:e.onStartConfr,goBack:e.onGoBack}}):e._e()],1)},r=[]},b807:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{class:e._$s(0,"c",e.view+" wrap "+(e.isIPX?"scroll_view_X":"")),attrs:{"scroll-into-view":e._$s(0,"a-scroll-into-view",e.toView),_i:0},on:{click:e.onTap}},e._l(e._$s(1,"f",{forItems:e.chatMsg}),(function(t,i,o,r){return n("view",{key:e._$s(1,"f",{forIndex:o,key:t.mid}),staticClass:e._$s("1-"+r,"sc","message"),attrs:{id:e._$s("1-"+r,"a-id",t.mid),_i:"1-"+r}},[n("view",{staticClass:e._$s("2-"+r,"sc","main"),class:e._$s("2-"+r,"c",t.style),attrs:{_i:"2-"+r}},[n("view",{staticClass:e._$s("3-"+r,"sc","user"),attrs:{_i:"3-"+r}},[n("text",{staticClass:e._$s("4-"+r,"sc","user-text"),attrs:{_i:"4-"+r}},[e._v(e._$s("4-"+r,"t0-0",e._s(t.yourname+" "+t.time)))])]),n("image",{staticClass:e._$s("5-"+r,"sc","avatar"),attrs:{_i:"5-"+r}}),n("view",{staticClass:e._$s("6-"+r,"sc","msg"),attrs:{_i:"6-"+r}},[n("image",{staticClass:e._$s("7-"+r,"sc","err"),class:e._$s("7-"+r,"c","self"==t.style&&t.isFail?"show":"hide"),attrs:{_i:"7-"+r}}),e._$s("8-"+r,"i","self"==t.style)?n("image",{staticClass:e._$s("8-"+r,"sc","msg_poprightarrow"),attrs:{_i:"8-"+r}}):e._e(),e._$s("9-"+r,"i",""==t.style)?n("image",{staticClass:e._$s("9-"+r,"sc","msg_popleftarrow"),attrs:{_i:"9-"+r}}):e._e(),e._$s("10-"+r,"i","img"==t.msg.type||"video"==t.msg.type)?n("view",[e._$s("11-"+r,"i","img"==t.msg.type)?n("image",{staticClass:e._$s("11-"+r,"sc","avatar"),attrs:{src:e._$s("11-"+r,"a-src",t.msg.data),"data-url":e._$s("11-"+r,"a-data-url",t.msg.data),_i:"11-"+r},on:{click:e.previewImage}}):e._e()]):e._e(),e._$s("12-"+r,"i","audio"==t.msg.type)?n("audio-msg",{attrs:{msg:t,_i:"12-"+r}}):e._$s("13-"+r,"e","txt"==t.msg.type||"emoji"==t.msg.type)?n("view",e._l(e._$s("14-"+r,"f",{forItems:t.msg.data}),(function(i,o,s,a){return n("view",{key:e._$s("14-"+r,"f",{forIndex:s,key:o}),staticClass:e._$s("14-"+r+"-"+a,"sc","template"),attrs:{_i:"14-"+r+"-"+a}},[e._$s("15-"+r+"-"+a,"i","txt"==i.type)?n("text",{staticClass:e._$s("15-"+r+"-"+a,"sc","msg-text"),attrs:{"data-msg":e._$s("15-"+r+"-"+a,"a-data-msg",t),_i:"15-"+r+"-"+a},on:{click:e.clickMsg}},[e._v(e._$s("15-"+r+"-"+a,"t0-0",e._s(i.data)))]):e._e(),e._$s("16-"+r+"-"+a,"i","emoji"==i.type)?n("image",{staticClass:e._$s("16-"+r+"-"+a,"sc","avatar"),attrs:{src:e._$s("16-"+r+"-"+a,"a-src","/static/images/faces/"+i.data),_i:"16-"+r+"-"+a}}):e._e()])})),0):e._e()],1)])])})),0)},r=[]},b94c:function(e,t,n){"use strict";n.r(t);var i=n("1ce7"),o=n("21a6");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},b966:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:e._$s(0,"sc","text-input"),attrs:{_i:0}},[n("view",{class:e._$s(1,"c",e.isIPX?"f-row-x":"f-row"),attrs:{_i:1}},[n("view",[n("image",{staticClass:e._$s(3,"sc","icon-mic"),attrs:{_i:3},on:{click:e.openRecordModal}})]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.inputMessage,expression:"inputMessage"}],staticClass:e._$s(4,"sc","f news"),attrs:{"confirm-hold":e._$s(4,"a-confirm-hold",!!e.isIPX),_i:4},domProps:{value:e._$s(4,"v-model",e.inputMessage)},on:{confirm:e.sendMessage,input:[function(t){t.target.composing||(e.inputMessage=t.target.value)},e.bindMessage],focus:e.focus,blur:e.blur,click:e.focus}}),n("view",[n("image",{staticClass:e._$s(6,"sc","icon-mic"),attrs:{_i:6},on:{click:e.openEmoji}})]),n("view",{directives:[{name:"show",rawName:"v-show",value:e._$s(7,"v-show",!e.inputMessage),expression:"_$s(7,'v-show',!inputMessage)"}],attrs:{_i:7},on:{click:e.openFunModal}},[n("image",{staticClass:e._$s(8,"sc","icon-mic"),attrs:{_i:8}})]),n("button",{directives:[{name:"show",rawName:"v-show",value:e._$s(9,"v-show",e.inputMessage),expression:"_$s(9,'v-show',inputMessage)"}],staticClass:e._$s(9,"sc","send-btn-style"),attrs:{_i:9},on:{click:e.sendMessage}})])])},r=[]},bb10:function(e,t,n){"use strict";n.r(t);var i=n("ae08"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},bbdd:function(e,t,n){var i=function(){return this||"object"===typeof self&&self}()||Function("return this")(),o=i.regeneratorRuntime&&Object.getOwnPropertyNames(i).indexOf("regeneratorRuntime")>=0,r=o&&i.regeneratorRuntime;if(i.regeneratorRuntime=void 0,e.exports=n("96cf"),o)i.regeneratorRuntime=r;else try{delete i.regeneratorRuntime}catch(s){i.regeneratorRuntime=void 0}},bf77:function(e,t,n){"use strict";n.r(t);var i=n("38cb"),o=n("275d");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},c033:function(e,t,n){"use strict";n.r(t);var i=n("6d90"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},c0ff:function(e,t,n){"use strict";n.r(t);var i=n("4219"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},c27b:function(e,t,n){"use strict";function i(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){if([null,void 0,NaN,!1].includes(e))return e;if("object"!==typeof e&&"function"!==typeof e)return e;var t=i(e)?[]:{};for(var n in e)e.hasOwnProperty(n)&&(t[n]="object"===typeof e[n]?o(e[n]):e[n]);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o;t.default=r},c4a8:function(e,t){var n=[],i=[];function o(){i.push(this),n.push({})}o.prototype={on:function(e,t){var o=n[i.indexOf(this)],r=o[e]=o[e]||[];~r.indexOf(t)||r.push(t)},off:function(e,t){var o=n[i.indexOf(this)],r=o[e]=o[e]||[],s=r.indexOf(t);~s&&r.splice(s,1)},fire:function(e){for(var t=n[i.indexOf(this)],o=t[e]=t[e]||[],r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];for(var c=0;c<o.length;c++)o[c].apply(null,s)}},e.exports=o},c4bd:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;i(n("4422"));function i(e){return e&&e.__esModule?e:{default:e}}var o=n("0c53")["default"],r=n("25e4"),s={data:function(){return{roomId:"",groupName:"",currentName:"",groupMember:[],curOwner:"",groupDec:"",groupCount:"",addFriendName:[],isOwner:!1}},components:{},onLoad:function(e){var t=this;this.setData({roomId:JSON.parse(e.groupInfo).roomId,groupName:JSON.parse(e.groupInfo).groupName,currentName:JSON.parse(e.groupInfo).myName}),r.on("em.group.leaveGroup",(function(){var e=getCurrentPages();e[e.length-1].route===t.__route__&&(t.getGroupMember(),this.getGroupInfo())})),this.getGroupMember(),this.getGroupInfo()},methods:{getGroupMember:function(){var e=this,t=1,n=1e3,i={pageNum:t,pageSize:n,groupId:this.roomId,success:function(t){t&&t.data&&e.setData({groupMember:t.data,groupCount:t.count})},error:function(e){}};o.conn.listGroupMember(i)},getGroupInfo:function(){var e=this,t={groupId:this.roomId,success:function(t){t&&t.data&&(e.setData({curOwner:t.data[0].owner,groupDec:t.data[0].description}),e.currentName==t.data[0].owner&&e.setData({isOwner:!0}))},error:function(){}};o.conn.getGroupInfo(t)},addFriendNameFun:function(e){var t=[];t.push(e.detail.value),this.setData({addFriendName:t})},addGroupMembers:function(){var e=this,t={users:this.addFriendName,groupId:this.roomId,success:function(){e.isExistGroup(e.addFriendName,e.groupMember)?uni.showToast({title:"\u5df2\u5728\u7fa4\u4e2d",duration:2e3}):uni.showToast({title:"\u9080\u8bf7\u5df2\u53d1\u51fa",duration:2e3}),e.getGroupMember()},error:function(e){uni.showToast({title:e.data.error_description,icon:"none"})}};o.conn.inviteToGroup(t)},isExistGroup:function(e,t){for(var n=0;n<t.length;n++)if(e==t[n].member||e==t[n].owner)return!0;return!1},leaveGroup:function(){var e=this;o.conn.quitGroup({groupId:this.roomId,success:function(){uni.showToast({title:"\u5df2\u9000\u7fa4",duration:2e3,success:function(t){setTimeout((function(){return uni.navigateBack({url:"../groups/groups?myName="+e.currentName})}),2e3)}}),r.fire("em.invite.deleteGroup")},error:function(e){uni.showToast({title:e.data.error_description,icon:"none"})}})},dissolveGroup:function(){o.conn.dissolveGroup({groupId:this.roomId,success:function(){uni.showToast({title:"\u5df2\u89e3\u6563",duration:2e3,success:function(e){setTimeout((function(){return uni.redirectTo({url:"../chat/chat"})}),1e3)}})},error:function(e){uni.showToast({title:e.data.error_description,icon:"none"})}})}}};t.default=s},c4f7:function(e,t,n){"use strict";n.r(t);var i=n("a03d"),o=n("2aa9");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},c678:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:e._$s(0,"sc","group-wrap"),attrs:{_i:0}},[n("view",{staticClass:e._$s(1,"sc","wrap"),attrs:{_i:1}},[n("view",{staticClass:e._$s(2,"sc","title-card"),attrs:{_i:2}},[n("image",{attrs:{_i:3}}),n("view",[n("p",[e._v(e._$s(5,"t0-0",e._s(e.groupName)))]),n("p",[e._v(e._$s(6,"t0-0",e._s(e.groupDec)))])])]),n("view",{staticClass:e._$s(7,"sc","group-member"),attrs:{_i:7}},[n("view",[n("text",{staticClass:e._$s(9,"sc","textd-10"),attrs:{_i:9}}),n("text",[e._v(e._$s(10,"t0-0",e._s(e.groupCount)))])]),e._l(e._$s(11,"f",{forItems:e.groupMember}),(function(t,i,o,r){return n("view",{key:e._$s(11,"f",{forIndex:o,key:i})},[n("view",{staticClass:e._$s("12-"+r,"sc","member-list"),attrs:{_i:"12-"+r}},[n("image",{attrs:{_i:"13-"+r}}),n("text",[e._v(e._$s("14-"+r,"t0-0",e._s(t.member||t.owner)))])])])}))],2),n("view",{staticClass:e._$s(15,"sc","invite-member"),attrs:{_i:15}},[n("view",{staticClass:e._$s(16,"sc","invite-wrap"),attrs:{_i:16}},[n("input",{attrs:{_i:17},on:{input:e.addFriendNameFun}}),n("button",{attrs:{_i:18},on:{click:e.addGroupMembers}})])]),n("view",{staticClass:e._$s(19,"sc","group-name"),attrs:{_i:19}},[n("text",{staticClass:e._$s(20,"sc","pd-10"),attrs:{_i:20}}),n("text",{staticClass:e._$s(21,"sc","item-name"),attrs:{_i:21}},[e._v(e._$s(21,"t0-0",e._s(e.groupName)))])]),n("view",{staticClass:e._$s(22,"sc","group-name"),attrs:{_i:22}},[n("text",{staticClass:e._$s(23,"sc","pd-10"),attrs:{_i:23}}),n("view",{staticClass:e._$s(24,"sc","item-name"),attrs:{_i:24}},[e._v(e._$s(24,"t0-0",e._s(e.groupDec)))])]),n("view",{staticClass:e._$s(25,"sc","bottom-wrap"),attrs:{_i:25}},[e._$s(26,"i",e.isOwner)?n("view",{staticClass:e._$s(26,"sc","disband-group"),attrs:{_i:26}},[n("button",{attrs:{_i:27},on:{click:e.dissolveGroup}})]):e._e(),e._$s(28,"i",!e.isOwner)?n("view",{staticClass:e._$s(28,"sc","exit-group"),attrs:{_i:28}},[n("button",{attrs:{_i:29},on:{click:e.leaveGroup}})]):e._e()])])])},r=[]},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(i){"object"===typeof window&&(n=window)}e.exports=n},c901:function(e,t,n){"use strict";n.r(t);var i=n("4115"),o=n("a52c");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"3dbaaa8a",null,!1,i["a"],s);t["default"]=c.exports},c94e:function(e,t,n){"use strict";n.r(t);var i=n("01d47"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},ca3a:function(e,t,n){"use strict";n.r(t);var i=n("3ea4"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},cbda:function(e,t,n){"undefined"===typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))}),uni.restoreGlobal&&uni.restoreGlobal(weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),__definePage("pages/login/login",(function(){return Vue.extend(n("c4f7").default)})),__definePage("pages/notification_groupDetail/groupDetail",(function(){return Vue.extend(n("feef").default)})),__definePage("pages/notification_friendDetail/friendDetail",(function(){return Vue.extend(n("7b63").default)})),__definePage("pages/login_token/login_token",(function(){return Vue.extend(n("bf77").default)})),__definePage("pages/main/main",(function(){return Vue.extend(n("0170").default)})),__definePage("pages/chatroom/chatroom",(function(){return Vue.extend(n("dcf2").default)})),__definePage("pages/index/index",(function(){return Vue.extend(n("48e2").default)})),__definePage("pages/register/register",(function(){return Vue.extend(n("12bc").default)})),__definePage("pages/add_new/add_new",(function(){return Vue.extend(n("01d8").default)})),__definePage("pages/chat/chat",(function(){return Vue.extend(n("ecaa").default)})),__definePage("pages/notification/notification",(function(){return Vue.extend(n("0300").default)})),__definePage("pages/setting_general/setting_general",(function(){return Vue.extend(n("df55").default)})),__definePage("pages/groups/groups",(function(){return Vue.extend(n("8d25").default)})),__definePage("pages/inform/inform",(function(){return Vue.extend(n("138c").default)})),__definePage("pages/setting/setting",(function(){return Vue.extend(n("5b60").default)})),__definePage("pages/add_groups/add_groups",(function(){return Vue.extend(n("9680").default)})),__definePage("pages/groupChatRoom/groupChatRoom",(function(){return Vue.extend(n("8168").default)})),__definePage("pages/groupSetting/groupSetting",(function(){return Vue.extend(n("5504").default)}))},cd12:function(e,t,n){"use strict";n.r(t);var i=n("1adc"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},cdeb:function(e,t,n){"use strict";n.r(t);var i=n("e25e"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},ce34:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={xmppURL:"wss://im-api-wechat.easemob.com/websocket",apiURL:"https://a1.easemob.com",appkey:"easemob-demo#chatdemoui",https:!1,isMultiLoginSessions:!1,isWindowSDK:!1,isSandBox:!1,isDebug:!1,autoReconnectNumMax:15,autoReconnectInterval:2,isWebRTC:!1,isAutoLogin:!0},o=i;t.default=o},d2e0:function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];-1==["primary","info","error","warning","success"].indexOf(e)&&(e="success");var n="";switch(e){case"primary":n="info-circle";break;case"info":n="info-circle";break;case"error":n="close-circle";break;case"warning":n="error-circle";break;case"success":n="checkmark-circle";break;default:n="checkmark-circle"}return t&&(n+="-fill"),n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i;t.default=o},d94d:function(e,t,n){"use strict";n.r(t);var i=n("425f"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},da2f:function(e,t,n){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{pubUrl:"",subUrls:[],showInvite:!0,devicePosition:"front",muted:!1,playVideoMuted:!1,devicePositionIcon:"switchCamera_white",devicePositionColor:"#fff",micphoneIcon:"micphone_white",beautyIcon:"beauty",micphoneColor:"#fff",videoIcon:"video_white",videoColor:"#fff",beauty:9,beautyColor:"#fff",myName:"",confrId:"",enableCamera:!0,time:"",context:{}}},props:{username:{type:Object,default:function(){return{}}},action:{type:Object,default:{}},groupId:{type:String,default:""}},methods:{joinRoom:function(t){var i=this;e("log","joinRoom",t," at components/chat/multiemedia/index.nvue:111"),i.context=uni.createLivePusherContext("livePusher",i),e("log","\u6211\u7684\u64ad\u653e\u7ec4\u4ef6",i.context," at components/chat/multiemedia/index.nvue:113");var o=this.context;o&&o.ctx&&o.ctx.attr&&o.ctx.attr.url&&o.stop();var r=n.WebIM.conn.getUniqueId(),s="wxConfr"+r,a=n.getStorageSync("rec")||!1,c=n.getStorageSync("recMerge")||!1,u={roomName:s,password:"",role:7,config:{rec:a,recMerge:c}};t&&(u.roomName=t.roomName,u.password=t.password),n.emedia.mgr.joinRoom(u).then((function(t){e("log","res",t," at components/chat/multiemedia/index.nvue:137");var o=t.confrId;i.setData({confrId:o}),i.$emit("createConfrSuccess",{confrId:o,groupId:i.username.groupId,roomName:u.roomName,password:u.password}),e("log","--------+--+----+---+--------"," at components/chat/multiemedia/index.nvue:144");var r=n.emedia.util.getRtcId();e("log",0xa1b01d4b1c7,o," at components/chat/multiemedia/index.nvue:146"),n.emedia.mgr.pubStream(r).then((function(t){e("log","pubUrl-------------",t.data.rtmp," at components/chat/multiemedia/index.nvue:148"),e("log",2222222222222," at components/chat/multiemedia/index.nvue:149"),i.setData({pubUrl:t.data.rtmp}),setTimeout((function(){e("log","55555555555",i," at components/chat/multiemedia/index.nvue:154"),e("log",i.context," at components/chat/multiemedia/index.nvue:155"),i.context.start()}),500)})).catch((function(t){return e("log",4444444,t," at components/chat/multiemedia/index.nvue:159"),f(!1)})).finally((function(t){e("log",100,t," at components/chat/multiemedia/index.nvue:163")})),e("log",33333333333333,i.pubUrl," at components/chat/multiemedia/index.nvue:165")}))},createConf:function(){e("log",">>> createConf"," at components/chat/multiemedia/index.nvue:171");var t=this,i=n.getStorageSync("rec")||!1,o=n.getStorageSync("recMerge")||!1;n.emedia.mgr.createConference(10,"",i,o).then((function(i){e("log","\u6210\u529f",i," at components/chat/multiemedia/index.nvue:178");var o=i.data.ticket,r=JSON.parse(o),s=r.confrId;n.emedia.mgr.joinConferenceWithTicket(s,o).then((function(t){e("log","\u52a0\u5165\u4f1a\u8bae\u6210\u529f",t," at components/chat/multiemedia/index.nvue:184")})),t.setData({confrId:s}),t.$emit("createConfrSuccess",{confrId:s,groupId:t.username.groupId})}))},joinConf:function(t){e("log","\u52a0\u5165\u4f1a\u8bae \u2014\u2014\u2014\u2014-------\u2014\u2014\u2014\u2014"," at components/chat/multiemedia/index.nvue:198"),e("log",t," at components/chat/multiemedia/index.nvue:199");var i=this;n.emedia.mgr.getConferenceTkt(t.confrId,t.password).then((function(o){e("log","\u7533\u8bf7reqTkt\u6210\u529f",o.data," at components/chat/multiemedia/index.nvue:202");var r=o.data.ticket||"",s=JSON.parse(r);n.emedia.mgr.joinConferenceWithTicket(t.confrId,r).then((function(t){e("log","\u52a0\u5165\u4f1a\u8bae\u6210\u529f",t," at components/chat/multiemedia/index.nvue:206")})),i.setData({confrId:s.confrId}),i.$emit("createConfrSuccess",{confrId:s.confrId,groupId:i.username.groupId})}))},togglePlay:function(){var t=this,n=this;e("log","%c togglePlay","color:green"," at components/chat/multiemedia/index.nvue:217"),this.setData({enableCamera:!n.enableCamera,pubUrl:n.pubUrl,videoIcon:"video_white"==this.videoIcon?"video_gray":"video_white",videoColor:"#fff"==this.videoColor?"#aaa":"#fff"},(function(){t.LivePusherContext.start()}))},toggleCamera:function(){e("log","%c toggleCamera","color:green"," at components/chat/multiemedia/index.nvue:231");var t=this;t.LivePusherContext.switchCamera({success:function(){t.setData({devicePosition:"fron"==t.devicePosition?"back":"front",devicePositionIcon:"switchCamera_white"==t.devicePositionIcon?"switchCamera_gray":"switchCamera_white",devicePositionColor:"#fff"==t.devicePositionColor?"#aaa":"#fff"},(function(){}))}})},toggleMuted:function(){e("log","%c toggleMuted","color:green"," at components/chat/multiemedia/index.nvue:249"),this.setData({muted:!this.muted,micphoneIcon:"micphone_white"==this.micphoneIcon?"micphone_gray":"micphone_white",micphoneColor:"#fff"==this.micphoneColor?"#aaa":"#fff"})},toggleBeauty:function(){this.setData({beauty:0==this.beauty?9:0,beautyColor:"#fff"==this.beautyColor?"#aaa":"#fff",beautyIcon:"beauty"==this.beautyIcon?"beauty_gray":"beauty"})},hangup:function(){e("log","\u6302\u65ad",this.confrId," at components/chat/multiemedia/index.nvue:266"),n.emedia.mgr.exitConference(this.confrId),this.$emit("hangup"),this.stopTimer()},inviteMember:function(){this.$emit("inviteMember",this.groupId)},netstatusChange:function(t){e("log",">>>>>>>>>>net status:",t.detail," at components/chat/multiemedia/index.nvue:283")},getTimer:function(){var e=this,t=0,n="00:00:00";function i(e){return e<10?"0"+e:e}this.timer=setInterval((function(){t++;var o=i(t%60),r=i(parseInt(t/60)%60),s=i(parseInt(t/60/60));n="".concat(s,":").concat(r,":").concat(o),e.setData({time:n})}),1e3)},stopTimer:function(){clearInterval(this.timer)},error:function(t){e("log","EEEEEEEEEEEEE",t," at components/chat/multiemedia/index.nvue:312")},statechange:function(t){e("log","SSSSSSSSSSS",t," at components/chat/multiemedia/index.nvue:315")}},mounted:function(){e("log","\u8fdb\u5165"," at components/chat/multiemedia/index.nvue:320"),n.setKeepScreenOn({keepScreenOn:!0}),e("log","\u8fdb\u5165111"," at components/chat/multiemedia/index.nvue:324"),this.setData({myName:n.WebIM.conn.context.userId}),e("log","\u8fdb\u5165222"," at components/chat/multiemedia/index.nvue:328"),this.getTimer();var t=this,i=[],o={};e("log","\u8fdb\u5165333"," at components/chat/multiemedia/index.nvue:333"),this.LivePusherContext=uni.createLivePusherContext("livePusher",this),e("log","this.LivePusherContext ..",this.LivePusherContext," at components/chat/multiemedia/index.nvue:335"),this.action&&"join"==this.action.action?(e("log","join"," at components/chat/multiemedia/index.nvue:337"),this.action.roomName?(e("log","\u4f7f\u7528joinroom"," at components/chat/multiemedia/index.nvue:344"),this.joinRoom(this.action)):(e("log","\u4f7f\u7528joinConf"," at components/chat/multiemedia/index.nvue:347"),this.joinConf(this.action))):this.joinRoom(),n.emedia.mgr.onMediaChanaged=function(t){e("log","onMediaChanaged",t," at components/chat/multiemedia/index.nvue:357")},n.emedia.mgr.onConferenceExit=function(t){e("log","onConferenceExit",t," at components/chat/multiemedia/index.nvue:360")},n.emedia.mgr.onMemberExited=function(t){e("log","onMemberExited",t," at components/chat/multiemedia/index.nvue:363")},n.emedia.mgr.onStreamControl=function(t){e("log","onStreamControl",t," at components/chat/multiemedia/index.nvue:367")},n.emedia.mgr.onStreamControl.onSoundChanage=function(t,n,i,o){e("log","onSoundChanage"," at components/chat/multiemedia/index.nvue:371")},n.emedia.mgr.onReconnect=function(e,n){i=[],t.setData({subUrls:[],showInvite:!0,devicePosition:"front",muted:!1,playVideoMuted:!1,micphoneIcon:"micphone_white",micphoneColor:"#fff",videoIcon:"video_white",beautyIcon:"beauty",videoColor:"#fff",beauty:9,beautyColor:"#fff",enableCamera:!0})},n.emedia.mgr.onMemberJoined=function(i){e("log","++++++++++ member",i," at components/chat/multiemedia/index.nvue:403");var o=n.WebIM.conn.context.jid,r=o.appKey+"_"+o.name+"@"+o.domain;if(i.name==r){var s=n.emedia.util.getRtcId();n.emedia.mgr.pubStream(s).then((function(e){t.setData({pubUrl:e.data.rtmp})}));var a=t.enableCamera;e("warn","begin enable camera",t.enableCamera," at components/chat/multiemedia/index.nvue:417"),t.setData({enableCamera:!1,pubUrl:t.url+"record_type=audio"||!1},(function(){a&&t.setData({enableCamera:a})}))}},n.emedia.mgr.onStreamAdded=function(o){e("log","%c onAddStream","color: green",o," at components/chat/multiemedia/index.nvue:448");var r=o.id;i.length>8||n.emedia.mgr.subStream(r).then((function(n){e("log","%c \u8ba2\u9605\u6d41\u6210\u529f","color:green",n," at components/chat/multiemedia/index.nvue:455");var s={streamId:r,subUrl:n.data.rtmp,memName:o.memName.split("_")[1].split("@")[0]};i.push(s),e("log","%c subUrls 11 ....","background:yellow"," at components/chat/multiemedia/index.nvue:464"),e("log",i," at components/chat/multiemedia/index.nvue:465"),t.setData({subUrls:i,showInvite:!1})}))},n.emedia.mgr.onStreamRemoved=function(n){e("log","%c onRemoveStream","color: red",n," at components/chat/multiemedia/index.nvue:476"),i=i.filter((function(t){if(t.streamId!=n.id)return t;e("log","%c ------","backgroukd:yellow"," at components/chat/multiemedia/index.nvue:481"),e("log",t," at components/chat/multiemedia/index.nvue:482")})),o[n.id]=!1,t.setData({subUrls:i}),e("log","subUrls",i," at components/chat/multiemedia/index.nvue:497")},n.emedia.mgr.onConfrAttrsUpdated=function(t){e("log","onConfrAttrsUpdated: ",t," at components/chat/multiemedia/index.nvue:500")}}};t.default=i}).call(this,n("0de9")["default"],n("fe07")["default"])},dbff:function(e,t,n){"use strict";n.r(t);var i=n("e169"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},dcf2:function(e,t,n){"use strict";n.r(t);var i=n("e1c1"),o=n("c0ff");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},deec:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o,r=n("0c53")["default"],s=n("25e4"),a=!0,c={data:function(){return{name:"",psd:"",grant_type:"password",psdFocus:"",nameFocus:"",showPassword:!1,type:"text"}},components:{},props:{},onLoad:function(){getApp().globalData;s.on("em.error.passwordErr",(function(){uni.showToast({title:"\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef",icon:"none"})}))},methods:{bindUsername:function(e){this.setData({name:e.detail.value})},bindPassword:function(e){this.setData({psd:e.detail.value})},onFocusPsd:function(){this.setData({psdFocus:"psdFocus"})},onBlurPsd:function(){this.setData({psdFocus:""})},onFocusName:function(){this.setData({nameFocus:"nameFocus"})},onBlurName:function(){this.setData({nameFocus:""})},login:function(){a=!a,i||""!=this.name?i||""!=this.psd?(uni.setStorage({key:"myUsername",data:i||this.name.toLowerCase()}),e("log",111,{apiUrl:r.config.apiURL,user:i||this.name.toLowerCase(),pwd:o||this.psd,grant_type:this.grant_type,appKey:r.config.appkey}," at pages/login/login.vue:102"),getApp().globalData.conn.open({apiUrl:r.config.apiURL,user:i||this.name.toLowerCase(),pwd:o||this.psd,grant_type:this.grant_type,appKey:r.config.appkey})):uni.showToast({title:"\u8bf7\u8f93\u5165\u5bc6\u7801\uff01",icon:"none"}):uni.showToast({title:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\uff01",icon:"none"})}}};t.default=c}).call(this,n("0de9")["default"])},df55:function(e,t,n){"use strict";n.r(t);var i=n("ac83"),o=n("0e6b");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},e0f1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=o(n("0b99"));function o(e){return e&&e.__esModule?e:{default:e}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rpx";return e=String(e),i.default.number(e)?"".concat(e).concat(t):e}},e169:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("3722")),o=r(n("723d"));function r(e){return e&&e.__esModule?e:{default:e}}var s=n("25e4"),a=n("0c53")["default"],c={data:function(){return{search_btn:!0,search_chats:!1,show_mask:!1,yourname:"",unReadSpotNum:0,unReadNoticeNum:0,messageNum:0,unReadTotalNotNum:0,arr:[],show_clear:!1,member:"",isIPX:!1,gotop:!1,input_code:"",groupName:{},winSize:{},popButton:["\u5220\u9664\u8be5\u804a\u5929"],showPop:!1,popStyle:"",currentVal:""}},components:{swipeDelete:i.default,longPressModal:o.default},props:{},onLoad:function(){this.getWindowSize();var e=this;s.on("em.subscribe",(function(){e.getChatList(),e.setData({messageNum:getApp().globalData.saveFriendList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length})})),s.on("em.invite.deleteGroup",(function(){e.listGroups(),e.getRoster(),e.getChatList(),e.setData({messageNum:getApp().globalData.saveFriendList.length})})),s.on("em.unreadspot",(function(t){e.getChatList(),e.setData({unReadSpotNum:getApp().globalData.unReadMessageNum>99?"99+":getApp().globalData.unReadMessageNum})})),s.on("em.invite.joingroup",(function(){e.setData({unReadNoticeNum:getApp().globalData.saveGroupInvitedList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length})})),s.on("em.contacts.remove",(function(){e.getChatList(),e.getRoster()})),this.getRoster()},onShow:function(){uni.hideHomeButton(),this.getChatList(),this.setData({unReadSpotNum:getApp().globalData.unReadMessageNum>99?"99+":getApp().globalData.unReadMessageNum,messageNum:getApp().globalData.saveFriendList.length,unReadNoticeNum:getApp().globalData.saveGroupInvitedList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length}),getApp().globalData.isIPX&&this.setData({isIPX:!0})},methods:{listGroups:function(){var t=this;return a.conn.getGroup({limit:50,success:function(e){var n={},i=e.data||[];i.forEach((function(e){n[e.groupid]=e.groupname})),t.setData({groupName:n}),uni.setStorage({key:"listGroup",data:e.data}),t.getChatList()},error:function(t){e("log",t," at pages/chat/chat.vue:338")}})},getRoster:function(){var t=this,n={success:function(e){for(var n=[],i=0;i<e.length;i++)"both"==e[i].subscription&&n.push(e[i]);uni.setStorage({key:"member",data:n}),t.setData({member:n}),t.listGroups(),s.fire("em.main.ready"),t.setData({arr:t.getChatList(),unReadSpotNum:getApp().globalData.unReadMessageNum>99?"99+":getApp().globalData.unReadMessageNum})},error:function(t){e("log",t," at pages/chat/chat.vue:372")}};a.conn.getRoster(n)},getChatList:function(){var e=uni.getStorageSync("myUsername"),t=this;function n(n,i){for(var o,r=[],s=i.length;s--;){var a=n.indexOf(i[s].slice(9));if(a>-1){var c=uni.getStorageSync(n[a])||[];if(n.includes(),c.length){o=c[c.length-1],o.unReadCount=c.length,o.unReadCount>99&&(o.unReadCount="99+");var u=o.time.split(" ")[0].split("-"),d=o.time.split(" ")[1].split(":"),l=u[2]<10?"0"+u[2]:u[2];o.dateTimeNum="".concat(u[1]).concat(l).concat(d[0]).concat(d[1]).concat(d[2]),o.time="".concat(u[1],"\u6708").concat(u[2],"\u65e5 ").concat(d[0],":").concat(d[1]),n.splice(a,1)}else{var f=uni.getStorageSync(i[s]);if(f.length){o=f[f.length-1];var p=o.time.split(" ")[0].split("-"),h=o.time.split(" ")[1].split(":"),m=p[2]<10?"0"+p[2]:p[2];o.dateTimeNum="".concat(p[1]).concat(m).concat(h[0]).concat(h[1]).concat(h[2]),o.time="".concat(p[1],"\u6708").concat(p[2],"\u65e5 ").concat(h[0],":").concat(h[1])}}}else{var g=uni.getStorageSync(i[s]);if(g.length){o=g[g.length-1];var _=o.time.split(" ")[0].split("-"),v=o.time.split(" ")[1].split(":"),y=_[2]<10?"0"+_[2]:_[2];o.dateTimeNum="".concat(_[1]).concat(y).concat(v[0]).concat(v[1]).concat(v[2]),o.time="".concat(_[1],"\u6708").concat(_[2],"\u65e5 ").concat(v[0],":").concat(v[1])}}!o||"groupchat"!=o.chatType&&"chatRoom"!=o.chatType||(o.groupName=t.groupName[o.info.to]),o&&o.username!=e&&r.push(o)}for(var b=n.length;b--;){var w=uni.getStorageSync(n[b])||[];if(w.length){o=w[w.length-1],o.unReadCount=w.length,o.unReadCount>99&&(o.unReadCount="99+");var S=o.time.split(" ")[0].split("-"),I=o.time.split(" ")[1].split(":"),C=S[2]<10?"0"+S[2]:S[2];o.dateTimeNum="".concat(S[1]).concat(C).concat(I[0]).concat(I[1]).concat(I[2]),o.time="".concat(S[1],"\u6708").concat(S[2],"\u65e5 ").concat(I[0],":").concat(I[1]),"groupchat"!=o.chatType&&"chatRoom"!=o.chatType||(o.groupName=t.groupName[o.info.to]),o.username!=e&&r.push(o)}}r.sort((function(e,t){return t.dateTimeNum-e.dateTimeNum})),this.setData({arr:r})}uni.getStorageInfo({success:function(i){var o=i.keys,r=[],s=[],a=e.length;o.forEach((function(t){t.slice(-a)==e&&-1==t.indexOf("rendered_")?r.push(t):t.slice(-a)==e&&t.indexOf("rendered_")>-1?s.push(t):"INFORM"===t&&r.push(t)})),n.call(t,r,s)}})},openSearch:function(){this.setData({search_btn:!1,search_chats:!0,gotop:!0})},onSearch:function(e){var t=e.detail.value,n=uni.getStorageSync("myUsername"),i=this,o=[],r=[];uni.getStorageInfo({success:function(e){var s=e.keys,a=[],c=n.length;s.forEach((function(e){e.slice(-c)==n&&a.push(e)})),a.forEach((function(e,n){-1!=e.indexOf(t)&&o.push(e)}));var u="";o.forEach((function(e,t){var n=uni.getStorageSync(e)||[];if(n.length){u=n[n.length-1];var i=u.time.split(" ")[0].split("-"),o=u.time.split(" ")[1].split(":"),s=i[2]<10?"0"+i[2]:i[2];u.dateTimeNum="".concat(i[1]).concat(s).concat(o[0]).concat(o[1]).concat(o[2]),u.time="".concat(i[1],"\u6708").concat(i[2],"\u65e5 ").concat(o[0],":").concat(o[1]),r.push(u)}})),i.setData({arr:r})}})},cancel:function(){this.getChatList(),this.setData({search_btn:!0,search_chats:!1,unReadSpotNum:getApp().globalData.unReadMessageNum>99?"99+":getApp().globalData.unReadMessageNum,gotop:!1})},clearInput:function(){this.setData({input_code:"",show_clear:!1})},onInput:function(e){var t=e.detail.value;t?this.setData({show_clear:!0}):this.setData({show_clear:!1})},tab_contacts:function(){uni.redirectTo({url:"../main/main?myName="+uni.getStorageSync("myUsername")})},close_mask:function(){this.setData({search_btn:!0,search_chats:!1,show_mask:!1})},tab_setting:function(){uni.redirectTo({url:"../setting/setting"})},tab_notification:function(){uni.redirectTo({url:"../notification/notification"})},into_chatRoom:function(e){var t=e.currentTarget.dataset.item;"groupchat"==t.chatType||"chatRoom"==t.chatType||t.groupName?this.into_groupChatRoom(t):this.into_singleChatRoom(t)},into_singleChatRoom:function(e){var t=uni.getStorageSync("myUsername"),n={myName:t,your:e.username};uni.navigateTo({url:"../chatroom/chatroom?username="+JSON.stringify(n)})},into_groupChatRoom:function(e){var t=uni.getStorageSync("myUsername"),n={myName:t,your:e.groupName,groupId:e.info.to};uni.navigateTo({url:"../groupChatRoom/groupChatRoom?username="+JSON.stringify(n)})},into_inform:function(){uni.redirectTo({url:"../notification/notification"})},removeAndRefresh:function(e){var t,n=e.currentTarget.dataset.item.info.from,i=getApp().globalData.saveFriendList;i.length>0&&(i.forEach((function(e,i){e.from==n&&(t=i)})),getApp().globalData.saveFriendList.splice(t,1)),uni.removeStorageSync("INFORM")},del_chat:function(t){var n=t.currentTarget.dataset.item,i={},o=this;i="groupchat"==n.chatType||"chatRoom"==n.chatType?{your:n.info.to}:"INFORM"===n.chatType?{your:"INFORM"}:{your:n.username};var r=uni.getStorageSync("myUsername");getCurrentPages();uni.showModal({title:"\u786e\u8ba4\u5220\u9664\uff1f",confirmText:"\u5220\u9664",success:function(e){e.confirm&&(uni.removeStorageSync(i.your+r),uni.removeStorageSync("rendered_"+i.your+r),"INFORM"===i.your&&o.removeAndRefresh(t),s.fire("em.chat.session.remove"),o.getChatList())},fail:function(t){e("log","\u5220\u9664\u5217\u8868",t," at pages/chat/chat.vue:747")}})},longpress:function(e){var t=this;this.currentVal=e;var n=[e.touches[0],"",e.currentTarget.dataset.index],i=n[0],o=n[1];n[2];o=i.clientY>this.winSize.height/2?"bottom:".concat(this.winSize.height-i.clientY,"px;"):"top:".concat(i.clientY,"px;"),i.clientX>this.winSize.witdh/2?o+="right:".concat(this.winSize.witdh-i.clientX,"px"):o+="left:".concat(i.clientX,"px"),this.popStyle=o,this.showShade=!0,this.$nextTick((function(){setTimeout((function(){t.showPop=!0}),10)}))},getWindowSize:function(){var e=this;uni.getSystemInfo({success:function(t){e.winSize={witdh:t.windowWidth,height:t.windowHeight}}})},hidePop:function(){this.showPop=!1},pickerMenuChange:function(){e("log","\u5f53\u524d\u9009\u4e2d>>",this.currentVal," at pages/chat/chat.vue:792"),this.del_chat(this.currentVal)}}};t.default=c}).call(this,n("0de9")["default"])},e1c1:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));try{i={chat:n("735c").default}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. \u6392\u67e5\u7ec4\u4ef6\u540d\u79f0\u62fc\u5199\u662f\u5426\u6b63\u786e"),console.error("2. \u6392\u67e5\u7ec4\u4ef6\u662f\u5426\u7b26\u5408 easycom \u89c4\u8303\uff0c\u6587\u6863\uff1ahttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. \u82e5\u7ec4\u4ef6\u4e0d\u7b26\u5408 easycom \u89c4\u8303\uff0c\u9700\u624b\u52a8\u5f15\u5165\uff0c\u5e76\u5728 components \u4e2d\u6ce8\u518c\u8be5\u7ec4\u4ef6")}var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("chat",{ref:"chat",attrs:{id:"chat",username:e.username,chatType:"singleChat",_i:0},on:{onClickInviteMsg:e.onClickMsg}})},r=[]},e25e:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("01d4"),r=n("4972"),s=r.RecordStatus,a=r.RecordDesc,c=n("25e4"),u=n("92be"),d=!1,l=null,f=[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],p={data:function(){return{changedTouches:null,recordStatus:s.HIDE,RecordStatus:s,RecordDesc:a,radomheight:f,recorderManager:uni.getRecorderManager(),recordClicked:!1,isLongPress:!1,recordTime:0}},props:{username:{type:Object,default:function(){return{}}},chatType:{type:String,default:o.chatType.SINGLE_CHAT}},created:function(){},beforeMount:function(){},moved:function(){},destroyed:function(){clearInterval(l),this.recordTime=0},mounted:function(){},methods:{toggleWithoutAction:function(e){},toggleRecordModal:function(){this.recordStatus=this.recordStatus==s.HIDE?s.SHOW:s.HIDE,this.radomheight=f},handleRecordingMove:function(e){var t=e.touches[0],n=this.changedTouches;n&&(this.recordStatus==s.SWIPE&&n.pageY-t.pageY<20&&(this.recordStatus=s.HOLD),this.recordStatus==s.HOLD&&n.pageY-t.pageY>20&&(this.recordStatus=s.SWIPE))},handleRecording:function(t){if(e("log","\u5f00\u59cb\u70b9\u51fb",uni.getSystemInfoSync()," at components/chat/inputbar/suit/audio/audio.vue:113"),"alipay"!==uni.getSystemInfoSync().app){var n=this;n.recordClicked=!0,setTimeout((function(){1==n.recordClicked&&i()}),350)}else uni.showModal({content:"\u652f\u4ed8\u5b9d\u5c0f\u7a0b\u5e8f\u4e0d\u652f\u6301\u8bed\u97f3\u6d88\u606f\uff0c\u8bf7\u67e5\u770b\u652f\u4ed8\u5b9d\u76f8\u5173api\u4e86\u89e3\u8be6\u60c5"});function i(){return uni.getSetting?void uni.getSetting({success:function(e){clearInterval(l),n.recordTime=0;var t=e.authSetting["scope.record"];0==t?uni.openSetting({success:function(e){var t=e.authSetting["scope.record"];1==t?uni.showToast({title:"\u6388\u6743\u6210\u529f",icon:"success"}):uni.showToast({title:"\u8bf7\u6388\u6743\u5f55\u97f3",icon:"none"}),n.isLongPress=!1}}):1==t?o():uni.authorize({scope:"scope.record",success:function(){uni.showToast({title:"\u6388\u6743\u6210\u529f",icon:"success"})}})},fail:function(){uni.showToast({title:"\u9274\u6743\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",icon:"none"})}}):void o()}function o(){clearInterval(l),n.recordTime=0,n.changedTouches=t.touches[0],n.recordStatus=s.HOLD,d=!0,n.myradom();var e=n.recorderManager||uni.getRecorderManager();e.onStart((function(){l=setInterval((function(){n.recordTime++}),1e3)})),e.start({format:"mp3"}),setTimeout((function(){n.handleRecordingCancel(),d=!1}),1e5)}},handleRecordingCancel:function(){var t=this;d=!1;var n=this.recorderManager;this.recordStatus==s.SWIPE?this.recordStatus=s.RELEASE:(this.recordStatus=s.HIDE,this.recordClicked=!1),n.onStop((function(n){clearInterval(l);var i=1e3*t.recordTime;if(t.recordStatus==s.RELEASE)return e("log","user canceled"," at components/chat/inputbar/suit/audio/audio.vue:232"),void(t.recordStatus=s.HIDE);i<=1e3?uni.showToast({title:"\u5f55\u97f3\u65f6\u95f4\u592a\u77ed",icon:"none"}):t.uploadRecord(n.tempFilePath,i),clearInterval(l),t.recordStatus=s.HIDE,t.recordTime=0})),n.stop()},isGroupChat:function(){return this.chatType==o.chatType.CHAT_ROOM},getSendToParam:function(){return this.isGroupChat()?this.username.groupId:this.username.your},uploadRecord:function(e,t){var n=i.config.appkey.split("#"),r=this,s=i.conn.context.accessToken;uni.uploadFile({url:"https://a1.easemob.com/"+n[0]+"/"+n[1]+"/chatfiles",filePath:e,fileType:"audio",name:"file",header:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+s},success:function(n){var a=i.conn.getUniqueId(),u=new i.message(o.AUDIO,a),d=JSON.parse(n.data);u.set({apiUrl:i.config.apiURL,accessToken:s,body:{type:o.AUDIO,url:d.uri+"/"+d.entities[0].uuid,filetype:"",filename:e,accessToken:s,length:Math.ceil(t/1e3)},from:r.username.myName,to:r.getSendToParam(),roomType:!1,chatType:r.chatType,success:function(e){c.fire("em.chat.sendSuccess",a)}}),r.isGroupChat()&&u.setGroup("groupchat"),u.body.length=Math.ceil(t/1e3),i.conn.send(u.body);var l={msg:u,type:o.AUDIO};r.saveSendMsg(l)}})},saveSendMsg:function(e){u.saveMsg(e.msg,e.type)},myradom:function(){for(var e=this,t=e.radomheight,n=0;n<e.radomheight.length;n++)t[n]=100*Math.random().toFixed(2)+10;e.radomheight=t,d&&setTimeout((function(){e.myradom()}),500)}}};t.default=p}).call(this,n("0de9")["default"])},e27d:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o={data:function(){return{friend_name:"",search_btn:!0,search_chats:!1,show_clear:!1,isdisable:!1,input_code:""}},components:{},props:{},onLoad:function(){getApp().globalData},methods:{openSearch:function(){this.setData({search_btn:!1,search_chats:!0})},onInput:function(e){var t=e.detail.value;t?this.setData({show_clear:!0,friend_name:t,isdisable:!1}):this.setData({show_clear:!1})},clearInput:function(){this.setData({input_code:"",show_clear:!1})},cancel:function(){this.setData({search_btn:!0,search_chats:!1,show_clear:!1})},add_friend:function(){var t=this,n=uni.getStorageSync("myUsername");if(""!=t.friend_name&&t.friend_name.toLowerCase()!=n.toLowerCase()){i.conn.subscribe({to:t.friend_name,message:n+"\u8bf7\u6c42\u6dfb\u52a0\u597d\u53cb"});var o={success:function(n){e("log","success"," at pages/add_new/add_new.vue:128");for(var i=[],o=0;o<n.length;o++)"both"==n[o].subscription&&i.push(n[o]);t.isExistFriend(t.friend_name,i)?uni.showToast({title:"\u5df2\u7ecf\u662f\u4f60\u7684\u597d\u53cb"}):uni.showToast({title:"\u5df2\u53d1\u51fa\u597d\u53cb\u7533\u8bf7"}),t.setData({isdisable:!0})}};i.conn.getRoster(o)}else uni.showToast({title:"\u6dfb\u52a0\u5931\u8d25"})},isExistFriend:function(e,t){for(var n=0;n<t.length;n++)if(e==t[n].name)return!0;return!1}}};t.default=o}).call(this,n("0de9")["default"])},e30e:function(module,exports,__webpack_require__){(function(wx,__f__){var _regeneratorRuntime=__webpack_require__("a34a");function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function asyncGeneratorStep(e,t,n,i,o,r,s){try{var a=e[r](s),c=a.value}catch(u){return void n(u)}a.done?t(c):Promise.resolve(c).then(i,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function s(e){asyncGeneratorStep(r,i,o,s,a,"next",e)}function a(e){asyncGeneratorStep(r,i,o,s,a,"throw",e)}s(void 0)}))}}!function(e,t){module.exports=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(module,exports){var CHARS;function Util(){}CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Math.uuid=function(e,t){var n,i,o=CHARS,r=[];if(t=t||o.length,e)for(n=0;n<e;n++)r[n]=o[0|Math.random()*t];else for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",n=0;n<36;n++)r[n]||(i=0|16*Math.random(),r[n]=o[19==n?3&i|8:i]);return r.join("")},Math.uuidFast=function(){for(var e,t=CHARS,n=new Array(36),i=0,o=0;o<36;o++)8==o||13==o||18==o||23==o?n[o]="-":14==o?n[o]="4":(i<=2&&(i=33554432+16777216*Math.random()|0),e=15&i,i>>=4,n[o]=t[19==o?3&e|8:e]);return n.join("")},Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t});var Logger=function(e){var t=this,n=0,i=1,o=2,r=3,s=4,a=5,c=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function u(n,i){try{!function(n,i){if(!(wx.emedia&&wx.emedia.LOG_LEVEL&&n<wx.emedia.LOG_LEVEL)){var o=[];o.push(n),e&&o.push(e);for(var r=0;r<i.length;r++)o.push(i[r]&&i[r]._toString?i[r]._toString.call(i[r]):i[r]);t._log.apply(t,o)}}(n,i)}catch(e){if(console){if(console.error)return void __f__("error",e," at emediaSDK/emedia_for_miniProgram.js:1");if(console.log)return void __f__("log",e," at emediaSDK/emedia_for_miniProgram.js:1")}throw e}}function d(){if(!(wx.emedia._logContextIndex<0)&&wx.emedia._logContext&&wx.emedia._logContext instanceof Array){var e=wx.emedia._logContextIndex%wx.emedia._logContext.length,t=wx.emedia._logContext[e];t&&t instanceof Array||(t=wx.emedia._logContext[e]=[]);var n=[];n.push(wx.emedia._logContextIndex);var i,o=new Date;"function"==typeof o.toLocaleString?n.push(o.toLocaleString()):o.toJSON?n.push(o.toJSON()):o.toISOString?n.push(o.toISOString()):n.push(o+"");for(var r=0;r<arguments.length;r++){var s=arguments[r];"string"!=typeof s&&s?"string"!=typeof s.message?"function"!=typeof s.message?"string"!=typeof s.stack?s.event&&"function"==typeof s.event.toString||s.event&&"function"==typeof s.event.toString?n.push(s.event.toString()):"string"!=typeof s.candidate?"string"!=typeof s.sdp?isPlainObject(s)?n.push(JSON.stringify(s)):n.push(String(s)):n.push(s.sdp):n.push(s.candidate):n.push(s.stack):n.push(s.message()):n.push(s.message):n.push(s)}if(wx.emedia.config.loglastStoreArray&&t.push(i=n.join(" ")),"function"==typeof wx.emedia.config.onSdkLog)try{i||(i=n.join(" ")),wx.emedia.config.onSdkLog(i)}catch(e){__f__("error",e," at emediaSDK/emedia_for_miniProgram.js:1")}}}function l(){try{d.apply(null,arguments)}catch(e){__f__("warn",e," at emediaSDK/emedia_for_miniProgram.js:1")}}this._log=function(){var e=arguments[0];e=arguments[0]=c[e],wx.emedia._logContext&&l.apply(null,arguments),!0===wx.emedia.config.consoleLogger&&(wx.emedia&&wx.emedia.isElectron?console.log.apply(console,arguments):console&&e&&(console[e.toLowerCase()]||console.warn).apply(console,arguments))},this.log=function(){this._log&&u(o,arguments)},this.trace=function(){this._log&&u(n,arguments)},this.debug=function(){this._log&&u(i,arguments)},this.info=function(){this._log&&u(o,arguments)},this.warn=function(){this._log&&u(r,arguments)},this.error=function(){this._log&&u(s,arguments)},this.fatal=function(){this._log&&u(a,arguments)}};Logger.prototype.count=function(){if(wx.emedia._logContext){wx.emedia._logContextIndex++;var e=wx.emedia._logContextIndex%wx.emedia._logContext.length;0===e&&0!==wx.emedia._logContextIndex&&(wx.emedia._logContext.loadlogs=wx.emedia._logContext[e]),wx.emedia._logContext[e]=[]}},Util.prototype.logger=new Logger,Util.prototype.tagLogger=function(e){return new Logger(e)},Util.prototype.parseJSON=function(e){return JSON.parse(e)};var stringifyJSON=Util.prototype.stringifyJSON=function(e){return JSON.stringify(e)},class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),isPlainObject=Util.prototype.isPlainObject=function(e){var t,n;return!(!e||"[object Object]"!==toString.call(e)||"<JSAPI-Auto Javascript Object>"===e.toString()||"[object IFBComJavascriptObject]"===e.toString())&&(!(t=Object.getPrototypeOf(e))||"function"==typeof(n=hasOwn.call(t,"constructor")&&t.constructor)&&fnToString.call(n)===ObjectFunctionString)};Util.prototype.isArray=Array.isArray,Util.prototype.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},Util.prototype.type=function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?class2type[toString.call(e)]||"object":typeof e},Util.prototype.extend=function(){var e,t,n,i,o,r,s=this,a=arguments[0]||{},c=1,u=arguments.length,d=!1;for("boolean"==typeof a&&(d=a,a=arguments[c]||{},c++),"object"==typeof a||s.isFunction(a)||(a={}),c===u&&(a=this,c--);c<u;c++)if(null!=(e=arguments[c]))for(t in e)n=a[t],a!==(i=e[t])&&(d&&i&&(s.isPlainObject(i)||(o=s.isArray(i)))?(o?(o=!1,r=n&&s.isArray(n)?n:[]):r=n&&s.isPlainObject(n)?n:{},a[t]=s.extend(d,r,i)):void 0!==i&&(a[t]=i));return a},Util.prototype.removeAttribute=function(e,t){if(null!=e){var n=e[t];return delete e[t],n}},Util.prototype.prototypeExtend_000=Util.prototype.classExtend=function(){var e,t=this;function n(){for(var e=0;e<arguments.length;e++){var n=arguments[e]||{};t.extend(!0,this,n)}this.__init__&&this.__init__.apply(this,arguments)}for(var i=0;i<arguments.length;i++){var o=arguments[i]||{};"function"==typeof o?e?(o.constructor=e,o.__proto__=e.prototype):e=o:t.extend(!0,n.prototype,o)}return e&&(n.prototype.__proto__=e.prototype),e&&(n.prototype.constructor=e),n.extend||(n.extend=function(e){return t.prototypeExtend(n,e)}),n},Util.prototype.prototypeExtend=Util.prototype.classExtend=function(){var e=this;function t(){for(var t=0;t<arguments.length;t++){var n=arguments[t]||{};e.extend(!0,this,n)}this.__init__&&this.__init__.apply(this,arguments)}for(var n=0;n<arguments.length;n++){var i=arguments[n]||{};"function"==typeof i&&(i=i.prototype),e.extend(!0,t.prototype,i)}return t.extend||(t.extend=function(n){return e.prototypeExtend(t,n)}),t},Util.prototype.hasLocalStorage=function(e){return null!=localStorage.getItem(e)&&"{}"!=localStorage.getItem(e)},Util.prototype.toggleClass=function(e,t){e.hasClass(t)?e.removeClass(t):e.addClass(t)},Util.prototype.setCookie=function(e,t,n){var i=new Date;i.setTime(i.getTime()+60*n*60*1e3),document.cookie=e+"="+escape(t)+";expires="+i.toGMTString()},Util.prototype.getCookie=function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=t?unescape(t[2]):null},Util.prototype.forEach=function(e,t){if(e&&!(this.isArray(e)&&0===e.length||void 0!==e.length&&0===e.length))if(e.length)for(var n=0;n<e.length;n++)t(n,e[n]);else if(e&&!this.isEmptyObject(e)){e=e||{};var i=this.extend(!1,{},e);for(var o in i)t(o,e[o])}},Util.prototype.isInt=function(e){return Number(e)===e&&e%1==0},Util.prototype.isFloat=function(e){return Number(e)===e&&e%1!=0},Util.prototype.list=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);return e},Util.prototype.addEvent=function(e,t,n){if(e.attachEvent)return e.attachEvent("on"+t,n);if(e.addEventListener)return e.addEventListener(t,n,!1);throw"Handler could not be attached"},Util.prototype.removeEvent=function(e,t,n){if(e.detachEvent)return e.detachEvent("on"+t,n);if(e.removeEventListener)return e.removeEventListener(t,n,!1);throw"Handler could not be removed"},Util.prototype.stopEvent=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1},Util.prototype.getDomPageRect=function(e){var t=e.getBoundingClientRect();return{x:t.left+(wx.pageXOffset||wx.document.documentElement.scrollLeft),y:t.top+(wx.pageYOffset||wx.document.documentElement.scrollTop),width:t.width||e.offsetWidth,height:t.height||e.offsetHeight}},Util.prototype.getEventElementXY=function(e,t,n){var i,o,r=(e=e||wx.event).changedTouches?e.changedTouches[0]:e.touches?e.touches[0]:e;null!=r.pageX&&null!=r.pageY?(i=r.pageX,o=r.pageY):null!=r.clientX&&null!=r.clientY&&(i=r.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=r.clientY+document.body.scrollTop+document.documentElement.scrollTop);var s=this.getDomPageRect(t),a=i-s.x,c=o-s.y;return(0===n||null==n)&&(n=1),{x:Math.round(Math.max(Math.min(a,s.width-1),0)/n),y:Math.round(Math.max(Math.min(c,s.height-1),0)/n),width:Math.round(s.width/n),height:Math.round(s.height/n),realX:a,realY:c}},Util.prototype.targetDOM="object"==typeof HTMLElement?function(e){return e instanceof HTMLElement}:function(e){return e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName},Util.prototype.cloneCSS=function(e,t){var n=wx.getComputedStyle&&wx.getComputedStyle(e,null)||e.currentStyle;for(var i in n){var o=n[i];/^[a-z]/i.test(i)&&[null,"",void 0].indexOf(o)<0&&(t.style[i]=o)}},Util.prototype.canYield=function(){try{return eval("!!Function('yield true;')().next()")}catch(e){return!1}}(),Util.prototype.getRtcId=function(){var e="abcdefghijklmnopqrstuvwxyz".split(""),t=[];this.num||(this.num=0),this.num++;for(var n=0;n<3;n++)t[n]=e[parseInt(Math.random()*e.length)];return"wx-"+this.num.toString()+"-"+t.join("")},Util.prototype.fetch=function(e,t){return new Promise((function(n,i){wx.request({url:e||"",method:t.method||"GET",data:t.data||{},header:{"content-type":"application/json"},success:function(e){n(e)},fail:function(e){i(e)}})}))},module.exports=new Util},function(e,t,n){var i=n(0),o=(i.logger,i.prototypeExtend({msg:"",__init__:function(){this.day=new Date},execTime:function(){var e=this.day.getHours();e<10&&(e="0"+e);var t=this.day.getMinutes();t<10&&(t="0"+t);var n=this.day.getSeconds();return n<10&&(n="0"+n),e+":"+t+":"+n}})),r=o.extend({_webrtcDesc:function(){return this.webrtc,this.webrtc.getRtcId()}});e.exports={Exception:o.extend(),NetworkChanaged:o.extend({message:function(){return this.execTime()+" : Network chanage ("+this.preIp+" -> "+this.nowIp+")."}}),WSClose:o.extend({message:function(){var e=this.execTime()+" WSClose: Websocket close ("+(this.retry||0)+").";return this.online||(e+=" offline."),this.event&&(e+=" wscode: "+this.event.code),this.cause&&(e+=" cause: "+this.cause.message),this.url&&(e+=" url: "+this.url),e+=" retry: "+(this.retry||0),this.session&&this.session.getSessionId()&&(e=e+", sess = "+this.session.getSessionId()),e}}),WSError:o.extend({message:function(){var e=this.execTime()+" WSError: Websocket error. ready state:"+(this.event.srcElement&&this.event.srcElement.readyState||this.event.currentTarget.readyState)+". online = "+this.online;return this.session&&this.session.getSessionId()&&(e=e+", sess = "+this.session.getSessionId()),this.url&&(e+=" url: "+this.url),e}}),WSConnected:o.extend({message:function(){var e=this.execTime()+" WSConnected: Websocket success. ready state:"+(this.event.srcElement&&this.event.srcElement.readyState||this.event.currentTarget.readyState);return this.session&&this.session.getSessionId()&&(e=e+", sess = "+this.session.getSessionId()),e}}),ICEChanage:r.extend({message:function(){return this.execTime()+" ICEChanage: "+this._webrtcDesc()+" state: "+this.state}}),AddIceCandError:r.extend({message:function(){return this.execTime()+" AddIceCandError: "+this._webrtcDesc()+", add cand error"}}),ICEConnectFail:r.extend({message:function(){return this.execTime()+" ICEConnectFail: "+this._webrtcDesc()+" failed"}}),ICEConnected:r.extend({message:function(){return this.execTime()+" ICEConnected: "+this._webrtcDesc()+" connected"}}),ICEDisconnected:r.extend({message:function(){return this.execTime()+" ICEDisconnected: "+this._webrtcDesc()+" disconnected"}}),ICEClosed:r.extend({message:function(){return this.execTime()+" ICEClosed: "+this._webrtcDesc()+" closed"}}),ICERemoteMediaStream:r.extend({message:function(){return this.execTime()+" ICERemoteMediaStream: "+this._webrtcDesc()+" got remote stream"}}),StreamState:o.extend({message:function(){return this.execTime()+" StreamState:  stream "+this.stream.id+" state: "+this.state+" "+this.msg},iceFail:function(){this.state=1,this.msg="network anomaly. media lost"}}),OpenMediaError:o.extend({message:function(){return this.execTime()+" OpenMediaError:  open media error. caused by "+(this.event.name?this.event.name:this.event.message?this.event.message:this.event.toString())}}),Hangup:o.extend({message:function(){return this.self?"hangup id = "+(this.self.id||"--")+" reason\uff1a"+(this.reason||0):this.execTime()+" Hangup: "+(this.parnter&&(this.parnter.name||this.parnter.id||" ")||"")+" hangup, reason\uff1a"+(this.reason||0)}}),ServerRefuseEnter:o.extend({message:function(){return this.execTime()+" ServerRefuseEnter: server refuse, cause\uff1a"+this.failed+", msg:"+(this.msg||"")}}),RspFail:o.extend({__init__:function(){this.day=new Date,this.failed=this.response.result,this.msg=this.response.msg||this.response.message||"--"},message:function(){return this.execTime()+" RspFail: "+this.request.tsxId+", "+(this.response.sessId||"--")+" op: "+this.request.op+", cause: "+this.failed+" "+this.msg}}),RecvResponse:o.extend({__init__:function(){this.day=new Date,this.failed=this.response.result,this.msg=this.response.msg},message:function(){return this.request?this.execTime()+" RecvResponse: "+(this.request&&this.request.tsxId)+", "+(this.response.sessId||"--")+" op: "+(this.request&&this.request.op)+", cause: "+this.failed+" "+this.msg:this.execTime()+" RecvMessage: "+(this.response&&this.response.tsxId)+", "+(this.response.sessId||"--")+" op: "+(this.response&&this.response.op)+" "+this.msg}}),EnterFail:o.extend({message:function(){return this.execTime()+" EnterFail: enter fail\uff1a"+(this.cause?this.cause.message():"unkown")}}),EnterSuccess:o.extend({message:function(){return this.execTime()+" EnterSuccess: enter success "+(this.ip?", ip = "+this.ip:"")}}),PushSuccess:o.extend({message:function(){return this.execTime()+" PushSuccess: push success, streamId = "+this.stream.id+", "+this.stream.optimalVideoCodecs+", webrtc = "+this.stream.rtcId}}),PushFail:o.extend({message:function(){return this.execTime()+" PushFail: push fail, streamId = "+this.stream.id+", "+this.stream.optimalVideoCodecs+", webrtc = "+this.stream.rtcId+" cause\uff1a"+(this.cause?this.cause.message?this.cause.message():this.cause:"unkown")}}),RemoteControlFail:o.extend({message:function(){return this.execTime()+" RemoteControlFail: "+(this.type||"remote control")+" fail, "+(this.stream?this.stream.id:"")+" failed = "+this.failed+" cause\uff1a"+(this.cause?this.cause.message?this.cause.message():this.cause:"unkown")}}),SubSuccess:o.extend({message:function(){return this.execTime()+" SubSuccess: sub success, streamId = "+this.stream.id+", "+this.stream.vcodes+", webrtc = "+this.stream.rtcId}}),SubFail:o.extend({message:function(){return this.execTime()+" SubFail: sub fail, streamId = "+this.stream.id+", "+this.stream.vcodes+", webrtc = "+this.stream.rtcId+" cause\uff1a"+(this.cause?this.cause.message?this.cause.message():this.cause:"unkown")}}),SubFailNotSupportVCodes:o.extend({message:function(){return this.execTime()+" SubFailNotSupportVCodes: sub fail, streamId = "+this.stream.id+" cause\uff1a"+(this.cause?this.cause.message?this.cause.message():this.cause:"unkown")}}),SubFailSafariNotAllowSubBeforePub:o.extend({message:function(){return this.execTime()+" SubFailSafariNotAllowSubBeforePub: sub fail, streamId = "+this.stream.id+" cause\uff1aSafari without access to capture devices, WebKit only exposes Server Reflexive and TURN ICE candidates, which expose IPs that could already be gathered by websites."}}),SwitchVCodes:o.extend({message:function(){return this.execTime()+" SwitchVCodes: pub streamId = "+this.stream.id}}),CurrentCalling:o.extend({message:function(){return this.execTime()+" CurrentCalling: warn! current calling..."}}),OpenDesktopMedia:o.extend({message:function(){return this.execTime()+" OpenDesktopMedia: shared desktop, desktopStreamId = "+desktopStreamId}}),OpenDesktopMediaAccessDenied:o.extend({message:function(){return this.execTime()+" OpenDesktopMediaAccessDenied: shared desktop not allow"}}),ShareDesktopExtensionNotFound:o.extend({message:function(){return this.execTime()+" ShareDesktopExtensionNotFound: shared desktop plugin required"}}),OtherDeviceAnswer:o.extend({message:function(){return this.execTime()+" other device answer, webrtc = "+this.rtcId}}),AudioMixerStreamNotAllowSub:o.extend({message:function(){return this.execTime()+" audio mixer stream not allow sub, webrtc = "+this.rtcId+", streamId = "+this.stream.id}}),AudioMixerStreamNotAllowOnlySubVideo:o.extend({message:function(){return this.execTime()+" audio mixer stream not allow only sub video, webrtc = "+this.rtcId+", streamId = "+this.stream.id}}),AudioMixerStreamRepeatPublish:o.extend({message:function(){return this.execTime()+" audio mixer stream repeat publish"}})}},function(e,t,n){var i=n(0),o=i.tagLogger("mgr");wx.emedia=wx.emedia||{};var r=wx.emedia.config.apiURL||"https://a1.easemob.com",s="/easemob/rtc/req/ticket",a="/easemob/rtc/req/ticket",c="/easemob/rtc/chanage/roles",u="/easemob/rtc/disband/conference",d="/easemob/rtc/kick/member",l="/easemob/rtc/select/confr",f=function(){};function p(){this._confrs={},this._services={},this._events={},this._videos={},this.cattrs=[],this.setHost=function(e){r=e},this.__current_confrId="",this._confr=function(e){return e||(e=this.__current_confrId),this._confrs[e]||{}},this.exitConference=function(e){var t=this._services[e]||this._services[this._confrs.currentConf];if(t){this.__current_confrId="",t.exit();var n=this._confr(e);(n.members||[]).forEach((function(e){e.plugin&&e.plugin.stop()})),this._confrs[e]&&delete this._confrs[e],n=null}else o.warn("when exit. not found service.",e)},this.joinConferenceWithTicket=function(e,t,n){var i=this;return new Promise((function(o,r){var s=i._services[e]=new wx.emedia.XService;s.setup(t,n),s.join((function(t){i.__current_confrId=e,o(t)}),(function(e){r(e)}))}))},this.joinConference=function(e,t,n){var i=this;return this.getConferenceTkt(e,t).then((function(t){i._confrs[t.data.confrId]||(i._confrs[t.data.confrId]=t.data);var o=t.data.ticket||"";return i.joinConferenceWithTicket(e,o,n)}))},this._onMemberJoined=function(e){if(__f__("log","_onMemberJoined ^^^^^^^^^",e," at emediaSDK/emedia_for_miniProgram.js:1"),e.sessId){var t=e.sessId,n=this._confr();n.sessId=t,n.rtcCfg=e.rtcCfg||"{relayOnly:false}",n.vcodes=e.vcodes}this.onMemberJoined(e)},this.onSoundChanage=f,this.onMediaChanaged=f,this.onMemberJoined=f,this.onMemberExited=f,this.onStreamAdded=f,this.onStreamRemoved=f,this.onRoleChanged=f,this.onConferenceExit=f,this.onConfrAttrsUpdated=f,this._onStreamRemoved=function(e){var t=this.__current_confrId,n=this._confr(t);n.othersInfo.forEach((function(t,i){t.stream.id==e.id&&n.othersInfo.splice(i,1)})),this.onStreamRemoved(e)},this.onSignallingData=function(e){if(__f__("log",(new Date).toLocaleString()+"*** \u670d\u52a1\u7aef\u8fd4\u56de\u4fe1\u4ee4\uff1a***** ",e," at emediaSDK/emedia_for_miniProgram.js:1"),104==e.op||106==e.op){var t=e.rtcId,n=e.confrId||this.__current_confrId;this._confr(n).members.forEach((function(n){n.rtcId==t&&n.plugin.setData(e)}))}}}function h(e){if(e&&0!=Object.keys(e).length)if(e.key){var t=e.key,n=e.val,o=e.success,s=e.error,a=e.type,c=e.confrId;if(c){var u=this._confrs[c].roleToken;if(u){var d={roleToken:u,cattrs:[{key:t,val:n,op:a}],success:o,error:s},l=r+"/easemob/rtc/confr/attrs/update";return e={method:"POST",data:JSON.stringify(d)},i.fetch(l,e)}__f__("warn","roleToken is not have"," at emediaSDK/emedia_for_miniProgram.js:1")}else __f__("warn","please set_confr_attrs after joined"," at emediaSDK/emedia_for_miniProgram.js:1")}else __f__("warn","options.key is not have"," at emediaSDK/emedia_for_miniProgram.js:1");else __f__("warn","options is not have"," at emediaSDK/emedia_for_miniProgram.js:1")}p.prototype.ConfrType={COMMUNICATION:10,COMMUNICATION_MIX:11,LIVE:12,P2P:13,INTERCOMM:14},p.prototype.Role={ADMIN:7,TALKER:3,AUDIENCE:1,HIDING:9},p.prototype._terminalInfo={browser:wx.emedia.browser,browserVersion:wx.emedia.browserVersion,version:wx._emediaVersion||wx.emedia.config.version,userAgent:wx.emedia.config.userAgent},p.prototype.createUrl=function(e,t){return e},p.prototype.createConference=function(e,t,n,o){var a=r+s,c=this,u=wx.WebIM.conn.context.accessToken||"",d="";if("[object Object]"===Object.prototype.toString.call(wx.WebIM.conn.context.jid)){var l=wx.WebIM.conn.context.jid;d=l.appKey+"_"+l.name+"@"+l.domain}else"[object String]"===Object.prototype.toString.call(wx.WebIM.conn.context.jid)&&(d=wx.WebIM.conn.context.jid.split("/")[0]);var f={method:"POST",data:{supportWechatMiniProgram:!0,role:wx.emedia.config.useUniappPlugin?c.Role.ADMIN:c.Role.HIDING,uid:d,token:u,confrType:e||"",password:t||"",terminal:c._terminalInfo,rec:n||"",recMerge:o||""}};return i.fetch(a,f).then((function(e){return e.data.mixed=11===e.data.type||12===e.data.type,e.data.id=e.data.serverConfrId=e.data.confrId,c._confrs[e.data.confrId]=e.data,c.__current_confrId=e.data.confrId,c._confrs.currentConf=e.data.confrId,i.removeAttribute(e.data,"rtcCfg"),e}))},p.prototype.getConferenceTkt=function(e,t){var n=this,o=r+a,s=wx.WebIM.conn.context.accessToken||"",c="";if("[object Object]"===Object.prototype.toString.call(wx.WebIM.conn.context.jid)){var u=wx.WebIM.conn.context.jid;c=u.appKey+"_"+u.name+"@"+u.domain}else"[object String]"===Object.prototype.toString.call(wx.WebIM.conn.context.jid)&&(c=wx.WebIM.conn.context.jid.split("/")[0]);var d=wx.emedia.config.useUniappPlugin,l={method:"POST",data:{uid:c,token:s,confrId:e,password:t||"",role:d?n.Role.ADMIN:n.Role.HIDING}};return i.fetch(o,l).then((function(t){return t.data.confrId=e,n.__current_confrId=e,t}))},p.prototype.subStream=function(e){var t=this._videos.useUrl,n={method:"POST",data:{op:"subS",streamId:e||""}};return i.fetch(t,n)},p.prototype.pubStream=function(e){var t=this._videos.useUrl,n={method:"POST",data:{op:"pubS",rtcId:e||""}};return i.fetch(t,n)},p.prototype.grantRole=function(e,t,n){e=this._confr(e)||{};var o=r+c,s={method:"POST",data:{uids:t,role:n,roleToken:e.roleToken}};return i.fetch(o,s)},p.prototype.destroyConference=function(e){var t=this._confr(e),n=r+u,o={method:"POST",data:{roleToken:t&&t.roleToken}};return i.fetch(n,o)},p.prototype.kickMembersById=function(e,t){var n=this._confr(e),o=r+d,s={method:"POST",data:{uids:t,roleToken:n.roleToken}};return i.fetch(o,s)},p.prototype.getConferenceInfo=function(e,t){var n=wx.WebIM.conn.context.accessToken||"",o="";if("[object Object]"===Object.prototype.toString.call(wx.WebIM.conn.context.jid)){var s=wx.WebIM.conn.context.jid;o=s.appKey+"_"+s.name+"@"+s.domain}else"[object String]"===Object.prototype.toString.call(wx.WebIM.conn.context.jid)&&(o=wx.WebIM.conn.context.jid.split("/")[0]);var a=r+l,c={method:"POST",data:{uid:o,token:n,confrId:e,password:t}};return i.fetch(a,c)},p.prototype.setConferenceAttrs=function(e){e.type="UPDATE",h.call(this,e)},p.prototype.deleteConferenceAttrs=function(e){e.type="DEL",h.call(this,e)},p.prototype.joinRoom=function(){var e=_asyncToGenerator(_regeneratorRuntime.mark((function e(t){var n,o,s,a,c,u,d,l,f,p,h,m,g,_,v,y,b,w,S;return _regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.roomName,o=t.password,s=t.role,a=t.config,c=wx.WebIM.conn.context.accessToken||"",u="","[object Object]"===Object.prototype.toString.call(wx.WebIM.conn.context.jid)?(d=wx.WebIM.conn.context.jid,u=d.appKey+"_"+d.name+"@"+d.domain):"[object String]"===Object.prototype.toString.call(wx.WebIM.conn.context.jid)&&(u=wx.WebIM.conn.context.jid.split("/")[0]),!n){e.next=51;break}if(!u){e.next=48;break}if(!c){e.next=45;break}if(!s){e.next=42;break}return e.prev=7,l=_objectSpread({roomName:n,password:o,memName:u,token:c,supportWechatMiniProgram:!0,useVCodes:["H264","VP8"]},a),e.next=11,function(e){var t=wx.WebIM.conn.context.jid.appKey;if(t){var n=t.split("#")[0],o=t.split("#")[1],s="".concat(r,"/").concat(n,"/").concat(o,"/conferences/room"),a={data:JSON.stringify(e),method:"POST"};return i.fetch(s,a)}__f__("warn","appkey is not defined"," at emediaSDK/emedia_for_miniProgram.js:1")}(l);case 11:return f=e.sent,p=f.data.confrId,e.prev=13,h={uid:u,token:c,confrId:p,password:o,role:s,terminal:this._terminalInfo,rec:a.rec,recMerge:a.recMerge,supportWechatMiniProgram:!0,useVCodes:["H264","VP8"]},e.next=17,function(e){var t=r+"/easemob/rtc/req/ticket?_ct="+(new Date).getTime();e.region&&(t+="&REGION=".concat(e.region)),e.confrId&&(t+="&CONFRID=".concat(e.confrId));var n={method:"POST",data:JSON.stringify(e)};return i.fetch(t,n)}(h);case 17:return m=e.sent,m.mixed=11===m.type||12===m.type,m.id=m.serverConfrId=m.confrId=p,this._confrs[p]=Object.assign(this._confrs[p]||{},m),e.prev=19,g=m.data.ticket,_=a.nickName,v=a.ext,y=f.data,b=y.confrId,w=y.isCreator,e.next=23,this.joinConferenceWithTicket(b,g,_objectSpread({nickName:_},v));case 23:return S={confrId:b},e.abrupt("return",(w&&(S.isCreator=w),S));case 27:return e.prev=27,e.t0=e["catch"](19),e.abrupt("return",/cause: -523|cause:-523/.test(e.t0.errorMessage)?{error:-523,message:"talker count limit"}:{error:-1,message:"joinRoom error",reaseon:e.t0});case 30:e.next=35;break;case 32:return e.prev=32,e.t1=e["catch"](13),e.abrupt("return",e.t1.response?JSON.parse(e.t1.response):{error:-1,message:"joinRoom error",reaseon:e.t1});case 35:e.next=40;break;case 37:return e.prev=37,e.t2=e["catch"](7),e.abrupt("return",e.t2.response?JSON.parse(e.t2.response):{error:-1,message:"joinRoom error",reaseon:e.t2});case 40:e.next=43;break;case 42:__f__("warn","the role is required at joinRoom"," at emediaSDK/emedia_for_miniProgram.js:1");case 43:e.next=46;break;case 45:__f__("warn","the token is required at joinRoom"," at emediaSDK/emedia_for_miniProgram.js:1");case 46:e.next=49;break;case 48:__f__("warn","the memName is required at joinRoom"," at emediaSDK/emedia_for_miniProgram.js:1");case 49:e.next=52;break;case 51:__f__("warn","the roomName is required at joinRoom"," at emediaSDK/emedia_for_miniProgram.js:1");case 52:case"end":return e.stop()}}),e,this,[[7,37],[13,32],[19,27]])})));return function(t){return e.apply(this,arguments)}}(),p.prototype.postMessage=function(e,t,n){if(!t||"object"!=typeof t)throw Error("the data must be an object");if("feature"===t.detail.type){var i=this._services[e]||this._services[this._confrs.currentConf],o=t.detail.data;if(__f__("log",(new Date).toLocaleString()+"--- sdk postMessage -----",o," at emediaSDK/emedia_for_miniProgram.js:1"),i.postMsg(o),102==o.op){e=e||this.__current_confrId;var r=this._confr(e),s=r.members||[];s.push({rtcId:o.rtcId,plugin:n}),r.members=s}}},p.prototype.publish=function(e,t,n){e=e||this.__current_confrId;var i=this._confr(e),o=JSON.parse(i.ticket),r=o.tktId,s={uId:o.memName,tktId:r,sessId:i.sessId,rtcCfg:i.rtcCfg,vcodes:i.vcodes,reopen:n};__f__("log",(new Date).toLocaleString()+" -----sdk \u53d1\u5e03\u6d41 publish start() ------",s," at emediaSDK/emedia_for_miniProgram.js:1"),t.start(s),i.myInfo={pusher:t}},p.prototype.subscribe=function(e,t,n,i){e=e||this.__current_confrId;var o=this._confr(e);__f__("log",(new Date).toLocaleString()+"----- sdk subscribe play() ------",{streamId:t.id,sessId:o.sessId,rtcCfg:o.rtcCfg,uId:t.memName,reopen:i||!1},n," at emediaSDK/emedia_for_miniProgram.js:1"),n.play({streamId:t.id,sessId:o.sessId,rtcCfg:o.rtcCfg,uId:t.memName,reopen:i||!1}),o.othersInfo||(o.othersInfo=[]),o.othersInfo.push({stream:t,player:n})},p.prototype.onReconnect=function(){var e=this;confrId=this.__current_confrId;var t=this._confr(confrId);this.publish(confrId,t.myInfo.pusher,!0),t.othersInfo&&t.othersInfo.forEach((function(t){e.subscribe(confrId,t.stream,t.player,!0)}))},p.prototype.onStateChange=function(e){var t=this;if("object"==typeof e&&"bindstatechange"===e.type&&2004===e.detail.code){var n=e.detail.info,i=n.streamId,o=n.isPusher;confrId=this.__current_confrId;var r=this._confr(confrId);o?this.publish(confrId,r.myInfo.pusher,!0):r.othersInfo&&r.othersInfo.forEach((function(e){e.id===i&&t.subscribe(confrId,e.stream,e.player,!0)}))}},e.exports=new p},function(e,t,n){var i=n(0),o=i.tagLogger("Webrtc"),r={},s={headerSection:null,audioSection:null,videoSection:null,_parseHeaderSection:function(e,t,n){var i=t;return-1===n||(i=-1===t?n:Math.min(t,n)),i>=0?e.slice(0,i):e},_parseAudioSection:function(e,t,n){var i=t;if(i>=0)return e.slice(i,n<i?e.length:n)},_parseVideoSection:function(e,t,n){var i=n;if(i>=0)return e.slice(i,t<i?e.length:t)},spiltSection:function(e){this._preSDP=e;var t=this._preAudioIndex=e.indexOf("m=audio"),n=this._preVideoIndex=e.indexOf("m=video");this.headerSection=this._parseHeaderSection(e,t,n),this.audioSection=this._parseAudioSection(e,t,n),this.videoSection=this._parseVideoSection(e,t,n)},setVideoBitrate:function(e){e&&this.videoSection&&(this.videoSection=this.setBitrate(this.videoSection,e))},setVideoMinBitrate:function(e){this.setAllFmtpBitrate({"x-google-min-bitrate":e})},setVideoMaxBitrate:function(e){this.setAllFmtpBitrate({"x-google-max-bitrate":e})},setVideoStartBitrate:function(e){this.setAllFmtpBitrate({"x-google-start-bitrate":e})},setAllFmtpBitrate:function(e){if(this.videoSection){var t={};Object.keys(e).forEach((function(n){var i=n+"="+e[n],o=new RegExp("(a=fmtp\\:\\d+\\s\\S*;?)("+n+"=\\d+)(;?\\S*)","g");t[n]={field:i,regex:o}})),this.videoSection=this.videoSection.replace(/(a=fmtp\:\d+[^\r\n]+)([\r\n]+)/g,(function(e,n,i){return n.indexOf("apt=")>=0?e:(Object.keys(t).forEach((function(e){var i=t[e],o=i.regex,r=i.field,s=n.replace(o,(function(e,t,n,i){return t+r+i}));s.indexOf(e)<0?(s.endsWith(";")||(s+=";"),n=s+r):n=s})),n+i)}))}},setFmtpBitrate:function(e,t){if(t&&this.videoSection){var n=e+"="+t,i=new RegExp("(a=fmtp\\:\\d+\\s\\S*;?)("+e+"=\\d+)(;?\\S*)","g");this.videoSection=this.videoSection.replace(/(a=fmtp\:\d+[^\r\n]+)([\r\n]+)/g,(function(t,o,r){var s=o.replace(i,(function(e,t,i,o){return t+n+o}));return s.indexOf(e)<0&&(s.endsWith(";")||(s+=";"),s+=n),s+r}))}},setAudioBitrate:function(e){e&&this.audioSection&&(this.audioSection=this.setBitrate(this.audioSection,e))},setBitrate0:function(e,t){return(e=e.replace(/(b=)(?:AS|TIAS)(\:)\d+/g,"$1AS$2"+t)).indexOf("b=AS")<0&&(e=e.replace(/(m=(?:audio|video)[^\r\n]+)([\r\n]+)/g,"$1$2b=AS:"+t+"$2")),e},setBitrate:function(e,t){var n="AS";return wx.emedia.isFirefox&&(t=1e3*(t>>>0),n="TIAS"),(e=e.replace(/(b=)(?:AS|TIAS)(\:)\d+/g,"$1"+n+"$2"+t)).indexOf("b="+n+":")<0&&(e=e.indexOf("c=IN ")<0?e.replace(/(m=(?:audio|video)[^\r\n]+)([\r\n]+)/g,"$1$2b="+n+":"+t+"$2"):e.replace(/c=IN ([^\r\n]+)([\r\n]+)/,"c=IN $1$2b="+n+":"+t+"$2")),e},updateVideoSection:function(e,t){this.videoSection&&(this.videoSection=this.videoSection.replace(e,t))},updateAudioSection:function(e,t){this.audioSection&&(this.audioSection=this.audioSection.replace(e,t))},updateVideoSendonly:function(){this.videoSection&&(this.videoSection=this.videoSection.replace(/sendrecv/g,"sendonly"))},updateVideoRecvonly:function(){this.videoSection&&(this.videoSection=this.videoSection.replace(/sendrecv/g,"recvonly"))},updateAudioSendonly:function(){this.audioSection&&(this.audioSection=this.audioSection.replace(/sendrecv/g,"sendonly"))},updateAudioRecvonly:function(){this.audioSection&&(this.audioSection=this.audioSection.replace(/sendrecv/g,"recvonly"))},updateACodes:function(e){if(e&&this.audioSection){"string"==typeof e&&((n=[]).push(e),e=n);for(var t={},n=this._parseLine(this.audioSection,/a=rtpmap:(\d+) ([A-Za-z0-9]+)\/.*/gi),r=0;r<n.length;r++){var s=n[++r];t[n[++r]]=s}var a=[];for(r=0;r<e.length;r++){var c=t[e[r]];c&&a.push(c)}0==a.length&&(this._webrtc?o.warn("Not found acodes map",e,this._webrtc._rtcId,this._webrtc.__id):o.warn("Not found acodes map",e));var u=this.audioSection.indexOf("\r"),d=this.audioSection.substring(0,u),l=d.split(" ");Array.prototype.push.apply(a,l.slice(3));var f=[],p={};i.forEach(a,(function(e,t){0==f.length?(f.push(t),p[t]=!0):p[t]||(f.push(t),p[t]=!0)})),l.splice(3,l.length-3,f.join(" ")),d=l.join(" "),this._webrtc&&o.warn(d,this._webrtc._rtcId,this._webrtc.__id),this.audioSection=d+this.audioSection.substring(u)}},updateVCodes:function(e){if(e&&this.videoSection){"string"==typeof e&&((n=[]).push(e),e=n);for(var t={},n=this._parseLine(this.videoSection,/a=rtpmap:(\d+) ([A-Za-z0-9]+)\/.*/gi),r=0;r<n.length;r++){var s=n[++r];t[n[++r]]=s}var a=this._parseLine(this.videoSection,/a=fmtp:(\d+) .*profile-level-id=42e01f;?.*/gi);a&&a.length>=2&&(t.H264=a[1]);var c=[];for(r=0;r<e.length;r++){var u=t[e[r]];u&&c.push(u)}0==c.length&&(this._webrtc?o.warn("Not found vcodes map",e,this._webrtc._rtcId,this._webrtc.__id):o.warn("Not found vcodes map",e));var d=this.videoSection.indexOf("\r"),l=this.videoSection.substring(0,d),f=l.split(" ");Array.prototype.push.apply(c,f.slice(3));var p=[],h={};i.forEach(c,(function(e,t){0==p.length?(p.push(t),h[t]=!0):h[t]||(p.push(t),h[t]=!0)})),f.splice(3,f.length-3,p.join(" ")),l=f.join(" "),this._webrtc&&o.warn(l,this._webrtc._rtcId,this._webrtc.__id),this.videoSection=l+this.videoSection.substring(d)}},removeSSRC:function(e){for(var t=[],n=e.split(/a=ssrc:[^\n]+/g),i=0;i<n.length;i++)"\n"!=n[i]&&t.push(n[i]);return t.join("\n")},removeField_msid:function(e){for(var t=[],n=e.split(/a=msid:[^\n]+/g),i=0;i<n.length;i++)"\n"!=n[i]&&t.push(n[i]);for(e=t.join("\n"),t=[],n=e.split(/[\n]+/g),i=0;i<n.length;i++)"\n"!=n[i]&&t.push(n[i]);return t.join("\n")},updateHeaderMsidSemantic:function(e){var t="a=msid-semantic: WMS "+e,n=this.headerSection.split(/a=msid\-semantic: WMS.*/g),i=[];switch(n.length){case 1:i.push(n[0]);break;case 2:i.push(n[0]),i.push(t),i.push("\n");break;case 3:i.push(n[0]),i.push(t),i.push("\n"),i.push(n[2]),i.push("\n")}return this.headerSection=i.join("")},updateAudioSSRCSection:function(e,t,n,i){this.audioSection&&(this.audioSection=this.removeSSRC(this.audioSection)),this.audioSection&&(this.audioSection=this.removeField_msid(this.audioSection)),this.audioSection&&(this.audioSection=this.audioSection+this.ssrcSection(e,t,n,i))},updateVideoSSRCSection:function(e,t,n,i){this.videoSection&&(this.videoSection=this.removeSSRC(this.videoSection)),this.videoSection&&(this.videoSection=this.removeField_msid(this.videoSection)),this.videoSection&&(this.videoSection=this.videoSection+this.ssrcSection(e,t,n,i))},getUpdatedSDP:function(e){var t,n,i;if(void 0!==e&&null!=e||(e=this._preAudioIndex<this._preVideoIndex),this.videoSection&&this.videoSection.replace(/a=mid:([^\r\n]+)/,(function(e,n){return t=n,e})),this.audioSection&&this.audioSection.replace(/a=mid:([^\r\n]+)/,(function(e,t){return n=t,e})),e){var o=["a=group:BUNDLE"];this.audioSection&&o.push(n),this.videoSection&&o.push(t),i=this.headerSection.replace(/a=group:BUNDLE [^\r\n]+/,o.join(" ")),this.audioSection&&(i+=this.audioSection),this.videoSection&&(i+=this.videoSection)}else o=["a=group:BUNDLE"],this.videoSection&&o.push(t),this.audioSection&&o.push(n),i=this.headerSection.replace(/a=group:BUNDLE [^\r\n]+/,o.join(" ")),this.videoSection&&(i+=this.videoSection),this.audioSection&&(i+=this.audioSection);return i},parseMsidSemantic:function(e){var t=this._parseLine(e,/a=msid\-semantic:\s*WMS (\S+)/gi);return t&&2==t.length&&(this.msidSemantic={line:t[0],WMS:t[1]}),this.msidSemantic},ssrcSection:function(e,t,n,i){return["a=ssrc:"+e+" cname:"+t,"a=ssrc:"+e+" msid:"+n+" "+i,"a=ssrc:"+e+" mslabel:"+n,"a=ssrc:"+e+" label:"+i,""].join("\n")},parseSSRC:function(e){var t=new RegExp("a=(ssrc):(\\d+) (\\S+):(\\S+)","ig"),n=this._parseLine(e,t);if(n){for(var i={lines:[],updateSSRCSection:this.ssrcSection},o=0;o<n.length;o++){var r=n[o];if(r.indexOf("a=ssrc")>=0)i.lines.push(r);else switch(r){case"ssrc":case"cname":case"msid":case"mslabel":case"label":i[r]=n[++o]}}return i}},_parseLine:function(e,t){for(var n,i=[];null!=(n=t.exec(e));)for(var o=0;o<n.length;o++)i.push(n[o]);if(i.length>0)return i}},a=function(e,t){i.extend(this,s),this._webrtc=t,this.spiltSection(e)};a.isAudioVideo=function(e){return e.indexOf("m=audio")<e.indexOf("m=video")},a.isVideoPreAudio=function(e){var t=e.indexOf("m=audio"),n=e.indexOf("m=video");return t>=0&&n>=0&&n<t};var c=wx.emedia.__rtc_globalCount=0,u=i.prototypeExtend({closed:!1,sdpConstraints:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},offerOptions:{offerToReceiveAudio:!0,offerToReceiveVideo:!0},optimalVideoCodecs:null,optimalAudioCodecs:null,__init__:function(){this._rtcId||(this._rtcId="RTC"+c++),this.__id="_i_"+c++,this.__setRemoteSDP=!1,this.__tmpRemoteCands=[],this.__tmpLocalCands=[],this._rtcPeerConnection=null,this.cctx=this.__id,wx.emedia&&wx.emedia.config&&wx.emedia.config.forceUseVideoCodecs&&wx.emedia.config.forceUseVideoCodecs.length>0&&(this.optimalVideoCodecs=wx.emedia.config.forceUseVideoCodecs),wx.emedia&&wx.emedia.config&&wx.emedia.config.forceUseAudioCodecs&&wx.emedia.config.forceUseAudioCodecs.length>0&&(this.optimalAudioCodecs=wx.emedia.config.forceUseAudioCodecs),wx.emedia&&wx.emedia.config&&"number"==typeof wx.emedia.config.forceVideoBitrate&&(this.vbitrate=wx.emedia.config.forceVideoBitrate),wx.emedia&&wx.emedia.config&&"number"==typeof wx.emedia.config.forceMinVideoBitrate&&(this.vminBitrate=wx.emedia.config.forceMinVideoBitrate),wx.emedia&&wx.emedia.config&&"number"==typeof wx.emedia.config.forceAudioBitrate&&(this.abitrate=wx.emedia.config.forceAudioBitrate),o.info("Webrtc created. optimal video codecs:",this.optimalVideoCodecs,"audio codecs:",this.optimalAudioCodecs,"vbitrate:",this.vbitrate,"vminBitrate:",this.vminBitrate,"abitrate:",this.abitrate,this._rtcId,this.__id)},getRtcId:function(){return this._rtcId},iceState:function(){return this._rtcPeerConnection.iceConnectionState},setSubArgs:function(e){this.subArgs=e},getReceiversOfPeerConnection:function(){if(this._rtcPeerConnection&&"closed"!=this._rtcPeerConnection.iceConnectionState)return this._rtcPeerConnection.getReceivers()},updateRemoteBySubArgs:function(){this.subArgs&&this._remoteStream&&(wx.emedia.enableVideoTracks(this._remoteStream,!(this.subArgs&&!1===this.subArgs.subSVideo)),wx.emedia.enableAudioTracks(this._remoteStream,!(this.subArgs&&!1===this.subArgs.subSAudio)),o.info("enable tracks remote stream",this._remoteStream,this.subArgs,this._rtcId,this.__id,this.closed))},createRtcPeerConnection:function(e){var t=this;o.debug("begin create peer connection ......",t._rtcId,t.__id,t.closed),e||(e=t.iceServerConfig),e||wx.emedia.isEdge?(e||(e={}),!e.iceServers&&(e.iceServers=[]),e.rtcpMuxPolicy="require",e.bundlePolicy="max-bundle",e.relayOnly&&(e.iceTransportPolicy="relay")):e=null,wx.emedia&&wx.emedia.config&&"function"==typeof wx.emedia.config.reconfigRTCConfiguration&&(e=wx.emedia.config.reconfigRTCConfiguration(e)),o.info("create pc, set config:",e,t._rtcId,t.__id,t.closed);var n=t._rtcPeerConnection=new RTCPeerConnection(e);function i(e){o.info("states: connectionState",n.connectionState,", iceConnectionState",n.iceConnectionState,"@",t._rtcId,t.__id,t.closed);try{var i=n.iceConnectionState||n.connectionState;"failed"!=n.connectionState&&"failed"!=n.iceConnectionState||(i="failed"),t.lastIceConnectionState!==i&&(t.lastIceConnectionState=i,t.onIceStateChange(i))}finally{}}n.__peerId=t._rtcId,o.debug("created local peer connection object",n,t._rtcId),n.onicecandidate=function(e){var n=e.candidate;if("icecandidate"!=e.type||n&&("string"!=typeof n.protocol||"tcp"!==n.protocol.toLowerCase())&&!/ TCP /.test(n.candidate)){if(!n.candidate)throw o.error("Not found candidate. candidate is error"),"Not found candidate. candidate is error,";if(n.cctx=t.cctx,!t.__setRemoteSDP)return(t.__tmpLocalCands||(t.__tmpLocalCands={})).push(n),void o.debug("On ICE candidate ok: but tmp buffer caused by not set remote sdp: ",n,t._rtcId,t.__id,t.closed);o.debug("On ICE candidate ok: ",n,t._rtcId,t.__id,t.closed),t._onIceCandidate(n)}else o.debug("On ICE candidate: drop",n,t._rtcId,t.__id,t.closed)},t.lastIceConnectionState="",n.onconnectionstatechange=i.bind(t),n.onicestatechange=i.bind(t),n.oniceconnectionstatechange=i.bind(t),n.onsignalingstatechange=function(e){o.info("states: signaling",n.signalingState,"@",t._rtcId,t.__id,t.closed)},null===n.ontrack&&t._onTrack&&(n.ontrack=function(e){t._onTrack(e)}),n.onaddstream=function(e){t._onGotRemoteStream(e)}},addTrack:function(e,t){var n=this;e.forEach((function(e){n._rtcPeerConnection.addTrack(e,t),o.debug("Added track(",e.id,e.kind,e.label,") of stream(",t.id,") to RtcPeerConnection",n._rtcId,n.__id,n.closed)}))},setLocalStream:function(e){var t=this;if(t._localStream=e,t._rtcPeerConnection.addTrack)e.getTracks().forEach((function(n){t._rtcPeerConnection.addTrack(n,e),o.debug("Added track(",n.enabled,n.id,n.kind,n.label,") of localStream(",e.id,") to RtcPeerConnection",t._rtcId,t.__id,t.closed)}));else{t._rtcPeerConnection.addStream(e);var n=e.getVideoTracks(),i=e.getAudioTracks();n&&n.length>0&&o.debug("RtcPeerConnection video: ",n[0].enabled,n[0].id,n[0].kind,n[0].label,t._rtcId,t.__id,t.closed),i&&i.length>0&&o.debug("RtcPeerConnection audio: ",i[0].enabled,i[0].id,i[0].kind,i[0].label,t._rtcId,t.__id,t.closed)}o.debug("Added local stream to RtcPeerConnection",e.id,e.active,t._rtcId,t.__id,this.closed)},removeStream:function(e){this._rtcPeerConnection.removeStream(e),o.debug("Remove stream from RtcPeerConnection",e,self._rtcId,self.__id,this.closed)},getLocalStream:function(){return this._localStream},getRemoteStream:function(){return this._remoteStream},createOffer:function(e,t){var n=this;o.debug("createOffer start...",n.offerOptions,n._rtcId,n.__id);var r=i.extend({},n.offerOptions);return n.subArgs&&(r={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),n._rtcPeerConnection.createOffer(r).then((function(t){if(n.offerDescription=t,wx.emedia.isEdge&&(t.sdp=t.sdp.replace(/profile-level-id=[^;]+/,"profile-level-id=42e01f")),wx.emedia.isFirefox?n.fireFoxOfferVideoPreAudio=n.__offerVideoPreAudio=a.isVideoPreAudio(t.sdp):n.__offerVideoPreAudio=a.isVideoPreAudio(t.sdp),t.sdp=t.sdp.replace(/m=video 0/g,"m=video 9"),o.warn("setLocalDescription. modify offer. if 'm=video 0' -> 'm=video 9'; if H264, 'profile-level-id=42e01f'",n._rtcId,n.__id),n.optimalVideoCodecs&&n.optimalVideoCodecs.length>0||n.optimalAudioCodecs&&n.optimalAudioCodecs.length>0||n.offerOptions&&(!1===n.offerOptions.offerToReceiveVideo||!1===n.offerOptions.offerToReceiveAudio)){var i=new a(t.sdp,n);n.optimalVideoCodecs&&i.updateVCodes(n.optimalVideoCodecs),n.optimalAudioCodecs&&i.updateACodes(n.optimalAudioCodecs),n.offerOptions&&!1===n.offerOptions.offerToReceiveVideo&&i.updateVideoSection(/a=sendrecv|a=recvonly/g,"a=sendonly"),n.offerOptions&&!1===n.offerOptions.offerToReceiveAudio&&i.updateAudioSection(/a=sendrecv|a=recvonly/g,"a=sendonly"),t.sdp=i.getUpdatedSDP()}o.debug("setLocalDescription start",n._rtcId,n.__id,n.closed,n.optimalVideoCodecs,n.optimalAudioCodecs),n._rtcPeerConnection.setLocalDescription(t).then(n._onSetLocalSessionDescriptionSuccess.bind(n),n._onSetSessionDescriptionError.bind(n,t)).then((function(){t.cctx=n.cctx,(e||n.onCreateOfferSuccess.bind(n))(t)}))}),t||n._onCreateSessionDescriptionError.bind(n,r))},createPRAnswer:function(e,t){var n=this;return o.info(" createPRAnswer start",n.closed,n.sdpConstraints),n._rtcPeerConnection.createAnswer(n.sdpConstraints).then((function(t){o.debug("_____________PRAnswer ",t.sdp,n._rtcId,n.__id,n.closed),t.type="pranswer",t.sdp=t.sdp.replace(/a=recvonly/g,"a=inactive");var i=new a(t.sdp,n);n.optimalVideoCodecs&&i.updateVCodes(n.optimalVideoCodecs),n.optimalAudioCodecs&&i.updateACodes(n.optimalAudioCodecs),t.sdp=i.getUpdatedSDP(),n.__prAnswerDescription=t,o.debug("inactive PRAnswer ",t.sdp,n._rtcId,n.__id,n.closed),o.debug("setLocalDescription start",t,n._rtcId,n.__id,n.closed),n._rtcPeerConnection.setLocalDescription(t).then(n._onSetLocalSessionDescriptionSuccess.bind(n),n._onSetSessionDescriptionError.bind(n,t)).then((function(){i.updateHeaderMsidSemantic("MS_0000"),i.updateAudioSSRCSection(1e3,"CHROME0000","MS_0000","LABEL_AUDIO_1000"),i.updateVideoSSRCSection(2e3,"CHROME0000","MS_0000","LABEL_VIDEO_2000"),t.sdp=i.getUpdatedSDP(),o.debug("Send PRAnswer ",t.sdp,n._rtcId,n.__id,n.closed),n.cctx&&(t.cctx=n.cctx),(e||n.onCreatePRAnswerSuccess.bind(n))(t)}))}),t||n._onCreateSessionDescriptionError.bind(n,n.sdpConstraints))},createAnswer:function(e,t){var n=this;return o.info("createAnswer start",n.closed,n.sdpConstraints),n._rtcPeerConnection.createAnswer(n.sdpConstraints).then((function(t){o.debug("_____________________Answer ",n._rtcId,n.__id,n.closed),t.type="answer";var i=new a(t.sdp,n);n.optimalVideoCodecs&&i.updateVCodes(n.optimalVideoCodecs),n.optimalAudioCodecs&&i.updateACodes(n.optimalAudioCodecs),wx.emedia.supportPRAnswer?function(e){var n=e.parseMsidSemantic(e.headerSection);if(n){"*"==n.WMS&&e.updateHeaderMsidSemantic(n.WMS="MS_0000");var i=e.parseSSRC(e.audioSection),o=e.parseSSRC(e.videoSection);i&&e.updateAudioSSRCSection(1e3,"CHROME0000",n.WMS,i.label||"LABEL_AUDIO_1000"),o&&e.updateVideoSSRCSection(2e3,"CHROME0000",n.WMS,o.label||"LABEL_VIDEO_2000"),t.sdp=e.getUpdatedSDP()}}(i):t.sdp=i.getUpdatedSDP(),n.__answerDescription=t,o.debug("Answer ",n._rtcId,n.__id,n.closed),o.debug("setLocalDescription start",t,n._rtcId,n.__id,n.closed),n._rtcPeerConnection.setLocalDescription(t).then(n._onSetLocalSessionDescriptionSuccess.bind(n),n._onSetSessionDescriptionError.bind(n,t)).then((function(){wx.emedia.supportPRAnswer&&(i.updateHeaderMsidSemantic("MS_0000"),i.updateAudioSSRCSection(1e3,"CHROME0000","MS_0000","LABEL_AUDIO_1000"),i.updateVideoSSRCSection(2e3,"CHROME0000","MS_0000","LABEL_VIDEO_2000"),t.sdp=i.getUpdatedSDP()),o.debug("Send Answer ",n._rtcId,n.__id,n.closed),n.cctx&&(t.cctx=n.cctx),(e||n.onCreateAnswerSuccess.bind(n))(t)}))}),t||n._onCreateSessionDescriptionError.bind(n,n.sdpConstraints))},_printStats:function(e){var t=this;t.confrAttendee&&wx.emedia.config.remainLastStatsCount&&e&&e.getTracks().forEach((function(e){t._printTrackStats(e)}))},_printTrackStats:function(e){if(this.confrAttendee&&wx.emedia.config.remainLastStatsCount){var t=this.confrAttendee._trackStats&&this.confrAttendee._trackStats[e.id];if(t){for(var n in t){var r=t[n];for(var s in r){var a=r[s];if(a)for(var c=a.curIndex,u=0;u<wx.emedia.config.remainLastStatsCount;u++){var d=a[c=(c-1)%wx.emedia.config.remainLastStatsCount];if(!d||void 0===d.data)break;o.info("[track]",this._rtcId,this.__id,e.kind,e.id,n,s,d.data,d.timestamp.toLocaleString())}}}i.removeAttribute(this.confrAttendee._trackStats,e.id)}}},close:function(e,t,n){var i=this;if(o.warn("webrtc closing",i._rtcId,i.__id,i.closed),i.__iceWaitIntervalId&&clearTimeout(i.__iceWaitIntervalId),!i.closed){t=!0===t,i.closed=!0;try{var r=function(){i._rtcPeerConnection&&i._rtcPeerConnection.close(),o.info("peer connection close. it is",i._rtcPeerConnection&&i._rtcPeerConnection.__peerId),!n&&wx.emedia.isSafari&&(i._rtcPeerConnection.iceConnectionState||i._rtcPeerConnection.connectionState,setTimeout((function(){i._rtcPeerConnection.iceConnectionState||i._rtcPeerConnection.connectionState,i.onIceStateChange&&i.onIceStateChange("closed")}),200))},s=i._localStream,a=i._remoteStream;wx.emedia.config.printStatsWhenPCClose?i.getStats((function(){r(),s&&i._printStats(s),a&&i._printStats(a)})):r()}catch(e){o.warn(e)}finally{i._localStream&&!1===e&&wx.emedia.stopTracks(i._localStream),i._remoteStream&&wx.emedia.stopTracks(i._remoteStream),i._remoteStream=null,t||i.onClose&&i.onClose(),!0===n&&(o.info("Webrtc close. but retry build. will onIceStateChange(failed). eg. wx.emedia.config iceWaitBuildMillis",i._rtcId,i.__id),i.onIceStateChange&&i.onIceStateChange("failed")),o.warn("webrtc closed. closed:",i._rtcId,i.__id,i.closed)}}},addIceCandidate:function(e){var t=i.isArray(e)?e:[e];if(emedia&&wx.emedia.config&&"function"==typeof wx.emedia.config.reChanageCandidate){for(var n=[],r=0;r<t.length;r++){e=t[r];var s=wx.emedia.config.reChanageCandidate(e);s&&(o.info("Candidate rechanage. addons. it =",e,"->",s),i.isArray(s)?Array.prototype.push.apply(n,s):n.push(s))}t=n}this._addIceCandidate(t)},_addIceCandidate:function(e){if(this._rtcPeerConnection){o.debug("Add ICE candidate: ",e,this._rtcId,this.__id,this.closed);var t=i.isArray(e)?e:[e];//!_util.isArray(candidate) && _cands.push(candidate);
if(!this.__setRemoteSDP)return Array.prototype.push.apply(this.__tmpRemoteCands||(this.__tmpRemoteCands={}),t),void o.debug("Add ICE candidate but tmp buffer caused by not set remote sdp: ",e,this._rtcId,this.__id,this.closed);for(var n=0;n<t.length;n++)if((e=t[n]).cctx&&e.cctx!=this.cctx)o.warn("addIceCandidate fail drop. cctx not equal. ",e,this._rtcId,this.__id,this.closed);else{if(!0===this.fireFoxOfferVideoPreAudio){var r=e.sdpMLineIndex;e.sdpMLineIndex=parseInt(e.sdpMid.replace(/[^0-9]*/,"")),o.warn("Firefox sdp section video pre audio, sdp mline index update ",r,"->",e.sdpMLineIndex)}e.candidate&&""!==e.candidate?this._rtcPeerConnection.addIceCandidate(new RTCIceCandidate(e)).then(this.onAddIceCandidateSuccess.bind(this),this._onAddIceCandidateError.bind(this,e)):o.warn("Add ICE candidate fail. drop it ",e,this._rtcId,this.__id,this.closed)}}},setRemoteDescription:function(e){return this._setRemoteDescription(e)},_setRemoteDescription:function(e){var t=this;if(t.__iceWaitIntervalId&&(clearTimeout(t.__iceWaitIntervalId),t.__iceWaitIntervalId=null,o.info("wx.emedia.config iceWaitBuildMillis, clear ice wait interval id",t._rtcId,t.__id)),o.debug("setRemoteDescription start. ",t._rtcId,t.__id,t.closed),t.offerDescription){if(e.cctx&&e.cctx!=t.cctx)return void o.warn("setRemoteDescription fail drop. cctx not equal. ",e,t._rtcId,t.__id,t.closed);if(!0===t.fireFoxOfferVideoPreAudio||!0===t.__offerVideoPreAudio){var n=new a(e.sdp,t);e.sdp=n.getUpdatedSDP(!1),o.info("Remote sdp.2. switch audio video",e.sdp)}}else e.cctx&&(t.cctx=e.cctx);return e.sdp=e.sdp.replace(/UDP\/TLS\/RTP\/SAVPF/g,"RTP/SAVPF"),o.warn("setRemoteDescription. UDP/TLS/RTP/SAVPF -> RTP/SAVPF; if firefox: switch audio video;",t._rtcId,t.__id),(t.vbitrate||t.abitrate||t.vminBitrate)&&(n=new a(e.sdp,t),t.vbitrate&&n.setVideoBitrate(t.vbitrate),t.vminBitrate&&n.setVideoMinBitrate(t.vminBitrate),t.abitrate&&n.setAudioBitrate(t.abitrate),o.warn("vbitrate = ",t.vbitrate,"vminBitrate = ",this.vminBitrate,", abitrate = ",t.abitrate,t._rtcId,t.__id),e.sdp=n.getUpdatedSDP(void 0===t.__offerVideoPreAudio||null===t.__offerVideoPreAudio?void 0:!t.__offerVideoPreAudio)),o.debug("final remote sdp =",e.sdp,t._rtcId,t.__id),e=t.__remoteDescription=new RTCSessionDescription(e),t._rtcPeerConnection.setRemoteDescription(e).then((function(){t.__setRemoteSDP=!0,t._onSetRemoteSuccess.apply(t,arguments),t.__tmpLocalCands&&t.__tmpLocalCands.length>0&&(o.debug("After setRemoteDescription. send cands",t._rtcId,t.__id,t.closed),t._onIceCandidate(t.__tmpLocalCands),t.__tmpLocalCands=[]),t.__tmpRemoteCands&&t.__tmpRemoteCands.length>0&&(o.debug("After setRemoteDescription. add tmp cands",t._rtcId,t.__id,t.closed),t._addIceCandidate(t.__tmpRemoteCands),t.__tmpRemoteCands=[])}),t._onSetSessionDescriptionError.bind(t,e))},iceConnectionState:function(){return this._rtcPeerConnection.iceConnectionState},isConnected:function(){var e=this.lastIceConnectionState;return"connected"===e||"completed"===e},_onGotRemoteStream:function(e){var t=this;t._remoteStream=e.stream||e.streams[0],t._remoteStream._rtcId=t._rtcId,t._remoteStream.__rtc_c_id=t.__id,o.debug("On got remote stream",t._remoteStream?t._remoteStream.id+"_"+t._remoteStream.active:"null",t._rtcId,t.__id),t._remoteStream&&t._remoteStream.getTracks().forEach((function(e){o.debug("remote stream",t._remoteStream.id," track =",e.enabled,e.id,e.kind,e.label,t._rtcId,t.__id)})),t.updateRemoteBySubArgs(),this.onGotRemoteStream(this._remoteStream,e),o.debug("received remote stream, you will see the other.",t._rtcId,t.__id,this.closed)},_onSetRemoteSuccess:function(){o.info("onSetRemoteSuccess success",this._rtcId,this.__id),this.onSetRemoteSuccess.apply(this,arguments),this.offerDescription&&this.__remoteDescription&&this.__remoteDescription.sdp&&this._onAnswerCodes(this.__remoteDescription.sdp)},_onAnswerCodes:function(e){var t=new a(e,this);if(t.videoSection){var n=r.parseRtpParameters(t.videoSection);if(!n.codecs||0===n.codecs.length)return void o.info("not found any video codes. @ ",this._rtcId,this.__id);var s=[];i.forEach(n.codecs,(function(e,t){s.push(t.name)})),this.finalVCodeChoices=s,this.onVCodeChoices&&this.onVCodeChoices(s)}},onSetRemoteSuccess:function(){},onAddIceCandidateSuccess:function(){o.debug("addIceCandidate success",this._rtcId,this.__id)},_onAddIceCandidateError:function(e,t){o.error("failed to add ICE Candidate: "+t.toString(),", error candidate:",e,this._rtcId,this.__id),this.onAddIceCandidateError(t)},onAddIceCandidateError:function(e){},_onIceCandidate:function(e){o.debug("onIceCandidate:",e,this._rtcId,this.__id),this.onIceCandidate(e)},onIceCandidate:function(e){},onIceStateChange:function(e){o.debug("onIceStateChange : ICE state ",e)},_onCreateSessionDescriptionError:function(e,t){o.error("Failed to create session description: "+t.toString()," offerOptionsOrSDPConstraints:",e,this._rtcId,this.__id),this.onCreateSessionDescriptionError(t)},onCreateSessionDescriptionError:function(e){},onCreateOfferSuccess:function(e){o.debug("create offer success",this._rtcId,this.__id)},onCreatePRAnswerSuccess:function(e){o.debug("create answer success",this._rtcId,this.__id)},onCreateAnswerSuccess:function(e){o.debug("create answer success",this._rtcId,this.__id)},_onSetSessionDescriptionError:function(e,t){o.error("onSetSessionDescriptionError : Failed to set session description: ",t.toString(),this._rtcId,this.__id),e&&e.type&&e.sdp&&o.error("error sdp: type=",e.type,"sdp=",e.sdp,this._rtcId,this.__id),this.onSetSessionDescriptionError(t)},onSetSessionDescriptionError:function(e){},_onSetLocalSessionDescriptionSuccess:function(){var e=this;o.debug("onSetLocalSessionDescriptionSuccess : setLocalDescription complete",this._rtcId,this.__id),wx.emedia.config.iceWaitBuildMillis&&(this.__iceWaitIntervalId&&clearTimeout(this.__iceWaitIntervalId),this.__iceWaitIntervalId=setTimeout((function(){o.info("wx.emedia.config iceWaitBuildMillis, timeout, will close webrtc, will retry build by onIceStateChange(failed)",e._rtcId,e.__id),e.onIceStateChange&&e.onIceStateChange("failed")}),wx.emedia.config.iceWaitBuildMillis),o.info("wx.emedia.config iceWaitBuildMillis, start timeout",e._rtcId,e.__id)),this.onSetLocalSessionDescriptionSuccess(),this.__answerDescription&&this.__answerDescription.sdp&&this._onAnswerCodes(this.__answerDescription.sdp)},onSetLocalSessionDescriptionSuccess:function(){},onGotRemoteStream:function(e){o.debug("Got remote stream. ",e,this._rtcId,this.__id)},getStats:function(e){var t=this;return t._rtcPeerConnection?"function"!=typeof wx.emedia.config.rtcStatsTypeMath?(o.warn("Get stats, but config rtcStatsTypeMather, ",this._rtcId,this.__id),void(e&&e())):void t._rtcPeerConnection.getStats(null).then((function(n){n.forEach((function(e,n){wx.emedia.config.rtcStatsTypeMath(e,n)&&o.info("Rtc stats",e,t._rtcId,t.__id)})),e&&e(n)})):(o.warn("Get stats, but peer connection not exsits, ",this._rtcId,this.__id),void(e&&e()))}});e.exports=u},function(e,t,n){var i=n(0);wx.emedia.subscribed=function(e){return!!e._located||(2===e.type?!(e._located||!e._webrtc):void 0!==e._webrtc)};var o=i.prototypeExtend({voff:0,aoff:0,__init__:function(){var e=this;if(!e._mediaStream)throw _logger.error("_mediaStream empty"),"_mediaStream empty";if(e.hasEnabledTracks(e._mediaStream)){if(!e.__audioContext)throw _logger.error("require audioContext"),"require audioContext";e.__soundMeter=new SoundMeter(e.__audioContext),e.__soundMeter.connectToSource(e._mediaStream,(function(t){if(t)throw t;e.__worked=e.__soundMeter.__worked=!0}))}},hasEnabledTracks:function(e){return wx.emedia.hasEnabledTracks(e)},getSoundMeters:function(){if(this.__soundMeter&&this.__worked)if(this._mediaStream.active){if(this.hasEnabledTracks(this._mediaStream))return{instant:this.__soundMeter.instant,slow:this.__soundMeter.slow,clip:this.__soundMeter.clip}}else this.__worked&&this._finally()},_finally:function(){this.__soundMeter&&(this.__soundMeter.stop(),this.__worked=this.__soundMeter.__worked=!1)}});e.exports=i.prototypeExtend({__undefinedEQDelete:!0,Update:i.prototypeExtend({ifAoff:function(e){this.if("aoff",e)},ifVoff:function(e){this.if("voff",e)},ifMediaStream:function(e){this.if("mediaStream",e)},if:function(e,t){void 0!==this[e]&&t(this[e])}}),located:function(){return this._located||!1},webrtc:function(e){return e&&(this._webrtc=e),this},getMediaStream:function(){return void 0!==this.mediaStream?this.mediaStream:this._located?this._localMediaStream:this._webrtc&&(this._webrtc.getRemoteStream()||this._webrtc.getLocalStream())},requestFrame:function(){this._localMediaStream&&this._localMediaStream.getVideoTracks().forEach((function(e){"function"==typeof e.requestFrame&&e.requestFrame()}))},getLocalMediaStream:function(){return this._localMediaStream},getRemoteMediaStream:function(){if(this._webrtc&&void 0!==this._webrtc.getRemoteStream())return this._webrtc.getRemoteStream()},mutedNeed:function(){return this.mutedMuted||!1},ifMediaStream:function(e){void 0===this.mediaStream?this._located&&void 0!==this._localMediaStream?e(this._localMediaStream):this._located||!this._webrtc||void 0===this._webrtc.getRemoteStream()||e(this._webrtc.getRemoteStream()):e(this.mediaStream)},subscribed:function(){return wx.emedia.subscribed(this)},updateAttributes:function(){for(var e=this,t=0;t<arguments.length;t++){var n=arguments[t];if(i.isPlainObject(n))for(var o in n){var r=n[o];e[o]=r}}},getHtmlDOMID:function(){return"_m_"+this.owner.id+"_s_"+this.id},MediaSoundMeter:o,StreamSoundMeter:i.prototypeExtend({__init__:function(){if(!this._stream||"function"!=typeof this._stream.getMediaStream)throw _logger.error("_stream empty or not found method getMediaStream"),"_stream empty or not found method getMediaStream";if(this._streamId=this._stream.id,this._streamCreateId=this._stream.__create_id,this._mediaStream=this._mediaStream,2===this._stream.type&&!this._stream.located()&&!this._webrtc)throw _logger.error("require webrtc. when type = 2 and not located"),"require webrtc. when type = 2 and not located";this.__mediaSoundMeter=this.__mediaSoundMeter||new o({__audioContext:this.__audioContext,_mediaStream:this._mediaStream}),this.__mediaSoundMeter.useCount=(this.__mediaSoundMeter.useCount||0)+1},onSoundMeters:function(e){var t={instant:0,slow:0,clip:0};if(this._stream.aoff)return this._finally(),e(t),t;if(2!==this._stream.type&&this._stream.subArgs&&void 0!==this._stream.subArgs.subSAudio&&!this._stream.subArgs.subSAudio)return this._finally(),e(t),t;if(0==this._stream.id||2===this._stream.type&&!this._stream.located()&&(!this._stream.subArgs||!this._stream.subArgs.subSAudio)){var n,o=this._webrtc.getReceiversOfPeerConnection();if(!o||0===o.length)return e(t),t;for(var r in o)"audio"===o[r].track.kind&&(n=o[r]);if(!n)return e(t),t;if("function"==typeof n.getContributingSources){var s,a=n.getContributingSources();if(wx.emedia.config._printSoundData&&i.logger.debug(this._stream.id,this._stream.csrc,"rtpContributingSources ",a),!a||0===a.length)return e(t),t;for(var r in a)a[r].source==this._stream.csrc&&(s=this._stream.csrc);if(wx.emedia.config._printSoundData&&i.logger.debug(this._stream.id,this._stream.csrc,"source ",s),void 0===s)return e(t),t}}var c=this.__mediaSoundMeter.getSoundMeters()||t,u=2===this._stream.type?this._webrtc:this._stream._webrtc;(wx.emedia.meterWithTrackAudioLevel||0===c.instant)&&u&&!u.closed&&u._rtcPeerConnection&&u._rtcPeerConnection.getStats().then((function(t){t.size>0&&t.forEach((function(t){"track"!==t.type||"audio"!==t.kind&&"audio"!==t.trackIdentifier||(c.trackAudioLevel=t.audioLevel,c.trackTotalAudioEnergy=t.totalAudioEnergy,e(c))}))})),e(c)},_finally:function(){2===this._stream.type&&this._stream.located()&&this._remoteMediaSoundMeters&&this._remoteMediaSoundMeters._finally(),this.__mediaSoundMeter.useCount--,0===this.__mediaSoundMeter.useCount&&this.__mediaSoundMeter._finally()}})})},function(e,t,n){var i=wx.emedia={},o=wx.emedia.util=n(0);if(wx.emedia.config=function(e){for(var t in e=o.extend({},e))wx.emedia.config[t]=e[t],"logLevel"===t&&(wx.emedia.LOG_LEVEL=e[t]);wx.emedia.config.loglastConfrCount&&!wx.emedia._logContext&&(wx.emedia._logContext=new Array(wx.emedia.config.loglastConfrCount),wx.emedia._logContextIndex=-1)},wx.emedia.config({autoSub:!0,onlyEnter:!1,reconnect:13,reconnectDelay:3e3,getCopyIntervalMillis:3e4,checkConnectIntervalMillis:1e3,iceRebuildCount:3,iceRebuildIntervalMillis:500,enterTimeout:2e4,useRTCCfgIfServerReturn:!1,forceUseRTCCfgIfServerReturnWhenP2P:!0,allowRepeatAudioMixerPublish:!1,logVolumeWhenInstantGE:.5,getMediaMeterIntervalMillis:400,_useRequestAnimationFrame:!1,meterWithTrackAudioLevel:!1,judgeTalkingByInstantGE:.05,_printSoundData:!1,trackBufferSize:20,allowSendWhenLessThan:4,disableTrack:!1,ctrlCheckIntervalMillis:1e4,ctrlTimeoutMillis:3e4,_printDebugStats:!1,statsSeconds:10,remainLastStatsCount:120,loglastConfrCount:2,loglastStoreArray:!0,consoleLogger:!0,printStatsWhenPCClose:!0,rebuildPeerConnectionWhenNetworkChanaged:!0,rtcStatsTypeMath:function(e,t){switch(e.type){case"remote-candidate":case"local-candidate":case"track":case"stream":case"inbound-rtp":case"outbound-rtp":case"transport":return!0}return!1},apiURL:"https://a1.easemob.com",useUniappPlugin:!1}),o.logger.count(),wx.emedia.AudioContext=wx.AudioContext||wx.webkitAudioContext,wx.emedia.config.getMediaMeterIntervalMillis){try{"function"==typeof wx.emedia.AudioContext?(wx.emedia.__audioContext=new wx.emedia.AudioContext,wx.emedia.__usingWebAudio=!0):wx.emedia.__usingWebAudio=!1}catch(e){wx.emedia.__usingWebAudio=!1}wx.emedia.__usingWebAudio||__f__("warn","'new AudioContext()' failed. can not know who talking."," at emediaSDK/emedia_for_miniProgram.js:3"),wx.emedia.__audioContext&&"suspended"===wx.emedia.__audioContext.state&&__f__("warn","audioContext.state is suspended. can not know who talking. You can resume() wx.emedia.__audioContext, but only in response to a tap."," at emediaSDK/emedia_for_miniProgram.js:3")}wx.requestAnimationFrame&&wx.emedia.config._useRequestAnimationFrame?wx.emedia.requestAnimationFrame=function(e){wx.requestAnimationFrame(e)}:wx.emedia.requestAnimationFrame=function(e,t){return setTimeout(e,t||wx.emedia.config.getMediaMeterIntervalMillis)},wx.cancelAnimationFrame&&wx.emedia.config._useRequestAnimationFrame?wx.emedia.cancelAnimationFrame=function(e){wx.cancelAnimationFrame(e)}:wx.emedia.cancelAnimationFrame=function(e){clearTimeout(e)},wx.emedia.stopAudioTracks=function(e){e&&e.getAudioTracks().forEach((function(t){t.stop(),o.logger.info("Media stream stop audio track. stream =",e.id,"track =",t.id,t.kind)}))},wx.emedia.stopAndRemoveAudioTracks=function(e){var t=[];e&&e.getAudioTracks().forEach((function(n){n.stop(),t.push(n),o.logger.info("Media stream stop and remove audio tracks. stream =",e.id,"track =",n.id,n.kind)})),o.forEach(t,(function(t,n){e.removeTrack(n)}))},wx.emedia.stopTracks=function(e){try{if(!e||!1===e.active)return void o.logger.debug("stream tracks had been stoped. it ",e&&e.id);e.getTracks().forEach((function(t){t.stop(),o.logger.info("Media stream stop track. stream =",e.id," track =",t.id,t.kind)})),e._bindAttendee&&(o.removeAttribute(e._bindAttendee._openedRtcMediaStreams,e.id),e._bindAttendee=null),o.logger.info("stream tracks stoped. it ",e.id)}catch(e){o.logger.error(e)}},wx.emedia.enableVideoTracks=function(e,t){e&&e.getVideoTracks().forEach((function(n){if("function"==typeof n.enable)return n.enable(),o.logger.info("Media stream enable video track. stream =",e.id,"track =",n.kind,n.enabled,n.id),void(n.enabled===t||n.enable(t));n.enabled===t||(n.enabled=t)}))},wx.emedia.enableAudioTracks=function(e,t){e&&e.getAudioTracks().forEach((function(n){if("function"==typeof n.enable)return n.enable(),o.logger.info("Media stream enable audio track. stream =",e.id,"track =",n.kind,n.enabled,n.id),void(n.enabled===t||n.enable(t));n.enabled===t||(n.enabled=t)}))},wx.emedia.hasEnabledTracks=function(e){if(!e||"function"!=typeof e.getAudioTracks)return!1;if(!e.active)return!1;var t=e.getAudioTracks();if(0===t.length)return!1;for(var n in t)if("function"==typeof t[n].enable&&t[n].enable(),t[n].enabled)return!0;return!1},wx.emedia.genReportName=function(){var e=wx.emedia._lastSetupDate||new Date;return(wx.emedia._lastSetupTktId||wx.emedia._lastSetupConfr)+"_"+wx.emedia._lastSetupMemName+"_"+e.getTime()+".docx"},wx.emedia.getReportUploadUrl=function(e,t,n){var i=new XMLHttpRequest;i.open(e,t,!0),i.addEventListener("load",(function(e){n&&n(e)}),!1),i.send(null)},wx.emedia.uploadReport=function(e,t,n,i,r,s){var a=wx.emedia.genReport();if(a){"function"==typeof n&&(s=r,r=i,i=n,n=void 0);var c=new Blob([a],{type:"text/plain"}),u=new FormData;u.append(e,c,e),n&&"function"==typeof u.set&&o.forEach(n,(function(e,t){u.set(e,t)}));var d=new XMLHttpRequest;d.open("POST",t,!0),d.setRequestHeader("X-File-Name",e),s&&s(d),d.addEventListener("load",(function(n){__f__("info","log begin upload. result = ",n.currentTarget.status,e," > ",t," at emediaSDK/emedia_for_miniProgram.js:3"),200===n.currentTarget.status?i&&i(n):r&&r(n)}),!1),d.send(u),__f__("info","log begin upload. ",e," > ",t," at emediaSDK/emedia_for_miniProgram.js:3")}else r&&r("not logs")},wx.emedia.genReport=function(){if(wx.emedia._logContext&&wx.emedia._logContext instanceof Array&&!(void 0===wx.emedia._logContextIndex||wx.emedia._logContextIndex<0)){var e=0,t=wx.emedia._logContextIndex;wx.emedia._logContextIndex>=wx.emedia._logContext.length&&(e=wx.emedia._logContextIndex-wx.emedia._logContext.length+1);for(var n="",i=e;i<=t;i++){var o=i%wx.emedia._logContext.length;n+=wx.emedia._logContext[o].join("\r\n")+"\r\n"}return wx.emedia._logContext.loadlogs&&wx.emedia._logContext.loadlogs instanceof Array&&(n+="-------------------------------------------------------------\r\n",n+=wx.emedia._logContext.loadlogs.join("\r\n")+"\r\n"),n}},wx.emedia.fileReport=function(){var e=wx.emedia.genReport();if(e){var t=wx.getFileSystemManager(),n=wx.env.USER_DATA_PATH+"/"+wx.emedia.genReportName();__f__("log","report:",e," at emediaSDK/emedia_for_miniProgram.js:3"),t.writeFile({filePath:n,data:e,success:function(e){__f__("log","success",e," at emediaSDK/emedia_for_miniProgram.js:3"),__f__("log",n," at emediaSDK/emedia_for_miniProgram.js:3"),wx.openDocument({filePath:n,success:function(e){__f__("log","\u6253\u5f00\u6587\u6863\u6210\u529f",e," at emediaSDK/emedia_for_miniProgram.js:3")},fail:function(e){__f__("log","\u6253\u5f00\u5931\u8d25",e," at emediaSDK/emedia_for_miniProgram.js:3")}})},fail:function(e){__f__("log","fail",e," at emediaSDK/emedia_for_miniProgram.js:3")},complete:function(e){wx.downloadFile({url:n,success:function(e){var t=e.tempFilePath;wx.openDocument({filePath:t,fileType:"docx",success:function(e){__f__("log","\u6253\u5f00\u6587\u6863\u6210\u529f",e," at emediaSDK/emedia_for_miniProgram.js:3")},fail:function(e){__f__("log","\u6253\u5f00\u5931\u8d25",e," at emediaSDK/emedia_for_miniProgram.js:3")}})}})}})}},wx.emedia.config({globalConstraints:{}});var r=n(6),s=n(1);wx.emedia.Webrtc=n(3),wx.emedia.Service=r,wx.emedia.XService=r,wx.emedia.mgr=n(2),wx.emedia.event=s,wx.emedia.LOG_LEVEL=0,wx.emedia.isFirefox="firefox"===wx.emedia.browser,wx.emedia.isChrome="chrome"===wx.emedia.browser,wx.emedia.isSafari="safari"===wx.emedia.browser,wx.emedia.isEdge="edge"===wx.emedia.browser,wx.emedia.youInSomeBrowsers=function(){return!1},wx.emedia.requireTrustBeforeJoin=function(){return!1},wx.emedia.isWebRTC=wx.RTCPeerConnection&&/^https\:$/.test(wx.location.protocol),(wx.emedia.isChrome||wx.emedia.isSafari)&&(wx.emedia.supportPRAnswer=!0),wx.emedia.supportPRAnswer=!1,wx.emedia.config({baseAcptOps:[102,104,105,106,107,300,302,303,304,301,204,206,400,401,1001,100201,100202,100203]}),wx.emedia.config({clientType:"MINI_PROGRAM",version:"v3.1.6",userAgent:"",acptOps:[1003]}),e.exports=i},function(e,t,n){var i=n(0),o=i.tagLogger("Service"),r=n(7),s=n(8),a=n(1),c=n(10),u=n(4);e.exports=i.prototypeExtend({__init__:function(){var e=this;if(o.warn("emedia version: ",wx._emediaVersion||"unkown"),e.namespace=Math.uuidFast(),wx.emedia.useCurrentXService=e,void 0===e.useRTCCfg&&(e.useRTCCfg=wx.emedia.config.useRTCCfgIfServerReturn),"string"==typeof e.useRTCCfg&&(e.useRTCCfg=JSON.parse(e.useRTCCfg)),e.listeners)for(var t in e.listeners){var n=t,i=e.listeners[n];void 0!==i&&"onRecvRemoteMessage"!==n&&"onSoundChanage"!==n&&"onTalking"!==n&&(e.listeners["__user_"+n]=i,e.listeners[n]=function(t,n){return function(){o.info("sdk call user impl func. func=",t,e.current&&e.current.getMemberId()),n.apply(this,arguments)}}(n,i))}},AVPubstream:u.extend({__init__:function(){this.type=0,this._located=!0,this.mutedMuted=!0,this.constaints&&(this.constaints.video||(this.voff=1),this.constaints.audio||(this.aoff=1)),this.constaints||(this.constaints={audio:!0,video:!0}),wx.emedia.config.maxVideoBitrate&&(this.vbitrate=wx.emedia.config.maxVideoBitrate),wx.emedia.config.maxAudioBitrate&&(this.abitrate=wx.emedia.config.maxAudioBitrate)}}),AudioMixerPubstream:new u.extend({__init__:function(){if(this.type=2,this._located=!0,this.mutedMuted=!0,this.constaints||(this.constaints={audio:!0,video:!1}),this.constaints){var e=!!this.constaints.audio;this.constaints.video||(this.constaints.video=!1),this.constaints.video||(this.voff=1),this.constaints.audio||(this.aoff=1),!1===e&&(this.aoff=1)}wx.emedia.config.maxVideoBitrate&&(this.vbitrate=wx.emedia.config.maxVideoBitrate),wx.emedia.config.maxAudioBitrate&&(this.abitrate=wx.emedia.config.maxAudioBitrate)},onGotRemoteMediaStream:function(e){if(!this.remotePlayAudioObject){var t="__o_remote_play_audio_"+this.id,n=document.querySelector("#"+t);n||((n=document.createElement("audio")).style.display="none",n.id="__o_remote_play_audio_"+this.id,n.autoplay=!0,n.playsinline=!0,document.body.appendChild(n)),this.remotePlayAudioObject=n}this.remotePlayAudioObject.srcObject=e}}),ShareDesktopPubstream:u.extend({voff:0,__init__:function(){this.type=1,this._located=!0,this.mutedMuted=!0,this.constaints={audio:!this.aoff,video:!0},wx.emedia.config.maxVideoBitrate&&(this.vbitrate=wx.emedia.config.maxVideoBitrate),wx.emedia.config.maxAudioBitrate&&(this.abitrate=wx.emedia.config.maxAudioBitrate)}}),__assertCurrent:function(){if(!this.current)throw o.error("Please call wx.emedia.service.setup(ticket)"),"Please call wx.emedia.service.setup(ticket)";if(this.current.closed)throw o.error("current closed"),"current closed"},hasAudioMixers:function(){for(var e in this.__assertCurrent(),this.current.audioMixers){var t=this.current.audioMixers[e];if(t&&t.located())return!0}},getMediaDevices:function(e,t,n){"function"==typeof e&&(n=t,t=e,e=void 0),navigator.mediaDevices.enumerateDevices().then((function(n){for(var i=[],r=0;r!==n.length;++r){var s=n[r];e?e===s.kind?i.push(s):"audioinput"===s.kind||"audiooutput"===s.kind||"videoinput"===s.kind||o.info("Some other kind of source/device: ",s):i.push(s)}t&&t(i)})).catch((function(e){o.warn("navigator.getUserMedia error: ",e),n&&n(e)}))},attachSinkId:function(e,t){void 0!==e.sinkId?e.setSinkId(t).then((function(){o.info("Success, audio output device attached: "+t)})).catch((function(e){var t=e;"SecurityError"===e.name&&(t="You need to use HTTPS for selecting audio output device: "+e),o.warn(t)})):o.warn("Browser does not support output device selection.")},_stopTracks:function(e){wx.emedia.stopTracks(e),e&&o.warn("Stream tracks stop. it = ",e)},_enableVideoTracks:function(e,t){wx.emedia.enableVideoTracks(e,t)},_enableAudioTracks:function(e,t){wx.emedia.enableAudioTracks(e,t)},openUserMedia:function(e){o.debug("begin open user media",e);var t=this;if(!e)throw o.error("require pubS"),"require pubS";return{then:function(n,i){function r(){n.apply(null,arguments);var i=e.localStream;i&&(i.oninactive=t._onStreamInactive.bind(t,e,i),i.onactive=t._onStreamActive.bind(t,e,i))}if(e instanceof t.AVPubstream)t._openCamera(e,r,i);else if(e instanceof t.ShareDesktopPubstream)t._openSharedDesktop(e,r,i);else{if(!(e instanceof t.AudioMixerPubstream))throw o.error("Unspported pubS"),"Unspported pubS";t._openCamera(e,r,i)}}}},_openSharedDesktop:function(e,t,n){var r,s=this;function c(e){var i={audio:!0};e.constaints&&("object"==typeof e.constaints.audio&&e.constaints.audio||e.constaints.audio||(i.audio=!1)),s.__getUserMedia(i,(function(n,i){var o=new MediaStream;o._located=!0,i&&i.getAudioTracks().forEach((function(e){o.addTrack(e)})),e.localStream&&e.localStream.getVideoTracks().forEach((function(e){o.addTrack(e)})),e.localStream=o,t&&t(s.current,o)}),n)}if(e._localMediaStream&&(r=e._localMediaStream.getVideoTracks())&&r.length>0)return e.localStream=e._localMediaStream,void(e.constaints.audio?c(e):t&&t(s.current,stream));__desktop.openDesktopMedia(e.screenOptions||["screen","window","tab"],(function(r){if(r instanceof a.OpenDesktopMedia){var u=r.desktopStreamId;o.warn("desktop streamId",u);var d={audio:!1,video:{mandatory:i.extend(e.mandatory||{},{chromeMediaSource:"desktop",chromeMediaSourceId:u}),optional:[]}};s.__getUserMedia(d,(function(n,i){e.localStream=i,e.constaints.audio?c(e):t&&t(s.current,i)}),n)}else s.current&&s.current.onEvent(new a.ShareDesktopExtensionNotFound({member:s.current})),n&&n(r)}))},_openCamera:function(e,t,n){var i=this,o=e.constaints||{audio:!0,video:!0};i.__getUserMedia(o,function(n,o){i.__controlStream(e,o),e.localStream=o,t&&t(i.current,o)}.bind(o),n)},__controlStream:function(e,t){wx.emedia.enableVideoTracks(t,!e.voff),wx.emedia.enableAudioTracks(t,!e.aoff)},__getUserMedia:function(e,t,n){o.debug("get user media. using constaints",e);var r,s=this;function c(e){o.debug("[WebRTC-API] getUserMedia() error: ",e),wx.emedia.stopTracks(r),s.current&&s.current.onEvent(new a.OpenMediaError({member:s.current,event:e})),n&&n(new a.OpenMediaError({member:s.current,event:e}))}e=i.extend({},e),s.__sysGetUserMedia(e,(function(n){s.current&&!s.current.closed&&(s.current._openedRtcMediaStreams[n.id]=n,n._bindAttendee=s.current,n._bindAttendeeId=s.current.getMemberId(),o.info("stream bind attendee.",n.id,s.current.ticket&&s.current.ticket.id,s.current.getMemberId(),s.current.memName)),wx.emedia._yetGetUserMedia=!0,r=n;var i=n.getVideoTracks(),a=n.getAudioTracks();if(i.length>0){var u=i[0];o.debug(n.id,"using video device: ",u.id,u.label,u.kind,u.enabled)}if(a.length>0){var d=a[0];o.debug(n.id,"using audio device: ",d.id,d.label,d.kind,d.enabled)}if(n._located=!0,"boolean"==typeof n.active&&!n.active)return o.error("media stream not active. it is",n.id),void c({constraint:e,name:"NotAllowedStreamNonactive",message:"stream non-active"});t&&t(s.current,n)}),c)},_onStreamInactive:function(e,t,n){var r=this;o.warn("media stream inactive. it =",t.id),e.onMediaInactive&&r.current&&i.forEach(r.current._cacheStreams,(function(i,o){o.located()&&o.localStream&&o.localStream.id===t.id&&(o._webrtc&&o._webrtc.closed||e.onMediaInactive.call(o,t,n,r))}))},_onStreamActive:function(e,t,n){var r=this;o.warn("media stream active. it =",t.id),e.onMediaActive&&r.current&&i.forEach(r.current._cacheStreams,(function(i,o){o.located()&&o.localStream&&o.localStream.id===t.id&&e.onMediaActive.call(o,t,n,r)}))},setup:function(e,t){var n=this;o.count(),o.debug("recv ticket",e,t),o.debug("use sdk version",wx._emediaVersion);var r,a,u=t=t||{};if(i.isPlainObject(t))t=JSON.stringify(t);else try{u=JSON.parse(t)}catch(e){}"string"==typeof e&&(e=JSON.parse(e)),r=a=e.memName,wx.emedia._lastSetupConfr=e.confrId,wx.emedia._lastSetupMemName=a,wx.emedia._lastSetupDate=new Date,wx.emedia._lastSetupTktId=e.tktId;var d=(n.Attendee||s).extend(c);return n.current=new d({_service:n,service:n,autoSub:wx.emedia.config.autoSub,getCopyIntervalMillis:wx.emedia.config.getCopyIntervalMillis,sysUserId:r,memName:a,resource:n.resource,nickName:n.nickName,ticket:e,ext:t,extObj:u,sessionFactory:function(){return n.newSession(this,e)}},n.listeners||{})},getStreamById:function(e){var t=this.current&&this.current._cacheStreams[e];return t&&i.extend(!1,{},t)},getStreamsByRtcId:function(e){if(this.current&&this.current._cacheStreams){var t=[];return i.forEach(this.current._cacheStreams,(function(n,i){i.rtcId===e&&t.push(i)})),t}},getMemberById:function(e){var t=this.current&&this.current._cacheMembers[e];return t&&i.extend(!1,{},t)},exit:function(e){o.warn("User click exit ",e),this.current&&this.current.exit(e)},join:function(e,t){if(o.debug("begin join ..."),this.__assertCurrent(),this.current._memberId)return o.warn("Had joined. igrone it"),void(e&&e(this.memId));this.current._session._sessionId=void 0,this.current.join(e,t)},withpublish:function(e){if(__f__("log","serveice withpublish"," at emediaSDK/emedia_for_miniProgram.js:3"),!e||!e.localStream)throw o.error("pubS null or stream not open"),"pubS null or stream not open";return this.__assertCurrent(),this.current._memberId?o.warn("Had joined. igrone it"):this.current._session._sessionId=void 0,this.current.withpublish(e)},push:function(e,t,n){o.debug("begin push ...");var i=this;if(2===arguments.length&&(n=t,t=void 0),!e||!e.localStream)throw o.error("pubS or stream open"),"pubS or stream open";i.__assertCurrent(),i.current.push(e,t,n,!1)},subscribe:function(e,t,n,r){var s=this;if(o.info("begin subscribe ",e,r),t&&i.isPlainObject(t)&&(r=t,t=n=void 0),n&&i.isPlainObject(n)&&(r=n,n=t,t=void 0),wx.emedia.isSafari){var a=function(){try{var e=l.shift();e&&e.onSub&&e.onSub.apply(e,arguments)}finally{u()}},c=function(){try{var e=l.shift();e&&e.subfail&&e.subfail.apply(e,arguments)}finally{u()}},u=function(){l.length>0&&s.__subscribe(l[0].streamId,a,c,l[0].subArgs)},d={streamId:e,onSub:t,subfail:n,subArgs:r},l=s.__safari_subs||(s.__safari_subs=[]);l.push(d),1===l.length&&u()}else s.__subscribe(e,t,n,r)},__subscribe:function(e,t,n,r){var s=this;s.__assertCurrent(),2==arguments.length&&(n=t,t=void 0),t&&i.isPlainObject(t)&&(r=t,t=void 0),n&&i.isPlainObject(n)&&(r=n,n=void 0),r||(r={subSVideo:!0,subSAudio:!0}),s.current._cacheStreams[e];var a=s.current._getWebrtc(e),c=a&&a.isConnected(),u=c&&a.getRemoteStream();if(u&&(c=u.active)){var d=u.getAudioTracks().length,l=u.getVideoTracks().length;(d||!0!==r.subSAudio)&&(l||!0!==r.subSVideo)||(c=!1)}if(o.info("sub stream",e,", use prertcpeer =",c),c)return s.current.subscribeStream(a._rtcId,e,n,r,t),void(t&&t());a&&!a.closed&&s.current.closeWebrtc(a.getRtcId(),!0,!1),s.current.createWebrtcAndSubscribeStream(e,{onGotRemote:function(e){t&&t(e)},onEvent:function(e){n&&n(e)}},void 0,r)},closePubstream:function(e){e.located()&&(wx.emedia.stopTracks(e._localMediaStream),wx.emedia.stopTracks(e.localStream))},hungup:function(e){var t=this.getStreamById(e);try{this._hungup(e)}finally{this.onHungup&&t&&this.onHungup(t)}},_hungup:function(e){this.__assertCurrent();var t=this.current,n=t._cacheStreams[e];n&&!n.closeReason&&n.updateAttributes({closeReason:"UserHangup"});var r=n&&n.rtcId;if(r&&(t.closeWebrtc(r),n.located()&&(1!==n.type&&n._localMediaStream&&wx.emedia.stopTracks(n._localMediaStream),n.remotePlayAudioObject&&document.body.removeChild(n.remotePlayAudioObject),t._cacheStreams[e]&&t.onRemoveStream(n),i.removeAttribute(t._cacheStreams,e),this._streamAutomators&&i.removeAttribute(this._streamAutomators,e))),n&&!n.located()){if(t._linkedStreams[n.id]&&i.removeAttribute(t._linkedStreams,n.id),o.warn("Hangeup remove from _linkedStreams. stream = ",n.id),!(n=t._cacheStreams[e]))return;n.updateAttributes({rtcId:void 0,_webrtc:void 0,mediaStream:void 0});var s=new u(n);t.onUpdateStream(s,new s.Update(s))}},postMsg:function(e){this.__assertCurrent(),this.current.postMessage(e)},postMessage:function(e,t,n,i){var o=t;"string"!=typeof t&&(t=JSON.stringify(t)),this.__assertCurrent();var r,s=this.current,c=s._linkedStreams[e];r=c&&c.owner?c.owner.id:e,t=s.newMessage({op:1003,memId:r,arg:t}),s.postMessage(t,(n||i)&&function(e){if(i&&i(e,o),0!=e.result){var c=new a.RemoteControlFail({memId:r,failed:e.result,cause:e.msg,type:"postMessage",postMessage:t});return s.onEvent(c),void(n&&n(c,o))}})},torchRemote:function(e,t,n,i){"function"==typeof t&&(i=n,n=t,t=void 0),void 0!==t&&(t=t?1:0),this.__assertCurrent();var r=this.current,s=r._linkedStreams[e];if(!s||s.located())throw o.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";var c=s.torch,u={op2:20,streamId:e,tor:t=void 0===t?s.torch?0:1:t},d=r.newMessage({op:1002,memId:s.owner.id,arg:JSON.stringify(u),_reqOps:[100206]});s.updateAttributes({torch:t}),r.postMessage(d,(function(e){if(0!=e.result){var t=new a.RemoteControlFail({stream:s,failed:e.result,cause:e.msg,type:"torch_control"});return r.onEvent(t),s.updateAttributes({torch:c}),void(i&&i(t,s.torch))}n&&n(s.torch)}))},freezeFrameRemote:function(e,t,n){this.__assertCurrent();var i=this.current,r=i._linkedStreams[e];if(!r||r.located())throw o.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";var s=!r.freezeFrame,c={op2:20,streamId:e,frz:s?1:0},u=i.newMessage({op:1002,memId:r.owner.id,arg:JSON.stringify(c),_reqOps:[100204]});r.updateAttributes({freezeFrame:s}),i.postMessage(u,(function(e){if(0!=e.result){var o=new a.RemoteControlFail({stream:r,failed:e.result,cause:e.msg,type:"freeze_control"});return i.onEvent(o),r.updateAttributes({freezeFrame:!r.freezeFrame}),void(n&&n(o,r.freezeFrame))}t&&t(r.freezeFrame)}))},base64Img2Blob:function(e){for(var t=e.split(";base64,"),n=t[0].split(":")[1],i=wx.atob(t[1]),o=i.length,r=new Uint8Array(o),s=0;s<o;++s)r[s]=i.charCodeAt(s);return new Blob([r],{type:n})},blob2URL:function(e){return URL.createObjectURL(e)},imagesPngContext2URL:function(e){return this.blob2URL(this.blob2URL(e))},downloadFile:function(e,t,n){var i=document.createElement("a");i.style.display="none";var o,r=t?this.base64Img2Blob(t):n;i.download=e,i.href=o=this.blob2URL(r),i.rel="noopener";var s=document.createEvent("HTMLEvents");s.initEvent("click",!1,!1),i.dispatchEvent(s),document.body.appendChild(i),i.click(),i.parentNode.removeChild(i),setTimeout((function(){URL.revokeObjectURL&&URL.revokeObjectURL(o)}),4e4)},videoCaptureBase64Context2URL:function(e){return this.imagesPngContext2URL(this.getCaptureBase64Context(e))},getCaptureBase64Context:function(e){var t=document.createElement("canvas");return t.id="__capture_video_"+(new Date).getTime(),t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height),t.toDataURL("images/png")},captureVideo:function(e,t,n){var i=this.getCaptureBase64Context(e);return t&&(n=n||"capture_"+(new Date).getTime(),this.downloadFile(n,i)),i},capturePictureRemote:function(e,t,n,i){this.__assertCurrent();var r=this.current,s=r._linkedStreams[e];if(!s||s.located())throw o.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";var c={op2:20,streamId:e,pic:1,rspBase64Pic:!0===t},u=r.newMessage({op:1002,memId:s.owner.id,arg:JSON.stringify(c),_reqOps:[100205]});r.postMessage(u,(function(e){if(0!=e.result){var o=new a.RemoteControlFail({stream:s,failed:e.result,cause:e.msg,type:"capture_control"});return r.onEvent(o),void(i&&i(o))}if(t)if(e.arg){var c=JSON.parse(e.arg);n&&n(c.pic)}else i&&i(new a.RemoteControlFail({stream:s,failed:e.result,cause:"Not found base64 pic"}));else n&&n()}))},zoomRemote:function(e,t,n,i){this.__assertCurrent();var r=this.current,s=r._linkedStreams[e];if(!s||s.located())throw o.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";s._zoom||s.updateAttributes({_zoom:1});var c=s._zoom*t;if(!(c<1)){s.updateAttributes({_zoom:c});var u={op2:20,streamId:e,zoom:Math.round(1e4*c)},d=r.newMessage({op:1002,memId:s.owner.id,arg:JSON.stringify(u),_reqOps:[100201]});r.postMessage(d,(function(e){if(0!=e.result){var t=new a.RemoteControlFail({stream:s,failed:e.result,cause:e.msg,type:"zoom_control"});return r.onEvent(t),void(n&&n(t))}i&&i()}))}},_getPosition:function(e){for(var t=0,n=0;e;)n+=e.offsetLeft,t+=e.offsetTop,e=e.offsetParent;return{clientX:n,clientY:t}},eventXYAtMedia:function(e,t){var n=i.getDomPageRect(t),o=n.width,r=n.height,s=t.videoWidth,a=t.videoHeight;if(a/s>r/o){var c=s/a;s=(a=r)*c}else c=a/s,a=(s=o)*c;var u,d,l=e;if((u=i.isFloat(l.x))&&(l.x=l.x*o),(d=i.isFloat(l.y))&&(l.y=l.y*r),!(Math.abs(l.x)<(o-s)/2||o-Math.abs(l.x)<(o-s)/2||Math.abs(l.y)<(r-a)/2||r-Math.abs(l.y)<(r-a)/2))return l.x=l.x<0?Math.floor(l.x+(o-s)/2):Math.floor(l.x-(o-s)/2),l.y=l.y<0?Math.floor(l.y+(r-a)/2):Math.floor(l.y-(r-a)/2),u&&(l.x=l.x/s),d&&(l.y=l.y/a),{x:l.x,y:l.y,width:s,height:a}},eventXYAtVideo:function(e,t){var n,o,r=i.getDomPageRect(t),s=r.width,a=r.height,c=t.videoWidth,u=t.videoHeight;if(u/c>a/s){var d=c/u;c=(u=a)*d}else d=u/c,u=(c=s)*d;return(n=i.isFloat(e.x))&&(e.x=e.x*c),(o=i.isFloat(e.y))&&(e.y=e.y*u),e.x=e.x<0?Math.floor(e.x-(s-c)/2):Math.floor(e.x+(s-c)/2),e.y=e.y<0?Math.floor(e.y-(a-u)/2):Math.floor(e.y+(a-u)/2),n&&(e.x=e.x/s),o&&(e.y=e.y/a),e},getClickXY:function(e,t){var n=t||wx.event,i=document.documentElement.scrollLeft||document.body.scrollLeft,r=document.documentElement.scrollTop||document.body.scrollTop,s=n.pageX||n.clientX+i,a=n.pageY||n.clientY+r,c=this._getPosition(e);o.info("Video tag position ",c.clientX,":",c.clientY);var u=e.videoWidth,d=e.videoHeight;if(d/u>e.offsetHeight/e.offsetWidth){var l=u/d;u=(d=e.offsetHeight)*l,c.clientX+=(e.offsetWidth-u)/2}else l=d/u,d=(u=e.offsetWidth)*l,c.clientY+=(e.offsetHeight-d)/2;return o.info("Media position ",c.clientX,":",c.clientY),o.info("Media xy ",u,":",d),o.info("Click position ",s,":",a),{mediaWidth:u,mediaHeight:d,x:s-c.clientX,y:a-c.clientY}},focusExpoRemote:function(e,t,n,i,r){var s=n||wx.event,a=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,u=s.pageX||s.clientX+a,d=s.pageY||s.clientY+c,l=this._getPosition(t);o.info("Video tag position ",l.clientX,":",l.clientY);var f=t.videoWidth,p=t.videoHeight;if(p/f>t.offsetHeight/t.offsetWidth){var h=f/p;f=(p=t.offsetHeight)*h,l.clientX+=(t.offsetWidth-f)/2}else h=p/f,p=(f=t.offsetWidth)*h,l.clientY+=(t.offsetHeight-p)/2;o.info("Media position ",l.clientX,":",l.clientY),o.info("Media xy ",f,":",p),o.info("Click position ",u,":",d),this._focusExpo(e,f,p,u-l.clientX,d-l.clientY,i,r)},_focusExpo:function(e,t,n,i,r,s,c){if(!(i<=0||i>t||r<=0||r>n)){this.__assertCurrent();var u=this.current,d=u._linkedStreams[e];if(!d||d.located())throw o.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";var l={op2:20,streamId:e,focus:1,expo:1,x:0===t?0:Math.round(1e4*i/t),y:0===n?0:Math.round(1e4*r/n)},f=u.newMessage({op:1002,memId:d.owner.id,arg:JSON.stringify(l),_reqOps:[100202,100203]});u.postMessage(f,(function(e){if(0!=e.result){var t=new a.RemoteControlFail({stream:d,failed:e.result,cause:e.msg,type:"focus_expo_control"});return u.onEvent(t),void(s&&s(t))}c&&c()}))}},_republish:function(e,t,n){o.info("Republish stream. it = ",e.id);var i,r,s=this;if(e.id){var a=s.current.__getWebrtcFor(e.id);a&&s.current.closeWebrtc(a,!0),i=s.current._getWebrtc(e.id)}switch(e.type){case 0:wx.emedia.stopTracks(e._localMediaStream),r=new s.AVPubstream(e);break;case 1:wx.emedia.stopAndRemoveAudioTracks(e._localMediaStream),r=new s.ShareDesktopPubstream(e);break;case 2:wx.emedia.stopTracks(e._localMediaStream),r=new s.AudioMixerPubstream(e)}setTimeout((function(){s.openUserMedia(r).then((function(){e.localStream=r.localStream,e.isRepublished=!0,e.optimalVideoCodecs=e.optimalVideoCodecs||i&&i.optimalVideoCodecs,s.push(e,t,n)}),n)}),100)},chanageCamera:function(e,t,n){var r=this;"string"==typeof e?e=r.current._cacheStreams[e]:e.id&&(e=r.current._cacheStreams[e.id]),e.voff?o.warn("Stream id = ",e.id," voff, do not chanage camera."):r.getMediaDevices("videoinput",(function(s){if(s.length<=1)o.warn("Only video input. not chanage");else{var a=e._cameraIndex;if(null===e._cameraIndex||void 0===e._cameraIndex){var c=e.getLocalMediaStream(),u=(p=c&&c.getVideoTracks())&&p.length&&p[0];if(u&&u.getCapabilities&&"function"==typeof u.getCapabilities){var d=u.getCapabilities(),l=d&&d.deviceId;for(var f in s)if((m=s[f]).deviceId===l||m.label==u.label){a=parseInt(f);break}}else for(var f in s)if((m=s[f]).label==u.label){a=parseInt(f);break}}for(;a<s.length;){var p,h=s[a],m=s[a=(a+1)%s.length];if(!(p=e.getLocalMediaStream().getVideoTracks())||0===p.length||m.label!=p[0].label)break}var g=(m=s[a]).label;o.warn("Stream ",e.id,h.label,">>",g),e._cameraIndex=a,e.constaints||(e.constaints={});var _=i.extend({},e.constaints);e._lastConstaints=_,e.constaints.video="object"==typeof e.constaints.video?e.constaints.video:{},e.constaints.video.deviceId={exact:m.deviceId},r._republish(e,(function(e){n&&n(e)}),(function(n){n instanceof wx.emedia.event.OpenMediaError&&(e.constaints=_),t&&t(n)}))}}),t)},voff:function(e,t,n,i){var r=this;"string"==typeof e&&(e=r.current._cacheStreams[e]);var s=e.voff;function a(){t!=s?(wx.emedia.enableVideoTracks(e.getMediaStream(),!t),r.current&&r.current.voff(e,t)):o.info("pubstream voff not chanage.")}if(t=t?1:0,e.voff=t,!t&&e.constaints&&!e.constaints.video){var c=e.constaints.video;return e.constaints.video=!0,void r._republish(e,(function(e){a(),i&&i(e)}),(function(t){t instanceof wx.emedia.event.OpenMediaError&&(e.constaints.video=c,e.voff=s),n&&n(t)}))}a(),i&&i(e.getMediaStream())},aoff:function(e,t,n,i){var r=this;"string"==typeof e&&(e=r.current._cacheStreams[e]);var s=e.aoff;function a(){t!=s?(wx.emedia.enableAudioTracks(e.getMediaStream(),!t),r.current&&r.current.aoff(e,t)):o.info("pubstream aoff not chanage.")}if(t=t?1:0,e.aoff=t,!t&&e.constaints&&!e.constaints.audio){var c=e.constaints.audio;return e.constaints.audio=!0,void r._republish(e,(function(e){a(),i&&i(e)}),(function(t){t instanceof wx.emedia.event.OpenMediaError&&(e.constaints.audio=c,e.aoff=s),n&&n(t)}))}a(),i&&i(e.getMediaStream())},iceing:function(e){return i.isPlainObject(this.current._linkedStreams[e])},recording:function(e){return i.isPlainObject(this.current._records[e])},startRecord:function(e,t){var n=this.current._linkedStreams[e];if(!n)throw o.error("not at linked streams",e),e+" not at linked streams";n._webrtc||t&&t(!1),this.current.startRecord(n,t)},stopRecord:function(e,t){var n=this.current._records[e];if(!n)throw o.error("not at recording streams",e),e+" not at recording streams";this.current.stopRecord(n,t)},getCurrentMembers:function(){return this.current.getCurrentMembers()},_onCapturePicture:function(e){var t,n=e.arg.rspBase64Pic,i=e.arg.streamId,r=this.current._cacheStreams[i];if(n){var s;if("function"!=typeof this.getHTMLVideo||!(s=this.getHTMLVideo(i)))return void o.warn("Not support capture picture. caused by htmlVideo not found");t=this.getCaptureBase64Context(s)}else{if("function"!=typeof this.onCapturePicture)return void o.warn("Not support capture picture. caused by onCapturePicture not found");this.onCapturePicture(r)}var a=this.current.newMessage({op:1001,tsxId:e.tsxId,memId:e.memId,arg:JSON.stringify(t?{pic:t}:{}),result:0});return this.current.postMessage(a,(function(e){o.warn("Send remote control onCapturePicture response. the result = ",e.result,e.msg||"")})),!0},newSession:function(e,t){var n=this;return new(n.Session||r)({ticket:t,owner:e,onReconnect:function(t,n){e.onReconnect(t,n.tkt)},onTcklC:function(t){e.onTcklC(t.rtcId,t.cands)},onAcptC:function(t){e.onAcptC(t.rtcId,t.sdp,t.cands)},onAnsC:function(t){e.onAnsC(t.rtcId,t.sdp,t.cands)},onTermC:function(t){o.info("Server termc rtc: ",t.rtcId,t.message||t.msg),21===t.endReason||22===t.endReason?i.forEach(e._cacheStreams,(function(n,i){var o;i.rtcId===t.rtcId&&(o=21===t.endReason?new wx.emedia.event.SwitchVCodes({stream:i,useVCodes:t.useVCodes}):new wx.emedia.event.SubFailNotSupportVCodes({stream:i}),e.onEvent(o))})):e.closeWebrtc(t.rtcId,!1,!0)},onEnter:function(t){e.onEnter(t.cver,t.mem)},onExit:function(t){e.onExit(t.cver,t.memId,t.reason||0)},onPub:function(t){e.onPub(t.cver,t.memId,t.pubS)},onUnpub:function(t){e.onUnpub(t.cver,t.memId,t.pubSId)},onMems:function(e){},onClose:function(t){e.onClose(t.cver,t.confrId)},onEvent:function(t){e.onEvent(t)},onStreamControl:function(t){e.onStreamControl(t.cver,t.streamId,t.voff,t.aoff,t.sver)},onRoleUpdate:function(t){e._onRoleUpdate(t.role,t.roleToken)},onRemoteControl:function(t){if("string"==typeof t.arg&&(t.arg=JSON.parse(t.arg)),20!==t.arg.op2||!t.arg.pic||!n._onCapturePicture.call(n,t)){if(30===t.arg.op2&&n._onRemotePannelControl)try{return void n._onRemotePannelControl.call(n,t)}catch(e){o.warn(e)}o.warn("Not support remote control");var i=e.newMessage({op:1001,tsxId:t.tsxId,memId:t.memId,arg:JSON.stringify(t.arg),result:t&&t.arg&&30===t.arg.op2?-405:-507,msg:"Not support the remote control."});e.postMessage(i,(function(e){o.warn("Send remote control response. the result = ",e.result,e.msg||"")}))}},onRecvRemoteMessage:function(t){e._onRecvRemoteMessage&&e._onRecvRemoteMessage(t.memId,t.arg,t)},onConfrAttrsUpdated:function(t){var n=e.catrrs;n||(n=[]),n=t.cattrs instanceof Array==1?function(e,t){return 0==t.length||t.forEach((function(t){var n=!1;e.forEach((function(i,o){if(i.key==t.key)return e.splice(o,1,t),void(n=!0)})),n||e.push(t)})),e}(n,t.cattrs):function(e){var t=[];for(var n in e){var i={};i.key=n,i.val=e[n],i.op="",t.push(i)}return t}(t.cattrs),e.catrrs=n;var i=e._onConfrAttrsUpdated;i&&"function"==typeof i&&i(n)}})},_judgeTalking:function(e){return!!e&&e.instant>=wx.emedia.config.judgeTalkingByInstantGE},graffitiVideo:function(e,t,n){var i=this.getStreamById(e),o=new MediaStream;o._located=!0,i._localMediaStream.getAudioTracks().forEach((function(e){o.addTrack(e)})),n.captureStream(25).getVideoTracks().forEach((function(e){o.addTrack(e)})),t.srcObject=o,i.updateAttributes({localStream:o,isRepublished:!0,optimalVideoCodecs:i.optimalVideoCodecs}),this.push(i)},resetCanvas:function(e){var t;if(arguments.length>1)for(var n=0;n<arguments.length;n++)"function"==typeof(t=arguments[n])&&t(e),"function"!=typeof t&&i.isPlainObject(t)&&i.forEach(t,(function(t,n){o.debug("Canvas set ",t," = ",n),e.setAttribute(t,n)}))},_random:function(e){return Math.floor(Math.random()*e)},requestFrame:function(e,t){var n,i=this;if("string"==typeof e)n=this.current._cacheStreams[e];else{if(!e.id)return;n=this.current._cacheStreams[e.id]}function o(){n.requestFrame()}n&&(t?setTimeout((function(){o(),i.requestFrame(n,t)}),t):o())},graffitiCanvas:function(e,t){i.targetDOM(e)&&(t=e,e=!1);var n=this,o=new n.ShareDesktopPubstream({voff:0,aoff:e?0:1});t||(t=document.createElement("canvas")),t.getContext("2d"),o.canvas=t;var r=function(){};return r.prototype.setCanvas=function(e){return this.canvasTag=t,n.resetCanvas(t,e),this},r.prototype.push=function(e,t){this._push(e,t)},r.prototype._push=function(i,r){"function"==typeof i&&(r=i,i=void 0),t.captureStream&&(t.captureStream.enabled=!0);var s=t.captureStream(i||25);function a(n){n.canvas=t,r&&r(n,t,s),e&&n.requestFrame()}function c(e,t){var i=new MediaStream;i._located=!0,e._localMediaStream&&e._localMediaStream.getAudioTracks().forEach((function(e){i.addTrack(e)})),s.getVideoTracks().forEach((function(e){i.addTrack(e)})),e._localMediaStream=i,e.localStream=i,n.push(e,t)}return e?n.__getUserMedia({audio:!0},(function(e,t){o._localMediaStream=t,c(o,a)})):c(o,a),this},new r},blobRecorder:function(e,t,n,r){var s=this;i.targetDOM(e)&&(e=e.srcObject),t||(t={mimeType:"video/webm;codecs=vp9"}),MediaRecorder.isTypeSupported(t.mimeType)||(o.info(t.mimeType," is not Supported"),t={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(t.mimeType)||(o.info(t.mimeType," is not Supported"),t={mimeType:"video/webm"},MediaRecorder.isTypeSupported(t.mimeType)||(o.info(t.mimeType," is not Supported"),t={mimeType:""})));try{var a=new MediaRecorder(e,t)}catch(e){return void o.error("Exception while creating MediaRecorder: ",e)}var c=[];function u(){this.blobs=c}return a.onstop=r||function(e){o.info("Recorder stopped: ",e)},a.ondataavailable=n||function(e){e.data&&e.data.size>0&&c.push(e.data)},u.prototype.start=function(e){a.start(e)},u.prototype.stop=function(){a.stop()},u.prototype.playurl=function(e){var t=new Blob(this.blobs,e||{type:"video/webm"});return wx.URL.createObjectURL(t)},u.prototype.download=function(e,t){var n=new Blob(this.blobs,t||{type:"video/webm"});s.downloadFile(e,void 0,n)},new u}})},function(e,t,n){var i=n(0),o=i.tagLogger("Sess"),r=n(1),s=n(2),a=0,c=i.prototypeExtend({setSessId:function(e){return e&&(this.sessId=e),this},setOp:function(e){if(e&&(this.op=e),200===e){var t=wx.emedia.config.useUniappPlugin;this.res={type:t?"UNIAPP":"MINI_PROGRAM",ver:"3.2.2",platVersion:wx._emediaVersion||wx.emedia.config.version,agent:"v2.7.0",ops:wx.emedia.config.acptOps}}return this},setTsxId:function(e){return e&&(this.tsxId=e),this},setTicket:function(e){return e&&(this.tkt=e),this},setSdp:function(e){return e&&(this.sdp=e),this},setCands:function(e){return e&&(this.cands=e),this},setSubSId:function(e){return e&&(this.subSId=e),this},setMemId:function(e){return e&&(this.memId=e),this},setPubS:function(e){e&&(this.pubS=i.extend(!1,{},e));var t=this.pubS;return t.ext&&i.isPlainObject(t.ext)&&(t.ext=JSON.stringify(t.ext)),t&&i.forEach(t,(function(e,n){(i.isPlainObject(n)||"function"==typeof n)&&i.removeAttribute(t,e)})),t&&i.removeAttribute(t,"localStream"),t&&i.removeAttribute(t,"_localMediaStream"),t&&i.removeAttribute(t,"_webrtc"),this},setRtcId:function(e){return e&&(this.rtcId=e),this},setCver:function(e){return e&&(this.cver=e),this},setEndReason:function(e){return e&&(this.endReason=e),this},setNickName:function(e){return e&&(this.nickName=e),this},setResource:function(e){return e&&(this.resource=e),this},setReason:function(e){return e&&(this.reason=e),this},setConfrId:function(e){return e&&(this.confrId=e),this},setVoff:function(e){return void 0===e||(this.voff=e?1:0),this},setAoff:function(e){return void 0===e||(this.aoff=e?1:0),this},setFlag:function(e){return 0===e&&(this.flag=0),1===e&&(this.flag=1),this},setExt:function(e){return e&&i.isPlainObject(e)&&(e=JSON.stringify(e)),e&&(this.ext=e),this}}),u=wx.emedia.__session_globalCount=0;function d(e,t,n){var s=this;function a(e,i){try{s.onWebsocketEvent(new r.WSClose({url:s.thisWsUri,retry:n,online:s.online,cause:e,event:i,session:s}))}finally{t&&t(new r.WSClose({url:s.thisWsUri,retry:n,online:s.online,cause:e,event:i,session:s}))}}function c(e){if(s.connected(s.thisWsUri))if(s.sessId&&e.sessId!=s.sessId)o.warn("self.sessId && message.sessId != self.sessId",e);else{var t=JSON.stringify(e);__f__("log","sdk \u53d1\u9001\u4fe1\u4ee4\u6210\u529f",e," at emediaSDK/emedia_for_miniProgram.js:3"),s._websocket.send({data:t})}else o.debug("current dont connect. the message = ",e)}s.notifyNewMessage=function(){if(s.connected(s.thisWsUri)){if(0===s._bufferedMessages.length)return;for(var e,t=[];e=s._bufferedMessages.shift();)if(e.sessId||s.sessId||200==e.op){if(200===e.op){c(e);break}s.sessId&&!e.sessId&&(e.sessId=s.sessId);var r=c(e);r&&t.push(r)}else t.push(e),o.warn("tmp store message, util enter success!",e);t.length>0&&Array.prototype.push.apply(s._bufferedMessages,t)}else if(0!==n&&s.online)s.connected();else{var a=i.extend(!1,{},s._callbacks),u=[];for(var d in a){var l=a[d];n>0&&!s.online?u.push(l):s.onMessage({op:1001,tsxId:d,result:-9527,msg:"sdk rsp fail. retry fail or online = "+s.online})}s._bufferedMessages=s._bufferedMessages||[],u.length>0&&Array.prototype.push.apply(s._bufferedMessages,u)}},o.info("Session begin connect.");var u=s._websocket;u&&(o.warn("will close. websocket state",u.readyState,u.url,s.thisWsUri),u.close({code:1e3}));try{o.info("Connecting",s.thisWsUri,n),u=s._websocket=wx.connectSocket({url:s.thisWsUri,success:function(){},fail:function(e){}})}catch(e){return o.warn(e),void a(e)}u.onOpen((function(n){var i=this.url;try{o.info("websocket connected:",i),t&&(t=null),e&&e(s)}finally{}})),u.onMessage((function(e){o.debug("recv data",e.data);var t=JSON.parse(e.data);t&&1001==t.op&&o.debug("recv message: rsp:",t),t&&1001!=t.op&&o.debug("recv message: evt:",t),s.onMessage(t)})),u.onClose((function(e){var t=this.url;o.info("Disconnected:",t,s.thisWsUri,e),t===s.thisWsUri?(s.notifyNewMessage(),1e3!==e.code&&a(void 0,e)):o.warn("ignore onclose. caused by websocket url not ",s.thisWsUri,t)})),u.onError((function(e){o.info("On error:",e),a&&a(e),s.onWebsocketEvent(new r.WSError({event:e,online:s.online,session:s,url:this.url}))}))}e.exports=i.prototypeExtend({_events:{0:"onReqP2P",1:"onNewCfr",2:"onDelCfr",3:"onReqTkt",100:"onPing",101:"onPong",102:"onInitC",104:"onAcptC",105:"onTcklC",106:"onAnsC",107:"onTermC",300:"onEnter",301:"onExit",302:"onPub",303:"onUnpub",304:"onMems",204:"onClose",400:"onStreamControl",401:"onJoin",412:"onRoleUpdate",1002:"onRemoteControl",1003:"onRecvRemoteMessage",402:"onConfrAttrsUpdated"},__init__:function(){var e=this;e._bufferedMessages=[],e._callbacks={},e.online=!0,wx.onNetworkStatusChange((function(t){t.isConnected?(e.online=!0,o.warn("online online online"),e.closed||e._reconnect(wx.emedia.config.reconnect)):(e.online=!1,o.warn("offline offline offline"),e.__checkConnectIntervalId&&clearTimeout(e.__checkConnectIntervalId),e.__retryConnectIntervalId&&clearTimeout(e.__retryConnectIntervalId),e.__retryConnectIntervalId&&delete e.__retryConnectIntervalId,e._websocket&&e._websocket.close(1e3))})),o.info("online status = ",e.online)},_nextWsUri:function(){var e=this.ticket.url||"";if("function"==typeof wx.emedia.convertWebsocketURLOfTicket){var t=e;e=wx.emedia.convertWebsocketURLOfTicket(e),o.warn(t,"--\x3e",e)}return e.indexOf("?")>=0?e+="&"+a++:e+="?"+a++,this.ticket.confrId&&(e+="&"+encodeURIComponent(this.ticket.confrId)),e},_reconnect:function(e){var t=this;function n(){o.warn("Reconnected. at ",e,t._websocket.url),t.__retryConnectIntervalId&&clearTimeout(t.__retryConnectIntervalId),t.__retryConnectIntervalId&&delete t.__retryConnectIntervalId;var n=t.newMessage().setOp(200).setSessId(t._sessionId).setTicket(t.ticket).setNickName(t.nickName||t.ticket.memName).setResource(t.resource).setExt(t.owner.ext);t.postMessage(n,(function(e){if(0==e.result)t.onEvent(new r.EnterSuccess({ip:t.owner.ip})),__f__("log","Session _reconnect"," at emediaSDK/emedia_for_miniProgram.js:3");else try{t.onEvent(new r.EnterFail({me:t.owner,cause:new r.RspFail({request:n,response:e})}))}finally{-9527!==e.result&&t.onEvent(new r.ServerRefuseEnter({failed:e.result,msg:e.msg}))}}))}t.connect(n,(function i(r){if(e<=0)return o.warn("Reconnect end. but fail.",r.url,e),void(t.__retryConnectIntervalId&&delete t.__retryConnectIntervalId);e&&(t.__retryConnectIntervalId=setTimeout((function(){t.connect(n,i,--e)}),wx.emedia.config.reconnectDelay))}),--e)},__checkConnect:function(){var e=this;e.__checkConnectIntervalId&&clearTimeout(e.__checkConnectIntervalId),wx.emedia.config.checkConnectIntervalMillis&&(e.__checkConnectIntervalId=setTimeout((function(){try{e.online&&!e.connected()&&(e.__retryConnectIntervalId&&o.debug("online, reconnecting..."),e.__retryConnectIntervalId||o.debug("online, but disconnect. will reconnect"),e.__retryConnectIntervalId||e._reconnect(wx.emedia.config.reconnect))}finally{e.__checkConnect()}}),wx.emedia.config.checkConnectIntervalMillis))},connect:function(e,t,n){var i=this,s=i.thisWsUri=i._nextWsUri();void 0!==n&&o.warn("begin connect... at retry = ",n,s),d.call(i,(function(){try{e.apply(i,arguments)}finally{i.__checkConnect()}}),(function(e){try{t.apply(i,arguments)}finally{n||e.url!==s||i.onEvent(new r.ServerRefuseEnter({failed:-95270,msg:"sdk reconnect fail. "+s+"|"+e.url}))}}),n)},connected:function(e){return this.online&&this._websocket},onWebsocketEvent:function(e){this.onEvent(e)},register:function(e){if("object"==typeof e)for(var t in e)this.bind(t,e[t])},bind:function(e,t){var n;if(!(n=this._events[e]))throw o.error("Not supported event = ",e),"Not supported event = "+e;this[n]=t},getSessionId:function(){return this._sessionId},newMessage:function(e){return new c(e)},__modifyMessage:function(e){return e},onMessage:function(e){var t=this;function n(e){var n,i=e.op;(n=t._events[i])&&(n=t[n])?n.call(t,e):o.warn("Not supported event = ",e)}if(__f__("log","servMessage.op",e.op," at emediaSDK/emedia_for_miniProgram.js:3"),__f__("log","servMessage",e," at emediaSDK/emedia_for_miniProgram.js:3"),102!==e.op&&104!==e.op&&105!==e.op&&106!==e.op&&107!==e.op||s.onSignallingData(e),1001===e.op&&e.useUrl||1001===e.op&&e.rtcCfg){this.useUrl=e.useUrl,t.sessId=e.sessId;var a=t.ticket.memName;s._videos.useUrl=e.useUrl;var c={role:e.role,memName:a,name:a,nickName:a,vcodes:e.vcodes,rtcCfg:e.rtcCfg,id:e.memId,isSelf:!0,sessId:e.sessId};t.onEnter.call(t,{mem:c})}if(1001!=e.op&&!e.sessId)throw o.error("message sessId error. server evt data error"),"message sessId error. server evt data error";if(1001!=e.op&&t._sessionId&&t._sessionId!=e.sessId)throw o.error("message sessId error. server and local not equal"),"message sessId error. server and local not equal";if(1004!==e.op){var u;e=t.__modifyMessage(e);var d=i.removeAttribute(t._callbacks,e.tsxId);if(d&&200===d.op){t._sessionId=e.sessId;var l="string"==typeof e.yourIp?e.yourIp:void 0;if("string"==typeof t._session_ip&&l!=t._session_ip&&(u=t._session_ip),o.info(t._sessionId,"ip is",l,u),t._session_ip=l,t.owner.ip=l,0===e.result){for(var f in t._bufferedMessages){var p=t._bufferedMessages[f];p.sessId||200===p.op||(p.sessId=e.sessId)}setTimeout((function(){t.notifyNewMessage()}),100)}else for(var h;h=t._bufferedMessages.shift();)200!==h.op&&t.onMessage({op:1001,tsxId:h.tsxId,result:-9527,msg:"sdk enter fail. sdk callback. enter result = "+e.result})}if(t.owner&&t.owner.closed)o.warn("self closed. me is "+t.owner.getMemberId()+", session_id = "+t.getSessionId()+". drop message",e);else{if(t.onEvent(new r.RecvResponse({request:d,response:e})),d&&d.__callback__&&1004!==e.op)return d.__callback__(e),void(u&&t.onWebsocketEvent(new r.NetworkChanaged({preIp:u,nowIp:t._session_ip})));e.op&&1001!=e.op?(n(e),u&&t.onWebsocketEvent(new r.NetworkChanaged({preIp:u,nowIp:t._session_ip}))):o.debug("Igron message. caused by op not found.",e)}}else n(e)},__modifyMessageForPost:function(e){return e},postMessage:function(e,t,n){var r=this;if(e.tsxId||(e.tsxId="MSG"+Date.now()+"-"+u++),e.memId){var s=r.owner._cacheMembers[e.memId];if(!s)return o.warn("Member not found at local. memberId = "+e.memId,e),void(t&&t({op:1001,tsxId:e.tsxId,result:-507,msg:" member not found at local. memberId = "+e.memId}));var a=e._reqOps;for(var c in a||(a=[]).push(e.op),a){var d=a[c];if(!s.acptOps[d])return o.warn("Member not accept op "+d+", "+e.memId,e),void(t&&t({op:1001,tsxId:e.tsxId,result:-507,msg:" member not accept op "+d+", "+e.memId}))}}if(i.removeAttribute(e,"_reqOps"),r._sessionId&&r._sessionId!=e.sessId)return o.warn("sessionId not excepted. self._sessionId = "+r._sessionId,e),void(t&&t({op:1001,tsxId:e.tsxId,result:-9527,msg:"sessionId not excepted."}));if(r.closed)return o.warn("session closed.",e),void(t&&t({op:1001,tsxId:e.tsxId,result:-9527,msg:"session closed"}));var l=i.extend({},e);if(!(e=r.__modifyMessageForPost(e)))return o.warn("Message drop. callback success.",e),void(t&&t({op:1001,tsxId:l.tsxId,result:0,msg:"Message drop. callback success."}));200===e.op?(r._bufferedMessages.unshift(e),t&&setTimeout((function(){r._callbacks[e.tsxId]&&(o.error("Enter timeout. fail."),r.onMessage({op:1001,tsxId:e.tsxId,result:-9527,msg:"enter timeout. millis = "+wx.emedia.config.enterTimeout}))}),wx.emedia.config.enterTimeout||2e3)):r._bufferedMessages.push(e),t&&(r._callbacks[e.tsxId]=i.extend(e,{__callback__:t.bind(r.owner)})),r.notifyNewMessage&&r.notifyNewMessage(),n&&t&&setTimeout((function(){var e=r._callbacks[e.tsxId];e&&e.__callback__&&e.__callback__({op:1001,tsxId:l.tsxId,result:-408,msg:"Message request timeout."}),i.removeAttribute(r._callbacks,e.tsxId)}),n)},close:function(e){o.warn("sessiong closing, reason = ",e),this.notifyNewMessage&&this.notifyNewMessage(),this.closed=!0,this.seqno=0,this._websocket&&(0==e||100==e?this._websocket.close(1e3):this._websocket.close()),this.__retryConnectIntervalId&&clearTimeout(this.__retryConnectIntervalId),this.__retryConnectIntervalId&&delete this.__retryConnectIntervalId,this.__checkConnectIntervalId&&clearTimeout(this.__checkConnectIntervalId),this.__checkConnectIntervalId&&delete this.__checkConnectIntervalId,this.owner=null,this._bufferedMessages=[],this._callbacks={},o.warn("session closed")}})},function(e,t,n){var i=n(0),o=i.tagLogger("Me"),r=n(9),s=n(1),a=n(4),c=n(2),u=r.extend({__init__:function(){if(this._session||this.sessionFactory&&(this._session=this.sessionFactory()),!this._session)throw o.error("Require session"),"Require session";this._cver=0,this._cacheMembers={},this._cacheStreams={},this._streamAutomators={},this._mediaMeters={},this._openedRtcMediaStreams={},this._linkedStreams={},this._maybeNotExistStreams={},this._records={},this._ices={},this.audioMixers={},this.closed=!1,this._nextStreamSeqno=0,this.cattrs=c.cattrs,this.getMediaMeterIntervalMillis=this.getMediaMeterIntervalMillis||wx.emedia.config.getMediaMeterIntervalMillis},getCurrentMembers:function(){var e=[];return i.forEach(this._cacheMembers,(function(t,n){var o=i.extend(!0,{},n);e.push(o)})),e},newStream:function(e){var t=this;return new a(e,{__init__:function(){if(this.rtcId||this._webrtc&&(this.rtcId=this._webrtc.getRtcId()),this._webrtc||this.rtcId&&(this._webrtc=t._ices[this.rtcId]),this.__create_id=t._nextStreamSeqno++,this.memId&&!this.owner&&(this.owner=i.extend({},t._cacheMembers[this.memId]),!this.owner&&!this.located()))throw o.error("Remote stream, not owner. it = ",this.id),"Remote stream, not owner. it = "+this.id}})},getConfrId:function(){return this.ticket.confrId},isCaller:function(){return this.isP2P()&&this.ticket.caller==this.ticket.memName},isCallee:function(){return this.isP2P()&&this.ticket.callee==this.ticket.memName},isP2P:function(){return this.ticket&&("P2P"==this.ticket.type||"p2p"==this.ticket.type)},isConfr:function(){return this.ticket&&("CONFR"==this.ticket.type||"confr"==this.ticket.type)},onEvent:function(e){},join:function(e,t){var n=this;wx.emedia.requireTrustBeforeJoin()?n.someBrowsersRequireGetUserMedia((function(){n._join(e,t)}),t):n._join(e,t)},_join:function(e,t){o.debug("begin join ...");var n,i=this;if(i._memberId)return o.warn("Had joined. igrone it"),void(e&&e(i.memId));function r(e){try{if(e instanceof s.WSClose&&e.retry)return;e instanceof s.EnterFail||(e=new s.EnterFail({attendee:i,cause:e})),i.onEvent(e),t&&t(e)}finally{}}function a(t){if(0==t.result){i.reflushSupportVCodes(t.vcodes),i.setMemberId(t.memId),i.role=t.role,i.onEvent(new s.EnterSuccess({ip:i.ip})),e&&e(t.memId);try{i.__rtc_cfg=t.rtcCfg,"string"==typeof t.rtcCfg&&(i.__rtc_cfg=JSON.parse(t.rtcCfg))}finally{i.onMembers(t.cver,t.mems),i.onStreams(t.cver,t.streams)}}else try{r(new s.RspFail({request:n,response:t}))}finally{-9527!==t.result&&i.onEvent(new s.ServerRefuseEnter({failed:t.result,msg:t.msg}))}}i.connect((function(){__f__("log","Attendee","onConnected setOp: 200"," at emediaSDK/emedia_for_miniProgram.js:3"),n=i.newMessage().setOp(200).setTicket(i.ticket).setNickName(i.nickName||i.ticket.memName).setResource(i.resource).setExt(i.ext),i.postMessage(n,a)}),r),o.debug("join",i.ticket.url)},withpublish:function(e){var t,n=this;if(!e||!e.localStream)throw o.error("pubS null or stream not open"),"pubS null or stream not open";var i,r=e&&e.localStream;return{join:function(a,c){if(1===arguments.length&&(c=a,a=void 0),n._memberId)return o.warn("Had joined. igrone it"),void(a&&a(n.memId));function u(e){try{if(e instanceof s.WSClose&&e.retry)return;e instanceof s.EnterFail||(e=new s.EnterFail({attendee:n,cause:e})),n.onEvent(e),c&&c(e)}finally{wx.emedia.stopTracks(r),i&&n.closeWebrtc(i.getRtcId())}}var d=n.getOptimalVideoCodecs();function l(r){if(0==r.result){n.reflushSupportVCodes(r.vcodes),n.setMemberId(r.memId),n.role=r.role,n.onEvent(new s.EnterSuccess({ip:n.ip}));var c=n.newStream(e);c.updateAttributes({_localMediaStream:e.localStream,rtcId:i.getRtcId(),_webrtc:i,id:r.streamId,csrc:r.csrc,owner:{id:r.memId,nickName:n.nickName,name:n.sysUserId,ext:n.extObj},optimalVideoCodecs:d}),a&&a(r.memId,c),i.useIp=n.ip,n.onEvent(new s.PushSuccess({stream:c,hidden:!0})),r.sdp&&n.ansC(i.getRtcId(),r.sdp),r.cands&&n.tcklC(i.getRtcId(),r.cands);try{n.__rtc_cfg=r.rtcCfg,"string"==typeof r.rtcCfg&&(n.__rtc_cfg=JSON.parse(r.rtcCfg)),n.__rtc_cfg&&n.__rtc_cfg.iceServers&&n.__rtc_cfg.iceServers.length>0&&(o.warn("Server rsp one rtc cfg. publish will republish"),n._service&&setTimeout((function(){n._service._republish(c)}),200))}finally{n.onMembers(r.cver,r.mems),n.onStreams(r.cver,r.streams)}}else try{u(new s.RspFail({request:t,response:r}))}finally{-9527!==r.result&&n.onEvent(new s.ServerRefuseEnter({failed:r.result,msg:r.msg}))}}n.connect((function(){o.debug("enter and pubs");var r,s,a=e.localStream;2===e.type&&(r={offerToReceiveAudio:!0,offerToReceiveVideo:!1},s={subSVideo:!1,subSAudio:!0}),i=n.createWebrtc({_rtcId:e.rtcId,optimalVideoCodecs:d,offerOptions:r,subArgs:s,vbitrate:e.vbitrate||e.constaints&&e.constaints.video&&e.constaints.video.bitrate,abitrate:e.abitrate||e.constaints&&e.constaints.audio&&e.constaints.audio.bitrate},e.iceRebuildCount),n.setLocalStream(a,i.getRtcId()),n.doOffer(i.getRtcId(),(function(o){t=n.newMessage().setOp(200).setTicket(n.ticket).setNickName(n.nickName||n.ticket.memName).setResource(n.resource).setSdp(o).setRtcId(i.getRtcId()).setPubS(e).setExt(n.ext),n.postMessage(t,l)}))}),u),o.debug("join",n.ticket.url)}}},push:function(e,t,n,i){o.debug("begin push ...");var r,a=this;if(2===arguments.length&&(n=t,t=void 0),!e||!e.localStream)throw o.error("pubS or stream open"),"pubS or stream open";var c,u=e.localStream;function d(t){try{var o=a.newStream(e);o.updateAttributes({_localMediaStream:e.localStream,_webrtc:c,rtcId:c&&c.getRtcId(),owner:{id:a.getMemberId(),nickName:a.nickName,name:a.sysUserId,ext:a.extObj}}),t=new s.PushFail({stream:o,cause:t,hidden:i&&!0===t.hidden}),a.onEvent(t),t.hidden||n&&n(t)}finally{u&&!0!==t.hidden&&wx.emedia.stopTracks(u),c&&a.closeWebrtc(c.getRtcId(),!0===t.hidden)}}if(e.rtcId||2!==e.type||wx.emedia.config.allowRepeatAudioMixerPublish||!a._service.hasAudioMixers()){var l=e.optimalVideoCodecs||a.getOptimalVideoCodecs();p(e),o.debug("push",a.ticket.url)}else d(new s.AudioMixerStreamRepeatPublish);function f(n,i){if(0==i.result){var o=a.newStream(e);o.updateAttributes({_localMediaStream:e.localStream,_webrtc:n,rtcId:n.getRtcId(),id:i.streamId,csrc:i.csrc,owner:{id:a.getMemberId(),nickName:a.nickName,name:a.sysUserId,ext:a.extObj},optimalVideoCodecs:l}),o.id&&2===o.type&&(a.audioMixers[o.id]=o);try{a.onEvent(new s.PushSuccess({stream:o,hidden:!0}))}finally{i.sdp&&a.ansC(n.getRtcId(),i.sdp),i.cands&&a.tcklC(n.getRtcId(),i.cands),t&&t(o)}}else d(new s.RspFail({request:r,response:i,hidden:!0===i.retrying}))}function p(e){o.debug("pubs");var t,n,i=e.localStream;2===e.type&&(t={offerToReceiveAudio:!0,offerToReceiveVideo:!1},n={subSVideo:!1,subSAudio:!0}),c=a.createWebrtc({_rtcId:e.rtcId,optimalVideoCodecs:l,offerOptions:t,subArgs:n,vbitrate:e.vbitrate||e.constaints&&e.constaints.video&&e.constaints.video.bitrate,abitrate:e.abitrate||e.constaints&&e.constaints.audio&&e.constaints.audio.bitrate},e.iceRebuildCount),a.setLocalStream(i,c.getRtcId()),a.doOffer(c.getRtcId(),(function(t){r=a.newMessage().setOp(102).setRtcId(c.getRtcId()).setSdp(t).setPubS(e),a.postMessage(r,(function(e){f(c,e)}))}))}},isSafari:function(){return wx.emedia.isSafari},someBrowsersRequireGetUserMedia:function(e,t){var n=this;if(wx.emedia.youInSomeBrowsers()&&!wx.emedia._yetGetUserMedia){if(!0===n.__tryingOpenMedia)n.__tryingOpenMediaWaitSuceess=n.__tryingOpenMediaWaitSuceess||[],n.__tryingOpenMediaWaitFail=n.__tryingOpenMediaWaitFail||[],"function"==typeof e&&n.__tryingOpenMediaWaitSuceess.push(e),"function"==typeof t&&n.__tryingOpenMediaWaitFail.push(t);else{var r=function(t,o){wx.emedia._yetGetUserMedia=!0,wx.emedia.stopTracks(o),setTimeout((function(){n.__tryingOpenMedia=!1,e&&e.apply(n),n.__tryingOpenMediaWaitSuceess&&i.forEach(n.__tryingOpenMediaWaitSuceess,(function(e,t){t.apply(n)})),n.__tryingOpenMediaWaitSuceess=[],n.__tryingOpenMediaWaitFail=[]}),300)},s=function(e){n.__tryingOpenMedia=!1,o.error("Some browsers must getUserMedia, gather cands. now try get audio. fail. subfail"),t&&t.call(n,e),n.__tryingOpenMediaWaitFail&&i.forEach(n.__tryingOpenMediaWaitFail,(function(t,i){i.call(n,e)})),n.__tryingOpenMediaWaitSuceess=[],n.__tryingOpenMediaWaitFail=[]};n.__tryingOpenMedia=!0,n._service.__getUserMedia({audio:!0},r,(function(e){n._service.__getUserMedia({video:!0},r,s)}))}return!0}return!1},createWebrtcAndSubscribeStream:function(e,t,n,r){var a=this;t||(t={});var c=a._cacheStreams[e],u=a._cacheMembers[c.memId],d=c;function l(n){o.warn("sub stream error",e,n),_&&d._webrtc&&d._webrtc.setSubArgs(_),_&&d.updateAttributes({subArgs:_}),n=new s.SubFail({stream:d,hidden:!0===n.hidden,cause:n}),t&&t.onEvent&&t.onEvent(n),a.onEvent&&a.onEvent(n)}function f(){d.updateAttributes(d.subArgs)}r=r||d.subArgs||{subSVideo:!0,subSAudio:2!==c.type};var p=c.vcodes||[],h=u&&u.vcodes||[],m=a.supportVCodes,g=a._getOptimalVideoCodecsSubset(p,h,m);r=r||d.subArgs;var _=d.subArgs,v=!(d.vcodes&&d.vcodes.length>0);wx.emedia.isSafari&&(v=v||!!d.voff);var y={offerToReceiveAudio:!0,offerToReceiveVideo:r.subSVideo&&!v};function b(){var s=a.createWebrtc({iceServerConfig:n,optimalVideoCodecs:g,offerOptions:y,onGotMediaStream:function(e){t.onGotRemote&&t.onGotRemote(d)}},d.iceRebuildCount),c=s.getRtcId();o.warn(c," sub stream ",e,g),d.updateAttributes({_webrtc:s,rtcId:c,owner:i.extend({},u)}),r&&d._webrtc&&d._webrtc.setSubArgs(r),r&&d.updateAttributes({subArgs:r})}y.offerToReceiveAudio||y.offerToReceiveVideo||o.warn("offerToReceiveAudio == false and offerToReceiveVideo == false"),a.someBrowsersRequireGetUserMedia((function(){b(),a.offerCall(d.rtcId,null,e,l,f)}),(function(t){o.error("Some browsers must getUserMedia, gather cands. now try get audio. fail. subfail",e),l(t)}))||(b(),a.offerCall(d.rtcId,null,e,l,f))},_getOptimalVideoCodecsSubset:function(e,t,n){var o=this,r=[];if(e&&e.length>0&&n[e[0]]&&r.push(e[0]),0==r.length)for(var s=0;s<o._orderVCodes.length;s++)i.forEach(t,(function(e,t){t==o._orderVCodes[s]&&r.push(t)}));return r},subscribeStream:function(e,t,n,o,r){var a=this,c=a._ices[e],u=a._cacheStreams[t],d=a._cacheMembers[u.memId],l=u;l.updateAttributes({_webrtc:c,rtcId:e,owner:i.extend({},d)});var f=l.subArgs;if(o=o||{subSVideo:!0,subSAudio:!0},l.updateAttributes({subArgs:l.subArgs||{subSVideo:!0,subSAudio:!0}}),l._webrtc&&l._webrtc.setSubArgs(l._webrtc.subArgs||{subSVideo:!0,subSAudio:!0}),!l.subArgs.subSVideo&&o.subSVideo&&!l.voff){var p=u.vcodes,h=d.vcodes,m=a.supportVCodes;a._getOptimalVideoCodecsSubset(p,h,m)}o&&l._webrtc&&l._webrtc.setSubArgs(o),o&&l.updateAttributes({subArgs:o});var g=a.newMessage().setOp(205).setRtcId(e).setSubSId(t);o&&i.extend(g,o),a.postMessage(g,(function(e){if(0!=e.result){f&&l._webrtc&&l._webrtc.setSubArgs(f),f&&l.updateAttributes({subArgs:f});var t=new s.SubFail({stream:l,cause:new s.RspFail({request:g,response:e})});return n&&n(t),void a.onEvent(t)}l.updateAttributes(l.subArgs),t=new s.SubSuccess({stream:l,hidden:!0}),a._updateRemoteStream(l,l._webrtc.getRemoteStream()),a.onEvent(t),"function"==typeof r&&r()}))},unsubscribeStream:function(e){var t=this._cacheStreams[e],n=t._webrtc&&t._webrtc.getRtcId();if(n){try{var i=this.newMessage().setOp(206).setRtcId(n).setSubSId(e);this.postMessage(i)}finally{this.closeWebrtc(n)}return n}},onReconnect:function(e,t){__f__("log","onReconnect"," at emediaSDK/emedia_for_miniProgram.js:3");var n=t.confrId,i=JSON.stringify(t);c.exitConference(n),setTimeout((function(){c.joinConferenceWithTicket(n,i).then((function(e){c.onReconnect(e,t)}))}),100)},onSignallingData:function(e){c.onSignallingData(e)},onEnter:function(e,t){var n=this;if(e&&(n._cver=e),t&&!n._cacheMembers[t.id]){n._cacheMembers[t.id]=t;var o={};t.res&&t.res.vcodes&&t.res.vcodes.length>0&&i.forEach(t.res.vcodes,(function(e,t){o[t]||(o[t]=!0,n.supportVCodes[t]&&n.supportVCodes[t]++)})),n.onAddMember(i.extend({},t))}},_onFinally:function(){this._cacheMembers={},this._cacheStreams={},this._linkedStreams={},this._ices={},this._maybeNotExistStreams={};var e=[];if(i.forEach(this._openedRtcMediaStreams,(function(t,n){!1!==n.active&&e.push(n)})),e.length>0)for(var t=0;t<e.length;t++)try{var n=e[t];o.info("exit, close stream = ",n.id),wx.emedia.stopTracks(n)}catch(e){o.error(e)}o.warn("finally. all clean.")},_onRoleUpdate:function(e,t){o.info("Role ",e," <-",this.role),o.info(t),this.role=e,this.roleToken=t,this.onRoleUpdate&&this.onRoleUpdate(e,t)},onExit:function(e,t,n){var r=this;if(e&&(r._cver=e),t!=r.getMemberId()){var a=r._cacheMembers[t];a&&(a.res&&a.res.vcodes&&a.res.vcodes.length>0&&i.forEach(a.res.vcodes,(function(e,t){r.supportVCodes[t]--})),r._onRemoveMember(a,n),r.onEvent(new s.Hangup({reason:n,parnter:a})))}else{o.warn("Me exit. ",n,t);try{r.closed||r.close(n)}catch(e){r.onEvent(new s.Hangup({reason:n,self:{id:r._memberId}})),r.onMeExit&&r.onMeExit(n),o.warn(e)}}},onPub:function(e,t,n){this._cacheMembers[t]||o.error("No found member. when pub");var r=this.newStream(n),s=this._cacheStreams[n.id];if(e&&(this._cver=e),s&&r.sver!==s.sver)return o.info("Onpub. the steam ",s.id," republish. sver ",s.sver,r.sver),!r||r.aoff===s.aoff&&r.voff==s.voff||this.onStreamControl(void 0,n.id,r.voff,r.aoff),i.extend(s,r),void this._onRepublishStream(s);var a=r;return a.updateAttributes({owner:this._cacheMembers[t]}),this._cacheStreams[n.id]=a,this._onAddStream(this.newStream(a)),this.newStream(a).id,a},onUnpub:function(e,t,n){var i=this._cacheStreams[n];this._onRemovePubstream(this._cacheMembers[t],i),e&&(this._cver=e)},onClose:function(e,t,n){try{this.close(n||0)}finally{this.onConfrClose&&this.onConfrClose(t,n)}},__getWebrtcFor:function(e){var t=this._cacheStreams[e]&&this._cacheStreams[e]._webrtc;return t&&t.getRtcId()},_getWebrtc:function(e){return this._cacheStreams[e]&&this._cacheStreams[e]._webrtc},_updateRemoteStream:function(e,t){e.located()&&2===e.type?wx.emedia.enableAudioTracks(t,!0):wx.emedia.enableAudioTracks(t,!(e.aoff||e.subArgs&&!1===e.subArgs.subSAudio)),wx.emedia.enableVideoTracks(t,!(e.voff||e.subArgs&&!1===e.subArgs.subSVideo))},onStreamControl:function(e,t,n,i,o){var r=this._cacheStreams[t];r.updateAttributes({voff:n,aoff:i});var s=r._webrtc;s&&s._remoteStream&&this._updateRemoteStream(r,s._remoteStream);var a=this.newStream(r);this.onUpdateStream&&this.onUpdateStream(a,new a.Update({voff:n,aoff:i})),e&&(this._cver=e),o&&r.updateAttributes({sver:o})},aoff:function(e,t,n){var i=this.__getWebrtcFor(e.id);if(!i)throw o.error("pubS not publish",e.id),"pubS not publish"+e.id;this._linkedStreams[e.id].updateAttributes({aoff:t}),e.updateAttributes({aoff:t});var r=this.newMessage().setOp(400).setRtcId(i).setVoff(e.voff).setAoff(t);this.postMessage(r,n),this.onUpdateStream&&this.onUpdateStream(e,new e.Update({aoff:t}))},voff:function(e,t,n){var i=this.__getWebrtcFor(e.id);if(!i)throw o.error("pubS not publish",e.id),"pubS not publish"+e.id;this._linkedStreams[e.id].updateAttributes({voff:t}),e.updateAttributes({voff:t});var r=this.newMessage().setOp(400).setRtcId(i).setVoff(t).setAoff(e.aoff);this.postMessage(r,n),this.onUpdateStream&&this.onUpdateStream(e,new e.Update({voff:t}))},startRecord:function(e,t){var n=this,r=e.rtcId,s=n.newMessage().setOp(500).setRtcId(r).setFlag(1);n.postMessage(s,(function(s){o.warn("record ",r,s.result,s.msg),t&&t(0===s.result),0===s.result&&(n._records[e.id]=i.extend(!1,{},e))}))},stopRecord:function(e,t){var n=e.rtcId,r=this.newMessage().setOp(500).setRtcId(n).setFlag(0);this.postMessage(r,(function(e){o.warn("stop record ",n,e.result,e.msg),t&&t(0===e.result)})),this._records[e.id]&&i.removeAttribute(this._records,e.id)},onMembers:function(e,t){var n=this,o=[];i.forEach(n._cacheMembers,(function(e,n){t[e]||o.push(n)}));var r=[];i.forEach(t,(function(e,t){(t.name&&t.name!=n.memName||!t.name&&e!=n.getMemberId())&&(n._cacheMembers[e]||r.push(t),n._cacheMembers[e]&&i.extend(n._cacheMembers[e],t))})),i.forEach(r,(function(e,t){n.onEnter(void 0,t)})),e&&(n._cver=e)},onStreams:function(e,t){var n=this,o=[];i.forEach(n._cacheStreams,(function(e,n){n.located()||t[e]||o.push(n)})),i.forEach(o,(function(e,t){n.onUnpub(void 0,t.memId,t.id)}));var r=[];i.forEach(t,(function(e,t){(t.memName&&t.memName!=n.memName||!t.memName&&t.memId!=n.getMemberId())&&(n._cacheStreams[e]||r.push(t),n._cacheStreams[e]&&i.extend(n._cacheStreams[e],t))})),i.forEach(r,(function(e,t){n.onPub(void 0,t.memId,t)})),i.forEach(n._cacheStreams,(function(e,o){var r;o.located()||(r=t[e]),!r||r.aoff===o.aoff&&r.voff==o.voff||n.onStreamControl(void 0,e,r.voff,r.aoff),r&&r.sver!==o.sver&&(i.extend(o,r),n._onRepublishStream(o))})),e&&(n._cver=e)},_onRemoveMember:function(e,t){var n=this;o.info("remove",e,t);var r=[];i.forEach(n._cacheStreams,(function(t,n){(n.memId||n.owner&&n.owner.id)===e.id&&r.push(n)})),i.forEach(r,(function(e,i){n._onRemovePubstream(i.owner,i,t)})),i.removeAttribute(n._cacheMembers,e.id),n.onRemoveMember&&n.onRemoveMember(e,t)},_onAddStream:function(e){o.info("add stream ",e.id),o.debug("add stream ",e),this.onAddStream(e)},_onRemovePubstream:function(e,t,n){var o=this;if(t&&0!=t.id)try{var r=i.removeAttribute(o._mediaMeters,t.id);r&&r._finally()}finally{!function(e){2===e.type&&(i.removeAttribute(o.audioMixers,e.id),e.remotePlayAudioObject&&document.body.removeChild(e.remotePlayAudioObject)),n||(n="Unpub"),e&&!e.closeReason&&e.updateAttributes({closeReason:n}),o.unsubscribeStream(e.id),i.removeAttribute(o._cacheStreams,e.id),o._streamAutomators&&i.removeAttribute(o._streamAutomators,e.id),o._monitSoundChanagedStreams&&i.removeAttribute(o._monitSoundChanagedStreams,e.id),o.onRemoveStream&&(e=o.newStream(e),o.onRemoveStream(e))}(t)}},_onRepublishStream:function(e){!this._ices[e.rtcId]&&!wx.emedia.subscribed(e)||this._maybeNotExistStreams[e.id]?this.onUpdateStream(e):(this.unsubscribeStream(e.id),this.createWebrtcAndSubscribeStream(e.id,{onGotRemote:function(e){}}))},_onRecvRemoteMessage:function(e,t,n){o.debug("Recv remote message",e,t);var i,r=this._cacheMembers[e];try{i=JSON.parse(t)}catch(e){}this.onRecvRemoteMessage&&this.onRecvRemoteMessage(r||e,i||t,n)},_onSoundChanage:function(e,t,n){wx.emedia.config._printSoundData&&o.info("Stream id "+t.id+", meter "+(n&&n.instant.toFixed(2)+" "+n.slow.toFixed(2)+" "+n.clip.toFixed(2)+" "+(n.trackAudioLevel||"--")+" "+(n.trackTotalAudioEnergy||"--"))),n||(n={instant:0,slow:0,clip:0}),wx.emedia.config.logVolumeWhenInstantGE&&wx.emedia.config.logVolumeWhenInstantGE>0&&n.instant>=wx.emedia.config.logVolumeWhenInstantGE&&n.instant<3*wx.emedia.config.logVolumeWhenInstantGE&&o.info("Stream id "+t.id+", webrtc = "+(t._webrtc?t._webrtc.getRtcId():"null")+", media streamId = "+(t.getMediaStream()?t.getMediaStream().id:"null")+", instant >= "+wx.emedia.config.logVolumeWhenInstantGE+", meter instant="+n.instant+", slow="+n.slow+", clip="+n.clip),0===n.instant&&(n.instant=n.trackAudioLevel||n.trackTotalAudioEnergy||0),this.onSoundChanage(e,t,n),this._service._judgeTalking(n)&&this.onTalking(e,t,n)},onAddMember:function(e){c._onMemberJoined(e)},onRemoveMember:function(e,t){c.onMemberExited(e,t)},onAddStream:function(e){c.onStreamAdded(e)},onRemoveStream:function(e){c.onStreamRemoved(e)},_onConfrAttrsUpdated:function(e){c.onConfrAttrsUpdated(e)},onUpdateStream:function(e,t){c.onMediaChanaged(e,t)},onRecvRemoteMessage:function(e,t){},onSoundChanage:function(e,t,n){c.onSoundChanage(e,t,n)},onTalking:function(e,t,n){},onRoleUpdate:function(e,t){c.onRoleChanged(e,t)},onMeExit:function(e){c.onConferenceExit(e)}});e.exports=u},function(e,t,n){var i=n(0),o=i.tagLogger("Member"),r=n(1),s=n(3);e.exports=i.prototypeExtend({__init__:function(){if(!this._session)throw o.error("Require session"),"Require session";this.closed=!1,this._ices={},this.supportVCodes={},this.audioMixers={}},reflushSupportVCodes:function(e){var t=this;t.supportVCodes={},t._orderVCodes=e,e&&0!=e.length?i.forEach(e,(function(e,n){t.supportVCodes[n]=1})):o.warn("Not config support vcodes")},getOptimalVideoCodecs:function(){var e=0;i.forEach(this._cacheMembers,(function(){e++}));for(var t,n=0,o=0;o<this._orderVCodes.length;o++){var r=this._orderVCodes[o];if(0==n&&(n=this.supportVCodes[r]),this.supportVCodes[r]>e)return r;this.supportVCodes[r]>n&&(n=this.supportVCodes[r],t=r)}return t},setMemberId:function(e){this._memberId=e},getMemberId:function(){return this._memberId||this.id},createWebrtc:function(e,t){var n=this;e||(e={}),i.extend(e,{_rebuildCount:t||0}),!0===n._service.useRTCCfg&&n.__rtc_cfg?e.iceServerConfig=i.extend(!0,{},n.__rtc_cfg):i.isPlainObject(n._service.useRTCCfg)&&(e.iceServerConfig=i.extend(!0,{},n._service.useRTCCfg));var a=new s({confrAttendee:n,useIp:n.ip,onIceStateChange:function(e){var t=e;o.debug("evt.target ice state",t);try{if("failed"==t)return n.onEvent(new r.ICEConnectFail({webrtc:a})),void(a.onEvent&&a.onEvent(new r.ICEConnectFail({webrtc:a})));if("connected"==t)return n.onEvent(new r.ICEConnected({webrtc:a})),void(a.onEvent=null);if("closed"==t)return n.onEvent(new r.ICEClosed({webrtc:a})),void(a.onEvent&&a.onEvent(new r.ICEClosed({webrtc:a})));if("disconnected"==t)return n.onEvent(new r.ICEDisconnected({webrtc:a})),void(a.onEvent&&a.onEvent(new r.ICEDisconnected({webrtc:a})))}finally{n._onIceStateChange&&n._onIceStateChange(a,e)}},onIceCandidate:function(e){n._onIceCandidate&&e&&n._onIceCandidate(a,e)},onGotRemoteStream:function(e){o.info("got stream.",a._rtcId,a.__id,e),a.onGotMediaStream&&a.onGotMediaStream(e),n.onEvent(new r.ICERemoteMediaStream({webrtc:a}))},onAddIceCandidateError:function(e){n.onEvent(new r.AddIceCandError({webrtc:a,event:e}))},onSetSessionDescriptionError:function(e){o.warn("onSetSessionDescriptionError : Failed to set session description: "+e.toString()),n.onEvent&&n.onEvent(new r.ICEConnectFail({webrtc:a,event:e}))},onCreateSessionDescriptionError:function(e){o.warn("Failed to create session description: "+e.toString()),n.onEvent&&n.onEvent(new r.ICEConnectFail({webrtc:a,event:e}))}},e);return n._ices||(n._ices={}),n._ices[a.getRtcId()]&&n._howDoWebrtcWhenCrtExsitsWebrtc(a),n._ices[a.getRtcId()]=a,n._ices[a.__id]=a,n._iceCreateRtcPeerConnection(a.getRtcId()),o.debug("create rtc ",a),a},_howDoWebrtcWhenCrtExsitsWebrtc:function(e){this.closeWebrtc(e.getRtcId(),!0,!1)},connect:function(e,t){this._session.connect(e,t)},connected:function(){return this._session.connected()},newMessage:function(e){var t=this,n=t._session.newMessage(e);return n.post=function(e,n){t.postMessage(this,e,n)},n},message:function(e){var t=this,n=t._session.newMessage(e);return n.post=function(e,n){t.postMessage(this,e,n)},n},postMessage:function(e,t,n){try{e.sessId||(e.sessId=this._session._sessionId),this._session.postMessage(e,t,n)}catch(n){t&&t({op:1001,tsxId:e.tsxId,result:-9527,msg:"post message. exception"}),o.warn(n)}},onEvent:function(e){},_onIceStateChange:function(e,t){o.info(e.getRtcId(),t),this.onEvent(new r.ICEChanage({webrtc:e,state:t}))},_onIceCandidate:function(e,t){var n,o=this;i.isArray(t)?n=t:(n=[]).push(t);var s=o.newMessage().setOp(105).setRtcId(e.getRtcId()).setCands(n);o.postMessage(s,(function(e){0==e.result||o.onEvent(new r.RspFail({request:s,response:e}))}))},_initC:function(e,t,n,s,a,c){var u=this;if(t&&t.rtcId!==e.getRtcId())throw o.error("stream and webrtc rtcId not equal."),"stream and webrtc rtcId not equal.";var d=u.newMessage().setOp(102).setRtcId(e.getRtcId()).setSdp(n).setSubSId(s);e.subArgs&&i.extend(d,e.subArgs),t&&t.located()&&d.setPubS(t),u.postMessage(d,(function(n){if(0!=n.result)return u.onEvent(new r.RspFail({request:d,response:n})),void(a&&a(new r.RspFail({request:d,response:n,hidden:!0===n.retrying})));t&&!t.id&&n.streamId&&t.updateAttributes({id:n.streamId});try{c&&c()}catch(e){o.warn(e)}n.sdp&&u.ansC(e.getRtcId(),n.sdp,n.cands),__f__("log","_member postMessage"," at emediaSDK/emedia_for_miniProgram.js:3"),n.mems&&u.onMembers&&u.onMembers(n.cver,n.mems),n.streams&&u.onStreams&&u.onStreams(n.cver,n.streams)}))},_acptC:function(e,t,n){var i=this,o=i.newMessage().setOp(104).setRtcId(e.getRtcId()).setSdp(t);i.postMessage(o,(function(e){if(0!=e.result)return i.onEvent(new r.RspFail({request:o,response:e})),void(n&&n(new r.RspFail({request:o,response:e})))}))},_ansCAndPubstream:function(e,t,n,s,a){var c=this,u=c.newMessage().setOp(106).setRtcId(e.getRtcId()).setSdp(n);e.subArgs&&i.extend(u,e.subArgs),t&&t.located()&&(t=i.extend({},t),i.removeAttribute(t,"mutedMuted"),i.removeAttribute(t,"_located"),u.setPubS(t)),c.postMessage(u,(function(e){if(0!=e.result)return c.onEvent(new r.RspFail({request:u,response:e})),void(s&&s(new r.RspFail({request:u,response:e,hidden:!0===e.retrying})));t&&!t.id&&e.streamId&&t.updateAttributes({id:e.streamId});try{a&&a()}catch(e){o.warn(e)}}))},_ansC:function(e,t,n){var i=this,o=i.newMessage().setOp(106).setRtcId(e.getRtcId()).setSdp(t);i.postMessage(o,(function(e){if(0!=e.result)return i.onEvent(new r.RspFail({request:o,response:e})),void(n&&n(new r.RspFail({request:o,response:e})))}))},_termC:function(e,t,n){var i=this,o="string"==typeof e?e:e.getRtcId(),s=i.newMessage().setOp(107).setRtcId(o).setEndReason(t);i.postMessage(s,(function(e){if(0!=e.result)return i.onEvent(new r.RspFail({request:s,response:e})),void(n&&n(new r.RspFail({request:s,response:e})))}))},_iceCreateRtcPeerConnection:function(e){this._ices[e].createRtcPeerConnection(),o.debug("create rtc peer connection",e)},doOffer:function(e,t,n){this._ices[e].createOffer((function(e){t(e)}))},offerCall:function(e,t,n,i,o){var r=this,s=r._ices[e];s.createOffer((function(e){r._initC&&r._initC(s,t,e,n,i,o)}))},accept:function(e,t){var n=this,i=n._ices[e];i.createPRAnswer((function(e){n._acptC&&n._acptC(i,e,t)}))},answerCall:function(e,t,n,i){var o=this,r=o._ices[e];r.createAnswer((function(e){o._ansCAndPubstream&&o._ansCAndPubstream(r,t,e,n,i)}))},answer:function(e,t){var n=this,i=n._ices[e];i.createAnswer((function(e){n._ansC&&n._ansC(i,e,t)}))},onTcklC:function(e,t){},onAcptC:function(e,t,n){},onAnsC:function(e,t,n){},_addIceCandidate:function(e,t){if(e&&0!=e.length){var n=this._ices[t];n&&n.addIceCandidate(e)}else o.warn("drop cands",e)},closeWebrtc:function(e,t,n){var r=this,s=r._ices[e];if(i.forEach(r._cacheStreams,(function(t,n){if(n.rtcId===e&&!n.located())try{var s=i.removeAttribute(r._mediaMeters,t);s&&s._finally()}catch(e){o.warn(e)}n.rtcId===e&&2===n.type&&i.removeAttribute(r.audioMixers,n.id)})),!s||s.closed)return o.warn("Webrtc not exsits or closed",s&&s.closed),n&&s&&i.forEach(r._cacheStreams,(function(t,n){n.rtcId===e&&(i.removeAttribute(r._linkedStreams,t),o.warn("Webrtc close, remvoe from _linkedStreams",t))})),void(n||r._termC(e,0));r._records&&i.forEach(r._records,(function(t,n){n.rtcId===e&&function(e){try{r.stopRecord(e)}catch(e){o.warn(e)}finally{i.removeAttribute(r._records,e.id)}}(n)}));try{n||s&&r._termC(s,t&&s._localStream?-10:0)}finally{s&&s.close(t),s&&r.onWebrtcTermC&&r.onWebrtcTermC(s),t||s&&i.forEach(r._cacheStreams,(function(t,s){s.rtcId===e&&(s.located()&&(wx.emedia.stopTracks(s._localMediaStream),s&&!s.closeReason&&s.updateAttributes({closeReason:"WebrtcClose"}),r._cacheStreams[t]&&r._linkedStreams[t]&&r.onRemoveStream(s),i.removeAttribute(r._cacheStreams,t),r._streamAutomators&&i.removeAttribute(r._streamAutomators,t),r._monitSoundChanagedStreams&&i.removeAttribute(r._monitSoundChanagedStreams,t),o.info("Webrtc close. Remove stream",t,". from cache")),n&&(i.removeAttribute(r._linkedStreams,t),o.info("Webrtc close. Remove stream",t,". from _linkedStreams")))}))}return s},__close:function(e){if(o.warn("closing, reason = ",e),!this.closed){if(this.closed=!0,this.__getCopyInterval&&(clearInterval(this.__getCopyInterval),o.warn("Stop interval get copy")),this._ices)for(var t in this._ices)this.closeWebrtc(t,!1);var n=this.newMessage().setOp(201).setReason(e||0);this.postMessage(n)}},exit:function(e){var t=this;e?(e&&t._closeMyConfr(11),setTimeout((function(){t.close(0)}),100)):t.close(0)},_closeMyConfr:function(e){var t=this.newMessage().setOp(204).setReason(e||0);this.postMessage(t,(function(e){o.warn("Close confr ",e.result,e.msg)}))},close:function(e,t){var n=this;if(!n.closed)try{i.forEach(n._cacheStreams||{},(function(e,t){t.located()&&t._localMediaStream&&wx.emedia.stopTracks(t._localMediaStream)})),n.__close(e),i.forEach(n._cacheStreams,(function(e,t){n.onRemoveStream(t)})),i.forEach(n._cacheMembers,(function(e,t){n.onRemoveMember(t)}))}finally{try{setTimeout((function(){n._session&&n._session.close(e)}),500),n.onEvent(new r.Hangup({reason:e,failed:t,self:{id:n._memberId}})),n.onMeExit&&n.onMeExit(e,t)}catch(e){o.error(e)}finally{n._onFinally&&n._onFinally()}}},webrtcState:function(e){return this._ices[e].iceConnectionState()},_iceSetRemoteSDP:function(e,t){this._ices[t].setRemoteDescription(e)},setLocalStream:function(e,t){this._ices[t].setLocalStream(e)},onWebrtcTermC:function(e){}})},function(e,t,n){var i=n(0),o=i.tagLogger("Handler"),r=n(1),s=i.prototypeExtend({onEvent:function(e){var t=this;function n(){try{t.handleEvent(e)}catch(e){o.warn(e)}}if(e&&o.info("[EVT]",e.message(),e.hidden||""),e instanceof r.ServerRefuseEnter&&e.failed&&-95270===e.failed&&(e.failed=-9527),e instanceof wx.emedia.event.StreamState&&e.stream&&e.stream.located())n();else try{e.hidden||t.onNotifyEvent&&t.onNotifyEvent(e)}finally{n()}},handleEvent:function(e){__f__("log","evt",e," at emediaSDK/emedia_for_miniProgram.js:3");var t=this;if(e instanceof r.RecvResponse)t._onRecvResponse(e);else if(e instanceof r.ServerRefuseEnter)o.warn("Server refuse, ",e.failed,e.msg),t.onServerRefuseEnter(e);else if(e instanceof r.NetworkChanaged)o.warn("Network chanaged, ",e.preIp,e.nowIp),t.onNetworkChanaged(e);else if(e instanceof r.EnterFail)o.warn("Enter fail, result = ",e.failed),t.onEnterFail();else if(e instanceof r.WSClose)t.onWSClose();else if(e instanceof r.WSConnected)o.warn("Websocket connected");else if(e instanceof r.ICEConnected){var n=e.webrtc;t.onICEConnected(n)}else if(e instanceof r.ICEConnectFail)n=e.webrtc,t.onICEConnectFail(n);else if(e instanceof r.ICEDisconnected)n=e.webrtc,t.onICEDisconnected(n);else if(e instanceof r.ICEClosed)n=e.webrtc,t.onICEClosed(n);else if(e instanceof r.ICERemoteMediaStream)t.onICERemoteMediaStream(e.webrtc);else if(e instanceof r.PushSuccess){t._cacheStreams[e.stream.id]=t._linkedStreams[e.stream.id]=e.stream;var s=t.newStream(e.stream);if(e.hidden&&!t._maybeNotExistStreams[e.stream.id]&&!s.isRepublished)return void t._onAddStream(s);wx.emedia._yetGetUserMedia=!0;try{!0!==e.hidden&&s&&t.onUpdateStream(s,new s.Update({voff:s.voff,aoff:s.aoff,mediaStream:s.getMediaStream()}))}finally{wx.emedia.isSafari&&i.forEach(t._cacheStreams,(function(e,n){!0===n._autoSubWhenPushStream&&(i.removeAttribute(n,"_autoSubWhenPushStream"),t.createWebrtcAndSubscribeStream(n.id))}))}}else if(e instanceof r.SubSuccess)t._linkedStreams[e.stream.id]=e.stream,e.stream.updateAttributes({_zoom:1});else if(e instanceof r.PushFail){if(!0!==e.hidden){var a=i.removeAttribute(t._linkedStreams,e.stream.id);o.warn("PushFail remove from _linkedStreams",e.stream.id,a),a&&(s=t.newStream(e.stream),t.onRemoveStream(s))}}else if(e instanceof r.SubFail)!0!==e.hidden&&(i.removeAttribute(t._linkedStreams,e.stream.id),o.warn("SubFail remove from _linkedStreams",e.stream.id),(s=t.newStream(e.stream)).updateAttributes({rtcId:void 0,_webrtc:void 0,mediaStream:void 0}),t.onUpdateStream(s,new s.Update(s)));else if(e instanceof r.SubFailNotSupportVCodes){var c=e.stream;o.warn("Rtc donot support pub VCodes. close. sub fail.",c.rtcId," -> ",c.id);try{t.onNotSupportPublishVideoCodecs&&t.onNotSupportPublishVideoCodecs(c)}catch(e){o.warn(e)}}else if(e instanceof r.EnterSuccess)t.onEnterSuccess();else if(e instanceof r.SwitchVCodes){c=e.stream;var u=e.useVCodes;if(n=c._webrtc,o.warn("Rtc switch VCodes. ",c.id,u),u&&0!=u.length||o.warn("Rtc switch VCodes. error! useVCodes is empty ",c.id,u),n&&n.optimalVideoCodecs){if("string"==typeof n.optimalVideoCodecs&&n.optimalVideoCodecs==u[0])return void o.warn("Rtc switch VCodes. igrone . useVCodes == optimalVideoCodecs ",c.id,n._rtcId,u);if(i.isArray(n.optimalVideoCodecs)&&n.optimalVideoCodecs.length>0&&n.optimalVideoCodecs[0]==u[0])return void o.warn("Rtc switch VCodes. igrone ddd . useVCodes == optimalVideoCodecs ",c.id,n._rtcId,u)}c.updateAttributes({optimalVideoCodecs:u}),n&&t.closeWebrtc(n.getRtcId(),!0),setTimeout((function(){c.updateAttributes({iceRebuildCount:1}),t.iceRebuild(c),o.warn("Rtc switch VCodes. iceRebuild end.",c.id,u)}),300)}},_onRecvResponse:function(e){var t=e.request,n=e.response;if(t&&n&&200!==t.op&&1002!==t.op&&0!==n.result){o.warn("Server refuse. when request = ",t);var i=e.failed;switch(i){case-9527:case-95270:break;case-500:case-502:case-504:case-508:case-510:this.close(4,i);break;case-506:this.close(11,i);break;case-501:this.close(11,i)}}},onServerRefuseEnter:function(e){var t=e.failed;switch(t){case-9527:case-95270:this.close(4,-9527);break;case-500:case-502:case-504:case-508:case-510:this.close(4,t);break;case-506:this.close(11,t);break;default:this.close(2)}},onEnterFail:function(){this.__getCopyInterval&&clearInterval(this.__getCopyInterval)},onNetworkChanaged:function(e){var t=this,n=e.nowIp;wx.emedia.config.rebuildPeerConnectionWhenNetworkChanaged&&setTimeout((function(){var e={};i.forEach(t._cacheStreams,(function(i,r){if(!t._maybeNotExistStreams[i]&&r._webrtc){var s=r._webrtc;e[r.rtcId]||(s.closed||"string"!=typeof s.useIp||s.useIp===n||(o.warn("network chanage. webrtc will rebuild.",s._rtcId,s.__id),t.onICEClosed(s)),e[r.rtcId]=!0)}}))}),100)},onEnterSuccess:function(){var e=this;setTimeout((function(){e._failIcesRebuild()}),50),e.getCopyIntervalMillis&&e.getCopyIntervalMillis>0&&(o.warn("Run interval get copy. interval = ",e.getCopyIntervalMillis),e.__getCopyInterval&&clearInterval(e.__getCopyInterval),e.__getCopyInterval=setInterval((function(){e._session.connected()?e._sysCopy.apply(e):(o.warn("Warn! cannot get copy. cause offline."),e.__getCopyInterval&&clearInterval(e.__getCopyInterval))}),e.getCopyIntervalMillis)),e.getMediaMeterIntervalMillis&&e.getMediaMeterIntervalMillis>0&&e._intervalGetMediaMeters()},_intervalGetMediaMeters:function(){var e=this;!function t(){e.__getMediaMetersIntervalFlag&&wx.emedia.cancelAnimationFrame(e.__getMediaMetersIntervalFlag),e.getMediaMeterIntervalMillis?e.__getMediaMetersIntervalFlag=wx.emedia.requestAnimationFrame((function(n){"function"==typeof wx.emedia.AudioContext&&e._flushMediaMetersByAudioContext.apply(e),!1===e.closed&&t()}),e.getMediaMeterIntervalMillis):o.warn("Ontalking closed. please use getMediaMeterIntervalMillis")}()},_flushMediaMetersByAudioContext:function(){var e=this;i.forEach(e._cacheStreams,(function(t,n){e._monitSoundChanagedStreams&&!e._monitSoundChanagedStreams[t]||"0"!=n.id&&e._updateMetersOrNewOne.call(e,t,n)}));var t=[];i.forEach(e._mediaMeters,(function(n,i){var o=e._cacheStreams[n];o&&e._updateMetersOrNewOne.call(e,n,o),o||t.push(n)})),i.forEach(t,(function(t,n){i.removeAttribute(e._mediaMeters,n)}))},_updateMetersOrNewOne:function(e,t){var n=this,o=n._mediaMeters[e];if(!(2!==t.type||t.located()||t.subArgs&&t.subArgs.subSAudio)){var r=n._oneAudioMixers();if(!r||o&&o._webrtc&&r._webrtc.__id!=o._webrtc.__id)return o&&o._finally(),i.removeAttribute(n._mediaMeters,e),void n._onSoundChanage.call(n,t.owner,t)}return o&&o._streamCreateId===t.__create_id&&o.__mediaSoundMeter.__worked?(o.onSoundMeters((function(e){n._onSoundChanage.call(n,t.owner,t,e)})),o):(o&&(o._streamCreateId!==t.__create_id||o.__mediaSoundMeter.__worked)&&(o&&o._finally(),i.removeAttribute(n._mediaMeters,e),n._onSoundChanage.call(n,t.owner,t)),t.aoff?void 0:((o=n._newMediaMeters(t))&&(n._mediaMeters[e]&&n._mediaMeters[e]._finally(),n._mediaMeters[e]=o),o))},_newAudioContext:function(){if(wx.emedia.__usingWebAudio)return wx.emedia.__audioContext},_newMediaMeters:function(e){var t;if(2===e.type&&e.subArgs&&e.subArgs.subSAudio&&e._webrtc&&e._webrtc.getRemoteStream())return new e.StreamSoundMeter({_stream:e,_mediaStream:e._webrtc.getRemoteStream(),_webrtc:e._webrtc,__audioContext:this._newAudioContext()});if(2===e.type&&e.located())return new e.StreamSoundMeter({_stream:e,_mediaStream:e._localMediaStream,__audioContext:this._newAudioContext()});if(2===e.type&&!e.located()){var n=this._oneAudioMixers();if(!n||!n._webrtc||n._webrtc.closed)return;if(n&&(void 0===n._remoteMediaSoundMeters||!n._remoteMediaSoundMeters.__worked)&&n._webrtc&&n._webrtc.getRemoteStream()&&(n._remoteMediaSoundMeters=new n.MediaSoundMeter({_mediaStream:n._webrtc.getRemoteStream(),__audioContext:this._newAudioContext()})),!n._remoteMediaSoundMeters)return;return new e.StreamSoundMeter({_stream:e,_webrtc:n._webrtc,__mediaSoundMeter:n._remoteMediaSoundMeters})}return!e.aoff&&(t=e.getMediaStream())?new e.StreamSoundMeter({_stream:e,_mediaStream:t,__audioContext:this._newAudioContext()}):void 0},_oneAudioMixers:function(){var e=this._cacheStreams[0];if(e&&e._webrtc&&!e._webrtc.closed)return e;for(var t in this.audioMixers){var n=this.audioMixers[t];if(n.located())return n}},onWSClose:function(){this.__getCopyInterval&&clearInterval(this.__getCopyInterval),o.info("Websocket closed.")},onICEDisconnected:function(e){var t=this;t.__networkWeakInterval&&clearTimeout(t.__networkWeakInterval),t.__networkWeakInterval=setTimeout((function(){t.onNetworkWeak&&t.onNetworkWeak()}),1e3),i.forEach(t._linkedStreams,(function(n,r){r.rtcId==e.getRtcId()&&(t._maybeNotExistStreams[n]||(t._maybeNotExistStreams[n]=i.extend({},r)).updateAttributes({iceRebuildCount:1}),o.info("Stream maybe not exist. caused by disconnected",r.id))}))},onICEConnectFail:function(e){var t=this;for(var n in t._linkedStreams){var s=t._linkedStreams[n];if(s.rtcId==e.getRtcId()){if(s._webrtc&&s._webrtc.__id!==e.__id){o.warn("Stream use other webrtc rtcId = ",s.rtcId,", id: ",s._webrtc.__id,e.__id);continue}var a;if((a=t._maybeNotExistStreams[n])||(a=t._maybeNotExistStreams[n]=i.extend({},s)).updateAttributes({iceRebuildCount:1}),a){var c=new r.StreamState({stream:a});c.iceFail(),t.onEvent(c)}if(o.info("ice fail. webrtc = ",e.getRtcId()," problem stream is ",a.iceRebuildCount,a.id),a.iceRebuildCount>wx.emedia.config.iceRebuildCount)o.info("ice fail. webrtc = ",e.getRtcId()," rebuild fail. problem stream is ",a.id),a.located()?t.onEvent(new r.PushFail({stream:s,cause:"pub ice rebuild failed."})):t.onEvent(new r.SubFail({stream:s,cause:"sub ice rebuild failed."})),t.closeWebrtc(e.getRtcId(),!1);else{var u=t._records[a.id];a._localMediaStream?o.info("ice fail. webrtc = ",e.getRtcId()," will rebuild. remain local stream. ",a.id):o.info("ice fail. webrtc = ",e.getRtcId()," will rebuild.",a.id),t.closeWebrtc(e.getRtcId(),!0),u&&(t._records[a.id]=u),function(e){setTimeout((function(){t.iceRebuild(e)}),wx.emedia.config.iceRebuildIntervalMillis)}(a),o.info("ice fail. webrtc = ",e.getRtcId()," will rebuilding. problem stream is ",a.id)}2===s.type&&i.removeAttribute(t.audioMixers,s.id)}}},onICEClosed:function(e){if(e.closed){o.warn("Webrtc will be removed. by __id = ",e.__id,", rtcId = ",e.getRtcId());var t=i.removeAttribute(this._ices,e.__id);t?o.warn("Webrtc removed. by id = ",t.__id,", rtcId = ",t.getRtcId()):o.warn("Webrtc removed. by id = ",e.__id,", rtcId = ",e.getRtcId());var n=this._ices[e.getRtcId()];n&&n.__id===t.__id&&(t=i.removeAttribute(this._ices,e.getRtcId()),o.warn("Webrtc removed. by rtcId = ",t.getRtcId(),", __id = ",t.__id))}else o.info("ICE self closed. not allow. will rebuild",e.getRtcId()),this.onICEConnectFail(e)},onICEConnected:function(e){var t=this;i.forEach(t._cacheStreams,(function(n,s){if(s.rtcId==e.getRtcId()){if(s.updateAttributes({finalVCodeChoices:e.finalVCodeChoices}),t._maybeNotExistStreams[n]){i.removeAttribute(t._maybeNotExistStreams,s.id),t._linkedStreams[n]=s,o.info("ice reconnected. webrtc = ",e.getRtcId(),"will update stream = ",s.id);var a=t._records[s.id];a&&a.rtcId!==s.rtcId&&(t.startRecord(s),o.warn("Re record. for ",s.id,", after rebuild ice.",a.rtcId,"->",s.rtcId))}else o.info("ice connected. webrtc = ",e.getRtcId(),s.id),s.located()&&t.onEvent(new r.PushSuccess({stream:s})),s.located()||t.onEvent(new r.SubSuccess({stream:s}));2===s.type&&(t.audioMixers[s.id]=s)}}))},onICERemoteMediaStream:function(e){var t=this;i.forEach(t._cacheStreams,(function(n,i){if(i.rtcId==e.getRtcId()&&(!i.located()||2===i.type)){var o=e.getRemoteStream();t._updateRemoteStream(i,o),i.onGotRemoteMediaStream?i.onGotRemoteMediaStream.call(i,o):((i=t.newStream(i)).updateAttributes({mediaStream:e.getRemoteStream()}),t.onUpdateStream(i,new i.Update({mediaStream:i.mediaStream})))}}))},_failIcesRebuild:function(){var e=this;i.forEach(e._maybeNotExistStreams,(function(t,n){setTimeout((function(){e.iceRebuild(n)}),100)}))},iceRebuild:function(e){return this.connected()?this._linkedStreams[e.id]&&this._cacheStreams[e.id]?void(e.iceRebuildCount>wx.emedia.config.iceRebuildCount?(o.info("ice rebuild fail. count too many. stream is ",e.id),e.located()?this.onEvent(new r.PushFail({stream:e,cause:"pub ice rebuild failed."})):this.onEvent(new r.SubFail({stream:e,cause:"sub ice rebuild failed."}))):this.connected()?(o.info("ice try rebuild. count",e.iceRebuildCount,". stream is ",e.id),this.rebuildIce(e),e.iceRebuildCount++):o.warn("ice rebuild. stop. cause by not websocket disconnect",e.id)):(o.info("ice rebuild fail. it yet closed. stream is ",e.id,e.rtcId),i.removeAttribute(this._maybeNotExistStreams,e.id),i.removeAttribute(this._linkedStreams,e.id),void o.warn("iceRebuild, remvoe from _linkedStreams",e.id)):(e.updateAttributes({iceRebuildCount:1}),void o.warn("Websocket disconnect. waiting. rebuild count reset",e.iceRebuildCount,e.id))},rebuildIce:function(e){this._cacheStreams[e.id]?(o.warn("Begin rebuild ice ",e.iceRebuildCount,e.id),e.located()?(e.updateAttributes({isRepublished:!0}),this.push(e,void 0,void 0,!0)):this.createWebrtcAndSubscribeStream(e.id),o.warn("Finish rebuild ice ",e.iceRebuildCount,e.id,this._cacheStreams[e.id].rtcId)):o.warn("Begin rebuild ice. not found stream at local",e.iceRebuildCount,e.id)},_sysCopy:function(){var e=this,t=e.newMessage().setOp(1e3).setCver(e._cver||0);e.postMessage(t,(function(t){0==t.result?(e._cver||0)<t.cver&&(e._cver=t.cver,__f__("log","EventHandler _sysCopy"," at emediaSDK/emedia_for_miniProgram.js:3"),o.info("Got copy success.")):o.warn("Get copy fail. result = ",t.result)}))}});e.exports=s}])}))}).call(this,__webpack_require__("fe07")["default"],__webpack_require__("0de9")["default"])},e3db:function(e,t){e.exports="/static/images/theme2x.png"},e3de:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));try{i={chat:n("735c").default}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. \u6392\u67e5\u7ec4\u4ef6\u540d\u79f0\u62fc\u5199\u662f\u5426\u6b63\u786e"),console.error("2. \u6392\u67e5\u7ec4\u4ef6\u662f\u5426\u7b26\u5408 easycom \u89c4\u8303\uff0c\u6587\u6863\uff1ahttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. \u82e5\u7ec4\u4ef6\u4e0d\u7b26\u5408 easycom \u89c4\u8303\uff0c\u9700\u624b\u52a8\u5f15\u5165\uff0c\u5e76\u5728 components \u4e2d\u6ce8\u518c\u8be5\u7ec4\u4ef6")}var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("chat",{ref:"chat",attrs:{id:"groupchat",username:e.username,groupId:e.groupId,chatType:"chatRoom",_i:0},on:{onMakeVideoCall:e.makeVideoCall,onClickInviteMsg:e.onClickMsg}})},r=[]},e645:function(e,t){e.exports={data:function(){return{}},onLoad:function(){this.$u.getRect=this.$uGetRect},methods:{$uGetRect:function(e,t){var n=this;return new Promise((function(i){uni.createSelectorQuery().in(n)[t?"selectAll":"select"](e).boundingClientRect((function(e){t&&Array.isArray(e)&&e.length&&i(e),!t&&e&&i(e)})).exec()}))},getParentData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.parent||(this.parent=!1),this.parent=this.$u.$parent.call(this,t),this.parent&&Object.keys(this.parentData).map((function(t){e.parentData[t]=e.parent[t]}))},preventEvent:function(e){e&&e.stopPropagation&&e.stopPropagation()}},onReachBottom:function(){uni.$emit("uOnReachBottom")}}},e6c8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=0,o={data:function(){return{translateX:0}},methods:{deleteItem:function(e){this.setData({translateX:0}),this.$emit("deleteChatItem",{},{bubbles:!0})},touchStartHandler:function(e){i=e.touches[0].pageX},touchMoveHandler:function(e){var t=e.touches[0].pageX,n=t-i;if(!(Math.abs(n)<80))if(n>0){if(0==Math.abs(this.translateX))return;this.setData({translateX:0})}else{if(Math.abs(this.translateX)>=160)return;this.setData({translateX:-160})}}}};t.default=o},e765:function(e,t,n){"use strict";n.r(t);var i=n("2ac4"),o=n("0149");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},ebe7:function(e,t,n){"use strict";n.r(t);var i=n("71bf");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var r,s,a,c,u=n("f0c5"),d=Object(u["a"])(i["default"],r,s,!1,null,null,null,!1,a,c);t["default"]=d.exports},ecaa:function(e,t,n){"use strict";n.r(t);var i=n("5b4c"),o=n("dbff");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},ee5d:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o,r=n("0c53")["default"],s=n("25e4"),a={data:function(){return{name:"",psd:"",grant_type:"password",psdFocus:"",nameFocus:""}},onLoad:function(){getApp().globalData;s.on("em.error.tokenErr",(function(){uni.showToast({title:"token\u9519\u8bef\u3001token\u8fc7\u671f\u6216\u8005\u672a\u6388\u6743",icon:"none"})}))},methods:{bindUsername:function(e){this.setData({name:e.detail.value})},bindPassword:function(e){this.setData({psd:e.detail.value})},onFocusPsd:function(){this.setData({psdFocus:"psdFocus"})},onBlurPsd:function(){this.setData({psdFocus:""})},onFocusName:function(){this.setData({nameFocus:"nameFocus"})},onBlurName:function(){this.setData({nameFocus:""})},login:function(){i||""!=this.name?i||""!=this.psd?(uni.setStorage({key:"myUsername",data:i||this.name.toLowerCase()}),getApp().globalData.conn.open({apiUrl:r.config.apiURL,user:i||this.name.toLowerCase(),pwd:o||this.psd,accessToken:o||this.psd,appKey:r.config.appkey})):uni.showToast({title:"\u8bf7\u8f93\u5165token\uff01",icon:"none"}):uni.showToast({title:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\uff01",icon:"none"})}}};t.default=a},eeb3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=(n("25e4"),{data:function(){return{username:"",switchStatus:""}},components:{},props:{},onLoad:function(){var e=uni.getStorageSync("myUsername");this.setData({username:e}),this.setData({switchStatus:i.config.isDebug})},onShow:function(){this.setData({switchStatus:i.config.isDebug})},methods:{openDebug:function(e){i.isDebug({isDebug:e.detail.value})}}});t.default=o},f098:function(e,t,n){(function(t,n){!function(t,n){e.exports=n()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/Users/zhangdong/code/kefu-fe/websdk/packages/sdk",n(n.s=157)}([function(e,t,n){"use strict";e.exports=function(e){return e&&e.__esModule?e:{default:e}}},,,function(e,t,n){"use strict";var i=n(0)(n(5)),o=e.exports,r=n(95);o.LongBits=n(66),o.Long=n(159),o.pool=n(160),o.float=n(161),o.asPromise=n(162),o.EventEmitter=n(163),o.path=n(164),o.base64=n(96),o.utf8=n(39),o.compareFieldsById=function(e,t){return e.id-t.id},o.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),i=0;i<t.length;)n[i]=e[t[i++]];return n}return[]},o.toObject=function(e){for(var t={},n=0;n<e.length;){var i=e[n++],o=e[n++];void 0!==o&&(t[i]=o)}return t},o.isString=function(e){return"string"==typeof e||e instanceof String},o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.isObject=function(e){return e&&"object"===(0,i.default)(e)},o.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,o.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},o.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},o.merge=function(e,t,n){for(var i=Object.keys(t),o=0;o<i.length;++o)void 0!==e[i[o]]&&n||(e[i[o]]=t[i[o]]);return e},o.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(o.decorateRoot.remove(e.$type),e.$type.name=t,o.decorateRoot.add(e.$type)),e.$type;Type||(Type=n(22));var i=new Type(t||e.name);return o.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i},o.emptyArray=Object.freeze?Object.freeze([]):[],o.emptyObject=Object.freeze?Object.freeze({}):{},o.longToHash=function(e){return e?o.LongBits.from(e).toHash():o.LongBits.zeroHash},o.copy=function(e){if("object"!=(0,i.default)(e))return e;var t={};for(var n in e)t[n]=e[n];return t},o.deepCopy=function e(t){if("object"!=(0,i.default)(t))return t;var n={};for(var o in t)n[o]=e(t[o]);return n},o.ProtocolError=function(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&merge(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t},o.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},o.Buffer=null,o.newBuffer=function(e){return"number"==typeof e?new o.Array(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},o.stringToBytes=function(e){var t,n,i=[];t=e.length;for(var o=0;o<t;o++)(n=e.charCodeAt(o))>=65536&&n<=1114111?(i.push(n>>18&7|240),i.push(n>>12&63|128),i.push(n>>6&63|128),i.push(63&n|128)):n>=2048&&n<=65535?(i.push(n>>12&15|224),i.push(n>>6&63|128),i.push(63&n|128)):n>=128&&n<=2047?(i.push(n>>6&31|192),i.push(63&n|128)):i.push(255&n);return i},o.byteToString=function(e){if("string"==typeof e)return e;for(var t="",n=e,i=0;i<n.length;i++){var o=n[i].toString(2),r=o.match(/^1+?(?=0)/);if(r&&8==o.length){for(var s=r[0].length,a=n[i].toString(2).slice(7-s),c=1;c<s;c++)a+=n[c+i].toString(2).slice(2);t+=String.fromCharCode(parseInt(a,2)),i+=s-1}else t+=String.fromCharCode(n[i])}return t},o.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Object.defineProperty(o,"decorateRoot",{get:function(){return r.decorated||(r.decorated=new(n(40)))}})},,function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?e.exports=r=function(e){return o(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":o(e)},r(t)}e.exports=r},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){return{WEBIM_CONNCTION_USER_NOT_ASSIGN_ERROR:0,WEBIM_CONNCTION_OPEN_ERROR:1,WEBIM_CONNCTION_AUTH_ERROR:2,WEBIM_CONNCTION_OPEN_USERGRID_ERROR:3,WEBIM_CONNCTION_ATTACH_ERROR:4,WEBIM_CONNCTION_ATTACH_USERGRID_ERROR:5,WEBIM_CONNCTION_REOPEN_ERROR:6,WEBIM_CONNCTION_SERVER_CLOSE_ERROR:7,WEBIM_CONNCTION_SERVER_ERROR:8,WEBIM_CONNCTION_IQ_ERROR:9,WEBIM_CONNCTION_USER_REMOVED:207,WEBIM_CONNCTION_USER_LOGIN_ANOTHER_DEVICE:206,WEBIM_CONNCTION_USER_KICKED_BY_CHANGE_PASSWORD:216,WEBIM_CONNCTION_USER_KICKED_BY_OTHER_DEVICE:217,WEBIM_CONNCTION_PING_ERROR:10,WEBIM_CONNCTION_NOTIFYVERSION_ERROR:11,WEBIM_CONNCTION_GETROSTER_ERROR:12,WEBIM_CONNCTION_CROSSDOMAIN_ERROR:13,WEBIM_CONNCTION_LISTENING_OUTOF_MAXRETRIES:14,WEBIM_CONNCTION_RECEIVEMSG_CONTENTERROR:15,WEBIM_CONNCTION_DISCONNECTED:16,WEBIM_CONNCTION_AJAX_ERROR:17,WEBIM_CONNCTION_JOINROOM_ERROR:18,WEBIM_CONNCTION_GETROOM_ERROR:19,WEBIM_CONNCTION_GETROOMINFO_ERROR:20,WEBIM_CONNCTION_GETROOMMEMBER_ERROR:21,WEBIM_CONNCTION_GETROOMOCCUPANTS_ERROR:22,WEBIM_CONNCTION_LOAD_CHATROOM_ERROR:23,WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR:24,WEBIM_CONNCTION_JOINCHATROOM_ERROR:25,WEBIM_CONNCTION_QUITCHATROOM_ERROR:26,WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR:27,WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR:28,WEBIM_CONNCTION_SESSIONID_NOT_ASSIGN_ERROR:29,WEBIM_CONNCTION_RID_NOT_ASSIGN_ERROR:30,WEBIM_CONNCTION_CALLBACK_INNER_ERROR:31,WEBIM_CONNCTION_CLIENT_OFFLINE:32,WEBIM_CONNCTION_CLIENT_LOGOUT:33,WEBIM_CONNCTION_CLIENT_TOO_MUCH_ERROR:34,WEBIM_CONNECTION_ACCEPT_INVITATION_FROM_GROUP:35,WEBIM_CONNECTION_DECLINE_INVITATION_FROM_GROUP:36,WEBIM_CONNECTION_ACCEPT_JOIN_GROUP:37,WEBIM_CONNECTION_DECLINE_JOIN_GROUP:38,WEBIM_CONNECTION_CLOSED:39,WEBIM_CONNECTION_ERROR:40,WEBIM_UPLOADFILE_BROWSER_ERROR:100,WEBIM_UPLOADFILE_ERROR:101,WEBIM_UPLOADFILE_NO_LOGIN:102,WEBIM_UPLOADFILE_NO_FILE:103,WEBIM_DOWNLOADFILE_ERROR:200,WEBIM_DOWNLOADFILE_NO_LOGIN:201,WEBIM_DOWNLOADFILE_BROWSER_ERROR:202,WEBIM_MESSAGE_REC_TEXT:300,WEBIM_MESSAGE_REC_TEXT_ERROR:301,WEBIM_MESSAGE_REC_EMOTION:302,WEBIM_MESSAGE_REC_PHOTO:303,WEBIM_MESSAGE_REC_AUDIO:304,WEBIM_MESSAGE_REC_AUDIO_FILE:305,WEBIM_MESSAGE_REC_VEDIO:306,WEBIM_MESSAGE_REC_VEDIO_FILE:307,WEBIM_MESSAGE_REC_FILE:308,WEBIM_MESSAGE_SED_TEXT:309,WEBIM_MESSAGE_SED_EMOTION:310,WEBIM_MESSAGE_SED_PHOTO:311,WEBIM_MESSAGE_SED_AUDIO:312,WEBIM_MESSAGE_SED_AUDIO_FILE:313,WEBIM_MESSAGE_SED_VEDIO:314,WEBIM_MESSAGE_SED_VEDIO_FILE:315,WEBIM_MESSAGE_SED_FILE:316,WEBIM_MESSAGE_SED_ERROR:317,STATUS_INIT:400,STATUS_DOLOGIN_USERGRID:401,STATUS_DOLOGIN_IM:402,STATUS_OPENED:403,STATUS_CLOSING:404,STATUS_CLOSED:405,STATUS_ERROR:406,GROUP_NOT_EXIST:605,GROUP_NOT_JOINED:602,MESSAGE_RECALL_TIME_LIMIT:504,SERVICE_NOT_ENABLED:505,SERVICE_NOT_ALLOW_MESSAGING:506,SERVER_UNKNOWN_ERROR:503,MESSAGE_INCLUDE_ILLEGAL_CONTENT:501,PERMISSION_DENIED:603,WEBIM_LOAD_MSG_ERROR:604,SDK_RUNTIME_ERROR:999}};t.default=i},function(e,t,n){"use strict";e.exports=o;var i=null;try{i=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function o(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}o.prototype.__isLong__,Object.defineProperty(o.prototype,"__isLong__",{value:!0}),o.isLong=r;var s={},a={};function c(e,t){var n,i,o;return t?(o=0<=(e>>>=0)&&e<256)&&(i=a[e])?i:(n=d(e,(0|e)<0?-1:0,!0),o&&(a[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(i=s[e])?i:(n=d(e,e<0?-1:0,!1),o&&(s[e]=n),n)}function u(e,t){if(isNaN(e))return t?y:v;if(t){if(e<0)return y;if(e>=m)return C}else{if(e<=-g)return x;if(e+1>=g)return I}return e<0?u(-e,t).neg():d(e%h|0,e/h|0,t)}function d(e,t,n){return new o(e,t,n)}o.fromInt=c,o.fromNumber=u,o.fromBits=d;var l=Math.pow;function f(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return v;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return f(e.substring(1),t,n).neg();for(var o=u(l(n,8)),r=v,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+a),n);if(a<8){var d=u(l(n,a));r=r.mul(d).add(u(c))}else r=(r=r.mul(o)).add(u(c))}return r.unsigned=t,r}function p(e,t){return"number"==typeof e?u(e,t):"string"==typeof e?f(e,t):d(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}o.fromString=f,o.fromValue=p;var h=4294967296,m=h*h,g=m/2,_=c(1<<24),v=c(0);o.ZERO=v;var y=c(0,!0);o.UZERO=y;var b=c(1);o.ONE=b;var w=c(1,!0);o.UONE=w;var S=c(-1);o.NEG_ONE=S;var I=d(-1,2147483647,!1);o.MAX_VALUE=I;var C=d(-1,-1,!0);o.MAX_UNSIGNED_VALUE=C;var x=d(0,-2147483648,!1);o.MIN_VALUE=x;var E=o.prototype;E.toInt=function(){return this.unsigned?this.low>>>0:this.low},E.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},E.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(x)){var t=u(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=u(l(e,6),this.unsigned),r=this,s="";;){var a=r.div(o),c=(r.sub(a.mul(o)).toInt()>>>0).toString(e);if((r=a).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},E.getHighBits=function(){return this.high},E.getHighBitsUnsigned=function(){return this.high>>>0},E.getLowBits=function(){return this.low},E.getLowBitsUnsigned=function(){return this.low>>>0},E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(x)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},E.isZero=function(){return 0===this.high&&0===this.low},E.eqz=E.isZero,E.isNegative=function(){return!this.unsigned&&this.high<0},E.isPositive=function(){return this.unsigned||this.high>=0},E.isOdd=function(){return 1==(1&this.low)},E.isEven=function(){return 0==(1&this.low)},E.equals=function(e){return r(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},E.eq=E.equals,E.notEquals=function(e){return!this.eq(e)},E.neq=E.notEquals,E.ne=E.notEquals,E.lessThan=function(e){return this.comp(e)<0},E.lt=E.lessThan,E.lessThanOrEqual=function(e){return this.comp(e)<=0},E.lte=E.lessThanOrEqual,E.le=E.lessThanOrEqual,E.greaterThan=function(e){return this.comp(e)>0},E.gt=E.greaterThan,E.greaterThanOrEqual=function(e){return this.comp(e)>=0},E.gte=E.greaterThanOrEqual,E.ge=E.greaterThanOrEqual,E.compare=function(e){if(r(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},E.comp=E.compare,E.negate=function(){return!this.unsigned&&this.eq(x)?x:this.not().add(b)},E.neg=E.negate,E.add=function(e){r(e)||(e=p(e));var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,c=e.low>>>16,u=0,l=0,f=0,h=0;return f+=(h+=o+(65535&e.low))>>>16,l+=(f+=i+c)>>>16,u+=(l+=n+a)>>>16,u+=t+s,d((f&=65535)<<16|(h&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},E.subtract=function(e){return r(e)||(e=p(e)),this.add(e.neg())},E.sub=E.subtract,E.multiply=function(e){if(this.isZero())return v;if(r(e)||(e=p(e)),i)return d(i.mul(this.low,this.high,e.low,e.high),i.get_high(),this.unsigned);if(e.isZero())return v;if(this.eq(x))return e.isOdd()?x:v;if(e.eq(x))return this.isOdd()?x:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(_)&&e.lt(_))return u(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,c=65535&e.high,l=e.low>>>16,f=65535&e.low,h=0,m=0,g=0,y=0;return g+=(y+=s*f)>>>16,m+=(g+=o*f)>>>16,g&=65535,m+=(g+=s*l)>>>16,h+=(m+=n*f)>>>16,m&=65535,h+=(m+=o*l)>>>16,m&=65535,h+=(m+=s*c)>>>16,h+=t*f+n*l+o*c+s*a,d((g&=65535)<<16|(y&=65535),(h&=65535)<<16|(m&=65535),this.unsigned)},E.mul=E.multiply,E.divide=function(e){if(r(e)||(e=p(e)),e.isZero())throw Error("division by zero");var t,n,o;if(i)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?d((this.unsigned?i.div_u:i.div_s)(this.low,this.high,e.low,e.high),i.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:v;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return w;o=y}else{if(this.eq(x))return e.eq(b)||e.eq(S)?x:e.eq(x)?b:(t=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?b:S:(n=this.sub(e.mul(t)),o=t.add(n.div(e)));if(e.eq(x))return this.unsigned?y:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=v}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),a=s<=48?1:l(2,s-48),c=u(t),f=c.mul(e);f.isNegative()||f.gt(n);)f=(c=u(t-=a,this.unsigned)).mul(e);c.isZero()&&(c=b),o=o.add(c),n=n.sub(f)}return o},E.div=E.divide,E.modulo=function(e){return r(e)||(e=p(e)),i?d((this.unsigned?i.rem_u:i.rem_s)(this.low,this.high,e.low,e.high),i.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},E.mod=E.modulo,E.rem=E.modulo,E.not=function(){return d(~this.low,~this.high,this.unsigned)},E.and=function(e){return r(e)||(e=p(e)),d(this.low&e.low,this.high&e.high,this.unsigned)},E.or=function(e){return r(e)||(e=p(e)),d(this.low|e.low,this.high|e.high,this.unsigned)},E.xor=function(e){return r(e)||(e=p(e)),d(this.low^e.low,this.high^e.high,this.unsigned)},E.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?d(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):d(0,this.low<<e-32,this.unsigned)},E.shl=E.shiftLeft,E.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?d(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):d(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},E.shr=E.shiftRight,E.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?d(this.low>>>e|t<<32-e,t>>>e,this.unsigned):d(32===e?t:t>>>e-32,0,this.unsigned)},E.shru=E.shiftRightUnsigned,E.shr_u=E.shiftRightUnsigned,E.toSigned=function(){return this.unsigned?d(this.low,this.high,!1):this},E.toUnsigned=function(){return this.unsigned?this:d(this.low,this.high,!0)},E.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},E.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},E.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},o.fromBytes=function(e,t,n){return n?o.fromBytesLE(e,t):o.fromBytesBE(e,t)},o.fromBytesLE=function(e,t){return new o(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},o.fromBytesBE=function(e,t){return new o(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},,function(e,t,n){"use strict";var i=n(0)(n(5));e.exports=s;var o=n(23);((s.prototype=Object.create(o.prototype)).constructor=s).className="Enum";var r=n(33);function s(e,t,n,r,s){if(o.call(this,e,n),t&&"object"!==(0,i.default)(t))throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=s||{},this.reserved=void 0,t)for(var a=Object.keys(t),c=0;c<a.length;++c)"number"==typeof t[a[c]]&&(this.valuesById[this.values[a[c]]=t[a[c]]]=a[c])}s.fromJSON=function(e,t){var n=new s(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return util.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},s.prototype.add=function(e,t,n){if(!util.isString(e))throw TypeError("name must be a string");if(!util.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=n||null,this},s.prototype.remove=function(e){if(!util.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},s.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},s.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)}},,,,function(e,n,i){"use strict";var o=i(0);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(i(5)),s=o(i(38)),a=o(i(57)),c=i(58),u=function(e){},d={},l=function(){function e(t,n,i){(0,s.default)(this,e),this.name=t||"defaultLogger",this.currentLevel=void 0,this.useCookiePersist=void 0,this.storageLogLevelKey="loglevel",this.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},this.logMethods=["trace","debug","info","warn","error"],this.methodFactory=i||this.defaultMethodFactory;var o=this._getPersistedLevel();null==o&&(o=null==n?"WARN":n),this.logs=[],this.config={useCache:!1,maxCache:3145728,color:"",background:""},this.logBytes=0,this.setLevel(o,!1)}return(0,a.default)(e,[{key:"setConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=e}},{key:"getLevel",value:function(){return this.currentLevel}},{key:"setLevel",value:function(e,t,n){if("string"==typeof e&&"undefined"!==this.levels[e.toUpperCase()]&&(e=this.levels[e.toUpperCase()]),!("number"==typeof e&&e>=0&&e<=this.levels.SILENT))throw"log.setLevel() called with invalid level: "+e;if(this.currentLevel=e,!1!==t&&this._persistLevel(e),this.replaceLoggingMethods(e,n),"undefined"==typeof console&&e<self.levels.SILENT)return"No console available for logging"}},{key:"setDefaultLevel",value:function(){_getPersistedLevel()||this.setLevel(level,!1)}},{key:"enableAll",value:function(e){this.setLevel(this.levels.TRACE,e)}},{key:"disableAll",value:function(e){this.setLevel(this.levels.SILENT,e)}},{key:"getLogs",value:function(){return this.logs}},{key:"download",value:function(){if("undefined"!=typeof window&&"undefined"!=typeof document){var e=this.getLogs().join("\n"),t=new Blob([e],{type:"text/plain;charset=UTF-8"}),n=window.URL.createObjectURL(t),i=(new FormData,document.createElement("a"));i.style.display="none",i.href=n,i.setAttribute("download","sdklog"),document.body.appendChild(i),i.click()}}},{key:"_bindMethod",value:function(e,t,n){var i=e[t];if(n)return this._cacheLog;if("function"==typeof i.bind)return i.bind(e);try{return Function.prototype.bind.call(i,e)}catch(t){return function(){return Function.prototype.apply.apply(i,[e,arguments])}}}},{key:"_cacheLog",value:function(){for(var e=(new Date).toLocaleString()+": ",t="",n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];i.forEach((function(e){"object"===(0,r.default)(e)?t+=JSON.stringify(e)+" ":t+=e+" "})),this._cacheLogCall(e+t)}},{key:"_cacheLogCall",value:function(e){var n=f(e),i=this.logBytes+n,o=this.config.maxCache;if(!(n>=o)){if(i<o)this.logBytes+=n;else for(var r=i-o,s=0;s<r;){var a=this.logs.shift();t("log","clearOutLog",a," at newSDK/wxsdk3.4.0.js:1"),"undefined"!==a&&(s+=f(a))}this.logs.push(e)}}},{key:"_getPersistedLevel",value:function(){var e;if("undefined"==typeof window)return t("warn","this lib can run in browser only!"," at newSDK/wxsdk3.4.0.js:1");if("undefined"===(e=window.localStorage[this.storageLogLevelKey])){var n=window.document.cookie,i=n.indexOf(encodeURIComponent(this.storageLogLevelKey));-1!==i&&(e=/^([^;]+)/.exec(n.slice(i))[1])}return e}},{key:"_persistLevel",value:function(e){var n=this.logMethods[e]||"SILENT";if("undefined"==typeof window)return t("warn","this lib can run in browser only!"," at newSDK/wxsdk3.4.0.js:1");window.localStorage[this.storageLogLevelKey]=n,this.useCookiePersist&&(window.document.cookie=encodeURIComponent(this.storageLogLevelKey)+"="+n+";")}},{key:"replaceLoggingMethods",value:function(e,t){for(var n=0;n<this.logMethods.length;n++){var i=this.logMethods[n];this[i]=n<e?u:this.methodFactory(i,e,t)}this.log=this.debug}},{key:"defaultMethodFactory",value:function(e,t,n){return this.realMethod(e)||this.enableLoggingWhenConsoleArrives.apply(this,arguments)}},{key:"realMethod",value:function(e){return"debug"===e&&(e="log"),"undefined"!=typeof console&&("trace"===e&&c.isIE?c.traceForIE:"undefined"!==console[e]?this._bindMethod(console,e,this.config.useCache):"undefined"!==console.log?this._bindMethod(console,"log",this.config.useCache):u)}},{key:"enableLoggingWhenConsoleArrives",value:function(e,t,n){return function(){"undefined"!=typeof console&&(replaceLoggingMethods.call(this,t,n),this[e].apply(this,arguments))}}}]),e}();function f(e){for(var t=e.length,n=0;n<e.length;n++)e.charCodeAt(n)>255&&t++;return t}var p=new l;p.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new l(e,p.getLevel(),p.methodFactory)),t};var h="undefined"!=typeof window?window.log:void 0;p.noConflict=function(){return"undefined"!=typeof window&&window.log===p&&(window.log=h),p},p.getLoggers=function(){return d};var m=p;n.default=m},,function(e,t,n){"use strict";var i=n(0)(n(5));e.exports=d;var o,r,s,a,c=n(23);((d.prototype=Object.create(c.prototype)).constructor=d).className="Field";var u=/^required|optional|repeated$/;function d(e,t,n,i,o,a,d){if(s.isObject(i)?(d=o,a=i,i=o=void 0):s.isObject(o)&&(d=a,a=o,o=void 0),c.call(this,e,a),!s.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!s.isString(n))throw TypeError("type must be a string");if(void 0!==i&&!u.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==o&&!s.isString(o))throw TypeError("extend must be a string");this.rule=i&&"optional"!==i?i:void 0,this.type=n,this.id=t,this.extend=o||void 0,this.required="required"===i,this.optional=!this.required,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!s.Long&&void 0!==r.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=d}d.fromJSON=function(e,t){return new d(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(d.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),d.prototype.setOption=function(e,t,n){return"packed"===e&&(this._packed=null),c.prototype.setOption.call(this,e,t,n)},d.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},d.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=r.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof a?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;s.utf8.write(this.typeDefault,e=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof a&&(this.parent.ctor.prototype[this.name]=this.defaultValue),c.prototype.resolve.call(this)},d.d=function(e,t,n,o){return"function"==typeof t?t=s.decorateType(t).name:t&&"object"===(0,i.default)(t)&&(t=s.decorateEnum(t).name),function(i,r){s.decorateType(i.constructor).add(new d(r,e,t,n,{default:o}))}},d._configure=function(){a=n(22),o=n(10),r=n(24),s=n(3)}},,,,,,function(e,t,n){"use strict";e.exports=v;var i,o,r,s,a,c,u,d,l,f,p,h,m,g,_=n(33);function v(e,t){_.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function y(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}((v.prototype=Object.create(_.prototype)).constructor=v).className="Type",Object.defineProperties(v.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],i=n.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=u.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=u.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=v.generateConstructor(this))},set:function(e){var t=e.prototype;t instanceof r||((e.prototype=new r).constructor=e,u.merge(e.prototype,t)),e.$type=e.prototype.$type=this,u.merge(e,r,!0),u.merge(e.prototype,r,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var i={};for(n=0;n<this.oneofsArray.length;++n){var o=this._oneofsArray[n].resolve().name,s=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=0;return{setter:function(n){if(!(e.indexOf(n)<0)){t[n]=1;for(var i=0;i<e.length;++i)e[i]!==n&&delete this[e[i]]}},getter:function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}}}(this._oneofsArray[n].oneof);i[o]={get:s.getter,set:s.setter}}n&&Object.defineProperties(e.prototype,i)}}}),v.generateConstructor=function(e){return function(t){for(var n,i=0;i<e.fieldsArray.length;i++)(n=e._fieldsArray[i]).map?this[n.name]={}:n.repeated&&(this[n.name]=[]);if(t)for(var o=Object.keys(t),r=0;r<o.length;++r)null!=t[o[r]]&&(this[o[r]]=t[o[r]])}},v.fromJSON=function(e,t){var n=new v(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var r=Object.keys(t.fields),a=0;a<r.length;++a)n.add((void 0!==t.fields[r[a]].keyType?g.fromJSON:o.fromJSON)(r[a],t.fields[r[a]]));if(t.oneofs)for(r=Object.keys(t.oneofs),a=0;a<r.length;++a)n.add(s.fromJSON(r[a],t.oneofs[r[a]]));if(t.nested)for(r=Object.keys(t.nested),a=0;a<r.length;++a){var c=t.nested[r[a]];n.add((void 0!==c.id?o.fromJSON:void 0!==c.fields?v.fromJSON:void 0!==c.values?i.fromJSON:void 0!==c.methods?p.fromJSON:_.fromJSON)(r[a],c))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},v.prototype.toJSON=function(e){var t=_.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return{options:t&&t.options||void 0,oneofs:_.arrayToJSON(this.oneofsArray,e),fields:_.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},extensions:this.extensions&&this.extensions.length?this.extensions:void 0,reserved:this.reserved&&this.reserved.length?this.reserved:void 0,group:this.group||void 0,nested:t&&t.nested||void 0,comment:n?this.comment:void 0}},v.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return _.prototype.resolveAll.call(this)},v.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},v.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof o&&void 0===e.extend){if(this._fieldsById&&this._fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),y(this)}return e instanceof s?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),y(this)):_.prototype.add.call(this,e)},v.prototype.remove=function(e){if(e instanceof o&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),y(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),y(this)}return _.prototype.remove.call(this,e)},v.prototype.isReservedId=function(e){return _.isReservedId(this.reserved,e)},v.prototype.isReservedName=function(e){return _.isReservedName(this.reserved,e)},v.prototype.create=function(e){return new this.ctor(e)},v.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=l(this)({Writer:a,types:t,util:u}),this.decode=f(this)({Reader:c,types:t,util:u}),this.verify=d(this)({types:t,util:u}),this.fromObject=m.fromObject(this)({types:t,util:u}),this.toObject=m.toObject(this)({types:t,util:u});var i=h[e];if(i){var o=Object.create(this);o.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(o),o.toObject=this.toObject,this.toObject=i.toObject.bind(o)}return this},v.prototype.encode=function(e,t){return this.setup().encode(e,t)},v.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},v.prototype.decode=function(e,t){return this.setup().decode(e,t)},v.prototype.decodeDelimited=function(e){return e instanceof c||(e=c.create(e)),this.decode(e,e.uint32())},v.prototype.verify=function(e){return this.setup().verify(e)},v.prototype.fromObject=function(e){return this.setup().fromObject(e)},v.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},v.d=function(e){return function(t){u.decorateType(t,e)}},v._configure=function(){i=n(10),o=n(16),r=n(69),s=n(34),a=n(94),c=n(101),u=n(3),d=n(102),l=n(103),f=n(104),p=n(41),h=n(105),m=n(106),g=n(67)}},function(e,t,n){"use strict";var i,o;function r(e,t){if(!i.isString(e))throw TypeError("name must be a string");if(t&&!i.isObject(t))throw TypeError("options must be an object");this.options=t,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}e.exports=r,r.className="ReflectionObject",Object.defineProperties(r.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),r.prototype.toJSON=function(){throw Error()},r.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof o&&t._handleAdd(this)},r.prototype.onRemove=function(e){var t=e.root;t instanceof o&&t._handleRemove(this),this.parent=null,this.resolved=!1},r.prototype.resolve=function(){return this.resolved||this.root instanceof o&&(this.resolved=!0),this},r.prototype.getOption=function(e){if(this.options)return this.options[e]},r.prototype.setOption=function(e,t,n){return n&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},r.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),i=0;i<n.length;++i)this.setOption(n[i],e[n[i]],t);return this},r.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},r._configure=function(e){o=n(40),i=n(3)}},function(e,t,n){"use strict";var i=e.exports,o=n(3),r=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function s(e,t){var n=0,i={};for(t|=0;n<e.length;)i[r[n+t]]=e[n++];return i}i.basic=s([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),i.defaults=s([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",o.emptyArray,null]),i.long=s([0,0,0,1,1],7),i.mapKey=s([0,0,0,5,5,0,0,0,1,1,0,2],2),i.packed=s([1,5,0,0,0,5,5,0,0,0,1,1,0]),i._configure=function(){o=n(3)}},,,,function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){var e="object"===i(t)&&null!==t&&"number"!=typeof t.nodeType?t:"undefined"!=typeof self?self:$.global,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidCharacterError",e.btoa||(e.btoa=function(e){for(var t,i,r=String(e),s=0,a=n,c="";r.charAt(0|s)||(a="=",s%1);c+=a.charAt(63&t>>8-s%1*8)){if((i=r.charCodeAt(s+=3/4))>255)throw new o("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|i}return c}),e.atob||(e.atob=function(e){var t=String(e).replace(/[=]+$/,"");if(t.length%4==1)throw new o("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,r,s=0,a=0,c="";r=t.charAt(a++);~r&&(i=s%4?64*i+r:r,s++%4)?c+=String.fromCharCode(255&i>>(-2*s&6)):0)r=n.indexOf(r);return c})}()},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function e(t,n){return!this instanceof e?new e(t):(this._msg={},"function"==typeof e[t]&&(e[t].prototype.setGroup=this.setGroup,e[t].prototype.setChatType=this.setChatType,this._msg=new e[t](n)),this._msg)};i.prototype.setGroup=function(e){this.body.group=e},i.prototype.setChatType=function(e){this.body.chatType=e},i.prototype._utils={},(i.read=function(e){this.id=e,this.type="read"}).prototype.set=function(e){this.body={id:this.id,type:this.type,ackId:e.id,to:e.to,from:e.from||""},e.msgConfig&&(this.body.msgConfig=e.msgConfig),e.ackContent&&(this.body.ackContent=e.ackContent)},(i.delivery=function(e){this.id=e,this.type="delivery"}).prototype.set=function(e){this.body={id:this.id,type:this.type,ackId:e.ackId,to:e.to,from:e.from||""}},(i.txt=function(e){this.id=e,this.type="txt",this.body={}}).prototype.set=function(e){this.value=e.msg,this.body={id:this.id,to:e.to,from:e.from||"",msg:this.value,type:this.type,roomType:e.roomType||!1,ext:e.ext||{},success:e.success,fail:e.fail,chatType:e.chatType||"singleChat"},e.msgConfig&&(this.body.msgConfig=e.msgConfig)},(i.cmd=function(e){this.id=e,this.type="cmd",this.body={}}).prototype.set=function(e){this.body={id:this.id,to:e.to,from:e.from||"",action:e.action,type:this.type,roomType:e.roomType||!1,chatType:e.chatType||"singleChat",ext:e.ext||{},success:e.success,fail:e.fail}},(i.custom=function(e){this.id=e,this.type="custom",this.body={}}).prototype.set=function(e){this.body={id:this.id,to:e.to,from:e.from||"",customEvent:e.customEvent,customExts:e.customExts,type:this.type,roomType:e.roomType||!1,chatType:e.chatType||"singleChat",ext:e.ext||{},success:e.success,fail:e.fail}},(i.location=function(e){this.id=e,this.type="loc",this.body={}}).prototype.set=function(e){this.body={id:this.id,to:e.to,from:e.from||"",type:this.type,roomType:e.roomType||!1,chatType:e.chatType||"singleChat",addr:e.addr,lat:e.lat,lng:e.lng,ext:e.ext||{},success:e.success,fail:e.fail}},(i.img=function(e){this.id=e,this.type="img",this.body={}}).prototype.set=function(e){e.file=e.file||i.prototype._utils.getFileUrl(e.fileInputId),this.value=e.file,this.body={id:this.id,file:this.value,apiUrl:e.apiUrl,to:e.to,from:e.from||"",type:this.type,ext:e.ext||{},roomType:e.roomType||!1,chatType:e.chatType||"singleChat",onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,success:e.success,fail:e.fail,flashUpload:e.flashUpload,width:e.width,height:e.height,body:e.body,uploadError:e.uploadError,uploadComplete:e.uploadComplete}},(i.audio=function(e){this.id=e,this.type="audio",this.body={}}).prototype.set=function(e){e.file=e.file||i.prototype._utils.getFileUrl(e.fileInputId),this.value=e.file,this.filename=e.filename||this.value.filename,this.body={id:this.id,file:this.value,filename:this.filename,apiUrl:e.apiUrl,to:e.to,from:e.from||"",type:this.type,ext:e.ext||{},length:e.length||0,roomType:e.roomType||!1,chatType:e.chatType||"singleChat",file_length:e.file_length,onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,success:e.success,fail:e.fail,flashUpload:e.flashUpload,body:e.body}},(i.file=function(e){this.id=e,this.type="file",this.body={}}).prototype.set=function(e){e.file=e.file||i.prototype._utils.getFileUrl(e.fileInputId),this.value=e.file,this.filename=e.filename||this.value.filename,this.body={id:this.id,file:this.value,filename:this.filename,apiUrl:e.apiUrl,to:e.to,from:e.from||"",type:this.type,ext:e.ext||{},roomType:e.roomType||!1,chatType:e.chatType||"singleChat",onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,success:e.success,fail:e.fail,flashUpload:e.flashUpload,body:e.body}},(i.video=function(e){this.id=e,this.type="video",this.body={}}).prototype.set=function(e){e.file=e.file||i.prototype._utils.getFileUrl(e.fileInputId),this.value=e.file,this.filename=e.filename||this.value.filename,this.body={id:this.id,file:this.value,filename:this.filename,apiUrl:e.apiUrl,to:e.to,from:e.from||"",type:this.type,ext:e.ext||{},length:e.length||0,roomType:e.roomType||!1,chatType:e.chatType||"singleChat",file_length:e.file_length,onFileUploadError:e.onFileUploadError,onFileUploadComplete:e.onFileUploadComplete,success:e.success,fail:e.fail,flashUpload:e.flashUpload,body:e.body}};var o=i;t.default=o},function(e,t,n){"use strict";var i=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=i(n(5)),s=i(n(14)).default.getLogger("IM-SDK-LOG");function a(e){if(e&&"object"==(0,r.default)(e)){var t=[],n=this.context.root.lookup("easemob.pb.KeyValue"),i=[];for(var o in e){var s=n.decode(t);s.key=o,"object"==(0,r.default)(e[o])?(s.type=8,s.stringValue=JSON.stringify(e[o])):"string"==typeof e[o]?(s.type=7,s.stringValue=e[o]):"boolean"==typeof e[o]?(s.type=1,s.varintValue=1==e[o]?1:0):Number.isInteger(e[o])?(s.type=2,s.varintValue=e[o]):(s.type=6,s.doubleValue=e[o]),i.push(s)}return i}}var c=function(e,t){var n=e.id;s.debug("\u2b06\ufe0e messageOption: ",e);var i=[],o=t.context.root.lookup("easemob.pb.MessageBody.Content").decode(i),c=t.context.root.lookup("easemob.pb.KeyValue"),u=[],d=!e.group&&!e.roomType&&"chatRoom"!=e.chatType&&"chatroom"!=e.chatType&&"groupChat"!=e.chatType&&"groupchat"!=e.chatType||"singleChat"===e.chatType&&!e.group,l=e.group&&!e.roomType||"groupChat"===e.chatType||"groupchat"===e.chatType,f=e.group&&e.roomType||"chatRoom"===e.chatType||"chatroom"===e.chatType;switch(e.type){case"txt":o.type=0,o.text=e.msg;break;case"img":o.type=1,o.displayName=e.body.filename,o.remotePath=e.body.url,o.secretKey=e.body.secret,o.fileLength=e.body.file_length,o.size=e.body.size,o.thumbnailDisplayName=e.body.filename;break;case"video":o.type=2,o.displayName=e.body.filename,o.remotePath=e.body.url,o.secretKey=e.body.secret,o.fileLength=e.body.file_length,o.duration=e.body.length,o.thumbnailDisplayName=e.body.filename;break;case"loc":o.type=3,o.latitude=e.lat,o.longitude=e.lng,o.address=e.addr,o.latitude=e.lat;break;case"audio":o.type=4,o.displayName=e.body.filename,o.remotePath=e.body.url,o.secretKey=e.body.secret,o.fileLength=e.body.file_length,o.duration=e.body.length,o.thumbnailDisplayName=e.body.filename;break;case"file":o.type=5,o.displayName=e.body.filename,o.remotePath=e.body.url,o.secretKey=e.body.secret,o.fileLength=e.body.file_length,o.size=e.body.size,o.thumbnailDisplayName=e.body.filename;break;case"cmd":o.type=6,o.action=e.action;break;case"custom":o.type=7,o.customEvent=e.customEvent,o.customExts=a.call(t,e.customExts)}if(e.ext)for(var p in e.ext){var h=c.decode(i);h.key=p,"object"==(0,r.default)(e.ext[p])?(h.type=8,h.stringValue=JSON.stringify(e.ext[p])):"string"==typeof e.ext[p]?(h.type=7,h.stringValue=e.ext[p]):"boolean"==typeof e.ext[p]?(h.type=1,h.varintValue=1==e.ext[p]?1:0):Number.isInteger(e.ext[p])?(h.type=2,h.varintValue=e.ext[p]):(h.type=6,h.doubleValue=e.ext[p]),u.push(h)}var m=t.context.root.lookup("easemob.pb.MessageBody"),g=m.decode(i);"recall"===e.type?(g.type=6,g.from={name:t.context.jid.name},g.to={name:e.to},g.ackMessageId=e.ackId):"delivery"===e.type?(g.type=5,g.from={name:t.context.jid.name},g.to={name:e.to},g.ackMessageId=e.ackId):"read"===e.type?(g.type=4,g.from={name:t.context.jid.name},g.to={name:e.to},g.ackMessageId=e.ackId,e.msgConfig&&l&&(g.msgConfig=e.msgConfig,g.ackContent=e.ackContent)):d?(g.type=1,g.from={name:t.context.jid.name},g.to={name:e.to}):l?(g.type=2,g.from={name:t.context.jid.name},g.to={name:e.to},e.msgConfig&&(g.msgConfig=e.msgConfig)):f&&(g.type=3,g.from={name:t.context.jid.name},g.to={name:e.to}),g.contents=[o],g.ext=u,g=m.encode(g).finish();var _=t.context.root.lookup("easemob.pb.Meta").decode(i);if(_.id=e.id,"recall"===e.type){_.from=t.context.jid;var v="easemob.com";(l||f)&&(v="conference.easemob.com"),_.to={appKey:t.appKey,name:e.to,domain:v}}else"delivery"===e.type?(_.from=t.context.jid,_.to={appKey:t.appKey,name:e.to,domain:"easemob.com"}):"read"===e.type?(_.from=t.context.jid,v="easemob.com",l&&(v="conference.easemob.com"),_.to={appKey:t.appKey,name:e.to,domain:v}):d?(_.from=t.context.jid,_.to={appKey:t.appKey,name:e.to,domain:"easemob.com"}):(l||f)&&(_.from={appKey:t.appKey,name:t.user,domain:"conference.easemob.com"},_.to={appKey:t.appKey,name:e.to,domain:"conference.easemob.com"});_.ns=1,_.payload=g,s.debug("\u2b06\ufe0e thirdMessage: ",_);var y=t.context.root.lookup("easemob.pb.CommSyncUL"),b=y.decode(i);b.meta=_,b=y.encode(b).finish();var w=t.context.root.lookup("easemob.pb.MSync"),S=w.decode(i);S.version=t.version,S.encryptType=t.encryptType,S.command=0,S.guid=t.context.jid,S.payload=b,s.debug("\u2b06\ufe0e MSync: ",S),S=w.encode(S).finish(),t.sendMSync(S,n)},u=function(e,t,n){o=n;var i=t||this;if(i.msg=e,!e.file)return c(i.msg,t);if(i.msg.body&&i.msg.body.url)return c(i.msg,t);var r=i.msg.onFileUploadComplete;i.msg.onFileUploadComplete=function(e){if(e.entities[0]["file-metadata"]){var n=e.entities[0]["file-metadata"]["content-length"];i.msg.filetype=e.entities[0]["file-metadata"]["content-type"],n>204800&&(i.msg.thumbnail=!0)}i.msg.body={type:i.msg.type||"file",url:(t.isHttpDNS?t.apiUrl+e.uri.substr(e.uri.indexOf("/",9)):e.uri)+"/"+e.entities[0].uuid,secret:e.entities[0]["share-secret"],filename:i.msg.file.filename||i.msg.filename,size:{width:i.msg.width||0,height:i.msg.height||0},length:i.msg.length||0,file_length:i.msg.ext.file_length||0,filetype:i.msg.filetype||i.msg.file.filetype},c(i.msg,t),r instanceof Function&&r(e,i.msg.id)},o.uploadFile.call(t,i.msg)};t.default=u},function(e,t,n){"use strict";var i=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(8)),r=(i(n(31)),i(n(7))),s=(i(n(30)),i(n(59))),a=i(n(14)).default.getLogger("IM-SDK-LOG"),c=(0,r.default)(),u={0:"TEXT",1:"IMAGE",2:"VIDEO",3:"LOCATION",4:"VOICE",5:"FILE",6:"COMMAND",7:"CUSTOM"},d=function(e){if(e){for(var t=e,n={},i=0;i<t.length;i++)if(8==t[i].type)n[t[i].key]=JSON.parse(t[i].stringValue);else if(7==t[i].type)n[t[i].key]=t[i].stringValue;else if(6==t[i].type)n[t[i].key]=t[i].doubleValue;else if(5==t[i].type)n[t[i].key]=t[i].floatValue;else if(1==t[i].type){var r=t[i].varintValue,s=new o.default(r.low,r.high,r.unsigned).toString();n[t[i].key]=0!==Number(s)}else 2!=t[i].type&&3!=t[i].type&&4!=t[i].type||(r=t[i].varintValue,s=new o.default(r.low,r.high,r.unsigned).toString(),n[t[i].key]=Number(s));return n}},l=function(e,t,n,i){var r=n,l=new o.default(e.timestamp.low,e.timestamp.high,e.timestamp.unsigned).toString(),f=r.context.root.lookup("easemob.pb.MessageBody").decode(e.payload),p=new o.default(e.id.low,e.id.high,e.id.unsigned).toString(),h=f.ackMessageId?new o.default(f.ackMessageId.low,f.ackMessageId.high,f.ackMessageId.unsigned).toString():"",m=null,g=f.from.name,_=f.to.name;if(a.debug("\u2b07thirdMessage\uff1a",f),1===f.type)m="chat";else if(2===f.type)m="groupchat";else if(3===f.type)m="chatroom";else{if(4===f.type)return m="read_ack",f.msgConfig?void n.onReadMessage({from:g,to:_,mid:h,groupReadCount:f.ext[0]&&JSON.parse(f.ext[0].stringValue),ackContent:f.ackContent}):void n.onReadMessage({from:g,to:_,mid:h});if(5===f.type)return m="deliver_ack",void n.onDeliverdMessage({from:g,to:_,mid:h});if(6===f.type)return m="recall",void n.onRecallMessage({from:g,to:_,mid:h})}for(var v=0;v<f.contents.length;v++){var y={},b=t.errorCode>0,w=t.errorCode,S=t.reason,I=f.contents[v],C={};f.ext&&(C=d(f.ext));try{switch(I.type){case 0:var x=f.contents[v].text;if(!E)var E={};var O=s.default.parseTextMessage(x,E&&E.Emoji);O.isemoji?(!(y={id:p,type:m,contentsType:"EMOJI",from:g,to:_,data:O.body,ext:C,time:l,msgConfig:f.msgConfig}).delay&&delete y.delay,!y.msgConfig&&delete f.msgConfig,y.error=b,y.errorText=S,y.errorCode=w,!i&&r.onEmojiMessage(y)):(!(y={id:p,type:m,contentsType:u[I.type],from:g,to:_,data:I.text,ext:C,sourceMsg:I.text,time:l,msgConfig:f.msgConfig}).msgConfig&&delete f.msgConfig,y.error=b,y.errorText=S,y.errorCode=w,!i&&n.onTextMessage(y));break;case 1:if(I.size)var T=I.size.width||0,N=I.size.height||0;var R=n.useOwnUploadFun?I.remotePath:(I.remotePath&&r.apiUrl+I.remotePath.substr(I.remotePath.indexOf("/",9)))+"?em-redirect=true";!(y={id:p,type:m,contentsType:u[I.type],from:g,to:_,url:R,secret:I.secretKey,filename:I.displayName,thumb:I.thumbnailRemotePath,thumb_secret:I.thumbnailSecretKey,file_length:I.fileLength||"",width:T,height:N,filetype:I.filetype||"",accessToken:n.token||"",ext:C,time:l,msgConfig:f.msgConfig}).delay&&delete y.delay,!y.msgConfig&&delete f.msgConfig,y.error=b,y.errorText=S,y.errorCode=w,!i&&n.onPictureMessage(y);break;case 2:R=n.useOwnUploadFun?I.remotePath:(I.remotePath&&r.apiUrl+I.remotePath.substr(I.remotePath.indexOf("/",9)))+"?em-redirect=true",!(y={id:p,type:m,contentsType:u[I.type],from:g,to:_,url:R,secret:I.secretKey,filename:I.displayName,length:I.duration||"",file_length:I.fileLength||"",filetype:I.filetype||"",accessToken:n.token||"",ext:C,time:l,msgConfig:f.msgConfig}).delay&&delete y.delay,!y.msgConfig&&delete f.msgConfig,y.error=b,y.errorText=S,y.errorCode=w,!i&&n.onVideoMessage(y);break;case 3:!(y={id:p,type:m,contentsType:u[I.type],from:g,to:_,addr:I.address,lat:I.latitude,lng:I.longitude,ext:C,time:l,msgConfig:f.msgConfig}).delay&&delete y.delay,!y.msgConfig&&delete f.msgConfig,y.error=b,y.errorText=S,y.errorCode=w,!i&&n.onLocationMessage(y);break;case 4:R=n.useOwnUploadFun?I.remotePath:(I.remotePath&&r.apiUrl+I.remotePath.substr(I.remotePath.indexOf("/",9)))+"?em-redirect=true",!(y={id:p,type:m,contentsType:u[I.type],from:g,to:_,url:R,secret:I.secretKey,filename:I.displayName,file_length:I.fileLength||"",accessToken:n.token||"",ext:C,length:I.duration,time:l,msgConfig:f.msgConfig}).delay&&delete y.delay,!y.msgConfig&&delete f.msgConfig,y.error=b,y.errorText=S,y.errorCode=w,!i&&n.onAudioMessage(y);break;case 5:R=n.useOwnUploadFun?I.remotePath:(I.remotePath&&r.apiUrl+I.remotePath.substr(I.remotePath.indexOf("/",9)))+"?em-redirect=true",!(y={id:p,type:m,contentsType:u[I.type],from:g,to:_,url:R,secret:I.secretKey,filename:I.displayName,file_length:I.fileLength,accessToken:n.token||"",ext:C,time:l,msgConfig:f.msgConfig}).delay&&delete y.delay,!y.msgConfig&&delete f.msgConfig,y.error=b,y.errorText=S,y.errorCode=w,!i&&n.onFileMessage(y);break;case 6:!(y={id:p,type:m,contentsType:u[I.type],from:g,to:_,action:I.action,ext:C,time:l,msgConfig:f.msgConfig}).msgConfig&&delete f.msgConfig,y.error=b,y.errorText=S,y.errorCode=w,!i&&n.onCmdMessage(y);break;case 7:var M="",k="";f.contents[0].customExts&&(M=d(f.contents[0].customExts)),f.contents[0].params&&(k=d(f.contents[0].params)),y={id:p,type:m,contentsType:u[I.type],from:g,to:_,customEvent:I.customEvent,params:k,customExts:M,ext:C,time:l},!i&&n.onCustomMessage(y)}}catch(e){n.onError({type:c.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,message:"parsing message error",data:e})}if(i||n.delivery)return y.message_type=m,y}};t.default=l},function(e,t,n){"use strict";e.exports=d;var i,o,r,s,a,c=n(23);function u(e,t){if(e&&e.length){for(var n={},i=0;i<e.length;++i)n[e[i].name]=e[i].toJSON(t);return n}}function d(e,t){c.call(this,e,t),this.nested=void 0,this._nestedArray=null}function l(e){return e._nestedArray=null,e}((d.prototype=Object.create(c.prototype)).constructor=d).className="Namespace",d.fromJSON=function(e,t){return new d(e,t.options).addJSON(t.nested)},d.arrayToJSON=u,d.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>=t)return!0;return!1},d.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(d.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=r.toArray(this.nested))}}),d.prototype.toJSON=function(e){return r.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},d.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),r=0;r<n.length;++r)t=e[n[r]],this.add((void 0!==t.fields?s.fromJSON:void 0!==t.values?i.fromJSON:void 0!==t.methods?a.fromJSON:void 0!==t.id?o.fromJSON:d.fromJSON)(n[r],t));return this},d.prototype.get=function(e){return this.nested&&this.nested[e]||null},d.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof i)return this.nested[e].values;throw Error("no such enum: "+e)},d.prototype.add=function(e){if(!(e instanceof o&&void 0!==e.extend||e instanceof s||e instanceof i||e instanceof a||e instanceof d))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof d&&e instanceof d)||t instanceof s||t instanceof a)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,r=0;r<n.length;++r)e.add(n[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),l(this)},d.prototype.remove=function(e){if(!(e instanceof c))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),l(this)},d.prototype.define=function(e,t){if(r.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;e.length>0;){var i=e.shift();if(n.nested&&n.nested[i]){if(!((n=n.nested[i])instanceof d))throw Error("path conflicts with non-namespace objects")}else n.add(n=new d(i))}return t&&n.addJSON(t),n},d.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof d?e[t++].resolveAll():e[t++].resolve();return this.resolve()},d.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),r.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var i=this.get(e[0]);if(i){if(1===e.length){if(!t||t.indexOf(i.constructor)>-1)return i}else if(i instanceof d&&(i=i.lookup(e.slice(1),t,!0)))return i}else for(var o=0;o<this.nestedArray.length;++o)if(this._nestedArray[o]instanceof d&&(i=this._nestedArray[o].lookup(e,t,!0)))return i;return null===this.parent||n?null:this.parent.lookup(e,t)},d.prototype.lookupType=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such type: "+e);return t},d.prototype.lookupEnum=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},d.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[s,i]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},d.prototype.lookupService=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},d._configure=function(){i=n(10),o=n(16),r=n(3),s=n(22),a=n(41)}},function(e,t,n){"use strict";e.exports=s;var i,o,r=n(23);function s(e,t,n,i){if(Array.isArray(t)||(n=t,t=void 0),r.call(this,e,n),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}((s.prototype=Object.create(r.prototype)).constructor=s).className="OneOf",s.fromJSON=function(e,t){return new s(e,t.oneof,t.options,t.comment)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},s.prototype.add=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,a(this),this},s.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},s.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this,this.fieldsArray.push(n))}a(this)},s.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},s.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){o.decorateType(t.constructor).add(new s(n,e)),Object.defineProperty(t,n,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}},s._configure=function(){i=n(16),o=n(3)}},,,,function(e,t,n){"use strict";e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";var i=e.exports;i.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},i.read=function(e,t,n){if(n-t<1)return"";for(var i,o=null,r=[],s=0;t<n;)(i=e[t++])<128?r[s++]=i:i>191&&i<224?r[s++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,r[s++]=55296+(i>>10),r[s++]=56320+(1023&i)):r[s++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,r)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,r.slice(0,s))),o.join("")):String.fromCharCode.apply(String,r.slice(0,s))},i.write=function(e,t,n){for(var i,o,r=n,s=0;s<e.length;++s)(i=e.charCodeAt(s))<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=e.charCodeAt(s+1)))?(i=65536+((1023&i)<<10)+(1023&o),++s,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-r}},function(e,n,i){"use strict";var o=i(0)(i(5));e.exports=p;var r=i(33);((p.prototype=Object.create(r.prototype)).constructor=p).className="Root";var s,a,c,u=i(16),d=i(10),l=i(34),f=i(3);function p(e){r.call(this,"",e),this.deferred=[],this.files=[],this.names=[]}function h(){}p.fromJSON=function(e,t){return e="string"==typeof e?JSON.parse(e):e,t||(t=new p),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},p.prototype.resolvePath=f.path.resolve,p.prototype.parseFromPbString=function e(n,i,r){"function"==typeof i&&(r=i,i=void 0);var s=this;if(!r)return f.asPromise(e,s,n,i);var u=null;if("string"==typeof n)u=JSON.parse(n);else{if("object"!==(0,o.default)(n))return void t("log","pb\u683c\u5f0f\u8f6c\u5316\u5931\u8d25"," at newSDK/wxsdk3.4.0.js:1");u=n}function d(e,t){if(r){var n=r;r=null,n(e,t)}}function l(e,t){try{if(f.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),f.isString(t)){a.filename=e;var n,o=a(t,s,i),r=0;if(o.imports)for(;r<o.imports.length;++r)p(n=o.imports[r]);if(o.weakImports){for(r=0;r<o.weakImports.length;++r)n=o.weakImports[r];p(n)}}else s.setOptions(t.options).addJSON(t.nested)}catch(e){d(e)}d(null,s)}function p(e){s.names.indexOf(e)>-1||(s.names.push(e),e in c&&l(e,c[e]))}l(u.name,u.pbJsonStr)},p.prototype.load=function e(t,n,i){"function"==typeof n&&(i=n,n=void 0);var o=this;if(!i)return f.asPromise(e,o,t,n);var r=i===h;function s(e,t){if(i){var n=i;if(i=null,r)throw e;n(e,t)}}function u(e,t){try{if(f.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),f.isString(t)){a.filename=e;var i,c=a(t,o,n),u=0;if(c.imports)for(;u<c.imports.length;++u)(i=o.resolvePath(e,c.imports[u]))&&d(i);if(c.weakImports)for(u=0;u<c.weakImports.length;++u)(i=o.resolvePath(e,c.weakImports[u]))&&d(i,!0)}else o.setOptions(t.options).addJSON(t.nested)}catch(e){s(e)}r||l||s(null,o)}function d(e,t){var n=e.lastIndexOf("google/protobuf/");if(n>-1){var a=e.substring(n);a in c&&(e=a)}if(!(o.files.indexOf(e)>-1))if(o.files.push(e),e in c)r?u(e,c[e]):(++l,setTimeout((function(){--l,u(e,c[e])})));else if(r){var d;try{d=f.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||s(e))}u(e,d)}else++l,f.fetch(e,(function(n,r){--l,i&&(n?t?l||s(null,o):s(n):u(e,r))}))}var l=0;f.isString(t)&&(t=[t]);for(var p,m=0;m<t.length;++m)(p=o.resolvePath("",t[m]))&&d(p);if(r)return o;l||s(null,o)},p.prototype.loadSync=function(e,t){if(!f.isNode)throw Error("not supported");return this.load(e,t,h)},p.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var m=/^[A-Z]/;function g(e,t){var n=t.parent.lookup(t.extend);if(n){var i=new u(t.fullName,t.id,t.type,t.rule,void 0,t.options);return i.declaringField=t,t.extensionField=i,n.add(i),!0}return!1}p.prototype._handleAdd=function(e){if(e instanceof u)void 0===e.extend||e.extensionField||g(0,e)||this.deferred.push(e);else if(e instanceof d)m.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof l)){if(e instanceof s)for(var t=0;t<this.deferred.length;)g(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);m.test(e.name)&&(e.parent[e.name]=e)}},p.prototype._handleRemove=function(e){if(e instanceof u){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof d)m.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);m.test(e.name)&&delete e.parent[e.name]}},p._configure=function(){s=i(22),a=i(97),c=i(100),u=i(16),d=i(10),l=i(34),f=i(3)}},function(e,t,n){"use strict";e.exports=a;var i,o,r,s=n(33);function a(e,t){s.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}((a.prototype=Object.create(s.prototype)).constructor=a).className="Service",a.fromJSON=function(e,t){var n=new a(e,t.options);if(t.methods)for(var o=Object.keys(t.methods),r=0;r<o.length;++r)n.add(i.fromJSON(o[r],t.methods[o[r]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},a.prototype.toJSON=function(e){var t=s.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||void 0,"methods",s.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),a.prototype.get=function(e){return this.methods[e]||s.prototype.get.call(this,e)},a.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return s.prototype.resolve.call(this)},a.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,c(this)):s.prototype.add.call(this,e)},a.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return s.prototype.remove.call(this,e)},a.prototype.create=function(e,t,n){for(var i,s=new r.Service(e,t,n),a=0;a<this.methodsArray.length;++a){var c=o.lcFirst((i=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");s[c]=o.codegen(["r","c"],o.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:i,q:i.resolvedRequestType.ctor,s:i.resolvedResponseType.ctor})}return s},a._configure=function(){i=n(68),o=n(3),r=n(99)}},,,,,,,,,,,,,function(e,n,i){"use strict";var o=i(0);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,s,a=o(i(55)),c=o(i(7)),u=o(i(30)),d=o(i(56)),l=o(i(31)),f=o(i(32)),p=o(i(60)),h=o(i(61)),m=o(i(62)),g=o(i(8)),_=o(i(63)),v=o(i(14)).default.getLogger("IM-SDK-LOG"),y={},b=(0,c.default)(),w=[],S=1,I=function(){},C=function e(t){if(!this instanceof e)return new e(t);t=t||{},this.isDebug=t.isDebug||!1,this.isHttpDNS=t.isHttpDNS||!1,this.isMultiLoginSessions=t.isMultiLoginSessions||!1,this.wait=t.wait||30,this.retry=t.retry||!1,this.https=t.https&&window&&"https:"===location.protocol,this.url=t.url,this.hold=t.hold||1,this.route=t.route||null,this.inactivity=t.inactivity||30,this.heartBeatWait=t.heartBeatWait||3e4,this.maxRetries=t.maxRetries||5,this.isAutoLogin=!1!==t.isAutoLogin,this.pollingTime=t.pollingTime||800,this.stropheConn=!1,this.autoReconnectNumMax=t.autoReconnectNumMax||0,this.autoReconnectNumTotal=0,this.autoReconnectInterval=t.autoReconnectInterval||0,this.context={status:b.STATUS_INIT},this.sendQueue=new d.default,this.intervalId=null,this.apiUrl=t.apiUrl||"",this.encrypt=t.encrypt||{encrypt:{type:"none"}},this.delivery=t.delivery||!1,this.appKey=t.appKey||"",this.domain=t.domain||"easemob.com",this.clientResource="84ff3eba1",this.user="",this.orgName="",this.appName="",this.token="",this.unSendMsgArr=[],this.dnsArr=["https://rs.easemob.com","http://182.92.174.78","http://112.126.66.111"],this.dnsIndex=0,this.dnsTotal=this.dnsArr.length,this.restHosts=[],this.restIndex=0,this.restTotal=0,this.socketHost=[],this.hostIndex=0,this.hostTotal=0,this.groupOption={},this.version=t.version||"3.0.0",this.compressAlgorimth=t.compressAlgorimth||0,this.userAgent=t.userAgent||0,this.pov=t.pov||0,this.command=t.command||3,this.deviceId=t.deviceId||"webim",this.encryptKey=t.encryptKey||"",this.firstPayload=t.firstPayload||[],this.compressType=t.compressType||[0],this.encryptType=t.encryptType||[0],this.osType=16,this.useOwnUploadFun=t.useOwnUploadFun||!1};C.prototype.registerUser=function(e){this.isHttpDNS?(this.dnsIndex=0,this.getHttpDNS(e,"signup")):this.signup(e)},C.prototype.listen=function(e){this.onOpened=e.onOpened||I,this.onClosed=e.onClosed||I,this.onTextMessage=e.onTextMessage||I,this.onEmojiMessage=e.onEmojiMessage||I,this.onPictureMessage=e.onPictureMessage||I,this.onAudioMessage=e.onAudioMessage||I,this.onVideoMessage=e.onVideoMessage||I,this.onFileMessage=e.onFileMessage||I,this.onLocationMessage=e.onLocationMessage||I,this.onCustomMessage=e.onCustomMessage||I,this.onCmdMessage=e.onCmdMessage||I,this.onStatisticMessage=e.onStatisticMessage||I,this.onPresence=e.onPresence||I,this.onRoster=e.onRoster||I,this.onError=e.onError||I,this.onReceivedMessage=e.onReceivedMessage||I,this.onInviteMessage=e.onInviteMessage||I,this.onDeliverdMessage=e.onDeliveredMessage||I,this.onReadMessage=e.onReadMessage||I,this.onRecallMessage=e.onRecallMessage||I,this.onMutedMessage=e.onMutedMessage||I,this.onOffline=e.onOffline||I,this.onOnline=e.onOnline||I,this.onConfirmPop=e.onConfirmPop||I,this.onCreateGroup=e.onCreateGroup||I,this.onContactAgreed=e.onContactAgreed||I,this.onContactRefuse=e.onContactRefuse||I,this.onContactInvited=e.onContactInvited||I,this.onContactDeleted=e.onContactDeleted||I,this.onContactAdded=e.onContactAdded||I,this.onUpdateMyGroupList=e.onUpdateMyGroupList||I,this.onUpdateMyRoster=e.onUpdateMyRoster||I,this.onBlacklistUpdate=e.onBlacklistUpdate||I,s._listenNetwork(this.onOnline,this.onOffline)},C.prototype.getParams=function(e){r=e.root,s=e.utils,C.prototype._utils=s,y.utils=s,y.statusCode=b,y.message=u.default,y.message.prototype._utils=s},C.prototype._msgHash={},C.prototype._queues=[],C.prototype._lastsession=function(e,t,n){var i=[],o=r.lookup("easemob.pb.CommSyncUL"),s=o.decode(i);s.queue=t,s.key=new g.default(e.low,e.high,e.unsigned).toString(),s=o.encode(s).finish(),v.debug("\u2b06\ufe0e_lastsession: ",s);var a=r.lookup("easemob.pb.MSync"),c=a.decode(i);if(c.version=n.version,c.encryptType=n.encryptType,c.command=0,c.payload=s,c=a.encode(c).finish(),n.sock.readyState!==S){var u={type:b.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected"};n.onError(u)}else n._base64transform(c,n)},C.prototype._metapayload=function(e,t,n){for(var i=0;i<e.length;i++){var o=new g.default(e[i].id.low,e[i].id.high,e[i].id.unsigned).toString();w.indexOf(o)<0&&(v.debug("\u4e0b\u884cmeta\uff1a",e[i]),1===e[i].ns?(0,f.default)(e[i],t,n):2===e[i].ns?(0,p.default)(e[i],t,n):3===e[i].ns?h.default.handleMessage(e[i],t,n):0===e[i].ns?(0,m.default)(e[i],t,n):4===e[i].ns&&n.registerConfrIQHandler&&n.registerConfrIQHandler(e[i],t,n),w.length<=100||w.shift(),w.push(o))}},C.prototype._rebuild=function(){var e=[],t=r.lookup("easemob.pb.StatisticsBody"),n=t.decode(e);n.operation=0,n=t.encode(n).finish();var i=r.lookup("easemob.pb.Meta").decode(e);i.id=(new Date).valueOf(),i.ns=0,i.payload=n;var o=r.lookup("easemob.pb.CommSyncUL"),s=o.decode(e);s.meta=i,v.debug("\u2b06\ufe0e rebuild: ",i),s=o.encode(s).finish();var a=r.lookup("easemob.pb.MSync"),c=a.decode(e);c.version=this.version,c.encryptType=[0],c.command=0,c.payload=s,c=a.encode(c).finish(),this._base64transform(c,this)},C.prototype._backqueue=function(e,t){var n=[],i=r.lookup("easemob.pb.CommSyncUL"),o=i.decode(n);o.queue=e,v.debug("\u2b06\ufe0equeue: ",o),o=i.encode(o).finish();var s=r.lookup("easemob.pb.MSync"),a=s.decode(n);a.version=t.version,a.encryptType=t.encryptType,a.command=0,a.payload=o,a=s.encode(a).finish(),t._base64transform(a,t)};var x=function(e){var t=r.lookup("easemob.pb.MSync"),n=t.decode([]);n.version=e.version,n.encryptType=e.encryptType,n.command=1,v.debug("\u2b06\ufe0eunreadDeal: ",n),n=t.encode(n).finish(),e._base64transform(n,e)};C.prototype._receiveProvision=function(e,n){var i=r.lookup("easemob.pb.Provision").decode(e.payload);n.context.jid.clientResource=i.resource,n.clientResource=i.resource,0==i.status.errorCode?(n.onOpened(),n.heartBeat(n),x(n),n._rebuild(n)):n.isDebug&&t("log","\u4e0b\u884cprovision\u5931\u8d25: ",i," at newSDK/wxsdk3.4.0.js:1")},C.prototype.heartBeatID=0,C.prototype.heartBeat=function(e){this.stopHeartBeat(),this.heartBeatID=setInterval((function(){x(e)}),this.heartBeatWait)},C.prototype.stopHeartBeat=function(){clearInterval(this.heartBeatID)},C.prototype.getRestFromHttpDNS=function(e,t){if(!(this.restIndex>this.restTotal)){var n="",i=this.restHosts[this.restIndex],o=i.domain,r=i.ip;if(r&&"http:"==location.protocol){var s=i.port;n=("https:"===location.protocol?"https:":"http:")+"//"+r+":"+s}else n=("https:"===location.protocol?"https:":"http:")+"//"+o;""!=n&&(this.apiUrl=n,e.apiUrl=n),"login"==t?this.login(e):this.signup(e)}},C.prototype.getHttpDNS=function(e,t){var n=this,i={url:this.dnsArr[this.dnsIndex]+"/easemob/server.json",dataType:"json",type:"GET",data:{app_key:encodeURIComponent(e.appKey||this.appKey)},success:function(i,o){var r=i.rest.hosts;if(r){for(var s=n.https?"https":"http",a=r.filter((function(e,t){if(e.protocol==s)return e})),c=0;c<a.length;c++)if(a[c].protocol===s){var u=a[c];a.splice(c,1),a.unshift(u)}n.restHosts=a,n.restTotal=a.length;try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){}var d=i["msync-ws"].hosts;if(d){var l=d.filter((function(e,t){if(e.protocol==s)return e}));for(c=0;c<l.length;c++)l[c].protocol===s&&(u=l[c],l.splice(c,1),l.unshift(u));n.socketHost=l,n.hostTotal=l.length,n.getRestFromHttpDNS(e,t)}}}||I,error:function(i,o,r){n.dnsIndex++,n.dnsIndex<n.dnsTotal&&n.getHttpDNS(e,t)}||I};s.ajax(i)},C.prototype.signup=function(e){v.debug("signup");var t=this,n=e.orgName||"",i=e.appName||"",o=e.appKey||this.appKey,r=e.success||I,a=e.error||I;if(!n&&!i&&o){var c=o.split("#");2===c.length&&(n=c[0],i=c[1])}if(n||i){e.https||this.https;var u=(e.apiUrl||this.apiUrl)+"/"+n+"/"+i+"/users",d={username:e.username,password:e.password,nickname:e.nickname||""},l={url:u,dataType:"json",data:s.stringify(d),success:r,error:function(n,i,o){if(t.isHttpDNS&&t.restIndex+1<t.restTotal)return t.restIndex++,void t.getRestFromHttpDNS(e,"signup");t.clear(),a(n)}};return s.ajax(l)}a({type:b.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR})},C.prototype.open=function(e){var t=e.appKey,n=t.split("#")[0],i=t.split("#")[1];this.orgName=n,this.appName=i,e.accessToken&&(this.token=e.accessToken),this.isHttpDNS?(this.dnsIndex=0,this.getHttpDNS(e,"login")):this.login(e)},C.prototype.login=function(e){if(this.user=e.user,function(e,t){if(""==(e=e||{}).user)return t.onError({type:b.WEBIM_CONNCTION_USER_NOT_ASSIGN_ERROR,message:"the user cannot be empty"}),!1;var n=e.user+""||"",i=e.appKey||"",o=i.split("#");if(2!==o.length)return t.onError({type:b.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR,message:"the appKey is illegal"}),!1;var s=o[0],a=o[1];return s&&a?(t.context.jid={appKey:i,name:n,domain:t.domain,clientResource:t.clientResource},t.context.root=r,t.context.userId=n,t.context.appKey=i,t.context.appName=a,t.context.orgName=s,!0):(t.onError({type:b.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR,message:"the appKey is illegal"}),!1)}(e,this)){var t=this;if(!t.isOpened())if(e.accessToken)e.access_token=e.accessToken,this._login(e,t);else{var n=e.apiUrl,i=this.context.userId,o=e.pwd||"",a=this.context.appName,c=this.context.orgName,u={grant_type:"password",username:i,password:o,timestamp:+new Date},d={headers:{"Content-type":"application/json"},url:n+"/"+c+"/"+a+"/token",dataType:"json",data:s.stringify(u),success:function(n,i){e.success&&e.success(n),t.token=n.access_token,t.context.restTokenData=n.access_token,t._login(n,t)}||I,error:function(n,i,o){if(e.error&&e.error(),t.isHttpDNS&&t.restIndex+1<t.restTotal)return t.restIndex++,void t.getRestFromHttpDNS(e,"login");t.clear(),n.error&&n.error_description?t.onError({type:b.WEBIM_CONNCTION_OPEN_USERGRID_ERROR,message:"login failed",data:n,xhr:i}):t.onError({type:b.WEBIM_CONNCTION_OPEN_ERROR,message:"login failed",data:n,xhr:i})}||I};s.ajax(d)}}},C.prototype.close=function(e){this.logOut=!0,this.context.status=b.STATUS_CLOSING,this.sock.close(),this.stopHeartBeat(),this.context.status=b.STATUS_CLOSING},C.prototype.recallMessage=function(e){var t={id:this.getUniqueId(),type:"recall",chatType:"chat"==e.type?"singleChat":e.type,ackId:e.mid,to:e.to,success:e.success,fail:e.fail};this.send(t,this)},C.prototype.sendMSync=function(e,t){if(this.sock.readyState===S)return this._base64transform(e,this,!1,t);this.unSendMsgArr.push(e),!this.logOut&&this.autoReconnectNumTotal<this.autoReconnectNumMax&&(this.autoReconnectNumTotal<=this.socketHost.length&&this.isHttpDNS||!this.isHttpDNS)&&(this.offLineSendConnecting=!0,this.reconnect()),this.onError({type:b.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected",reconnect:!0})},C.prototype.getUniqueId=function(e){this.autoIncrement?this.autoIncrement++:this.autoIncrement=1;var t=new Date,n=new Date(2010,1,1);return t.getTime()-n.getTime()+this.autoIncrement},C.prototype.send=function(e){(0,l.default)(e,this,s),this._msgHash[e.id]=e},C.prototype.removeRoster=function(e){h.default.operatRoster(e,"remove",this)},C.prototype.subscribe=function(e){h.default.operatRoster(e,"add",this)},C.prototype.subscribed=function(e){h.default.operatRoster(e,"accept",this)},C.prototype.unsubscribed=function(e){h.default.operatRoster(e,"decline",this)},C.prototype.addContact=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={to:e,message:t};h.default.operatRoster(n,"add",this)},C.prototype.deleteContact=function(e){var t={to:e};h.default.operatRoster(t,"remove",this)},C.prototype.acceptInvitation=function(e){var t={to:e};h.default.operatRoster(t,"accept",this)},C.prototype.declineInvitation=function(e){var t={to:e};h.default.operatRoster(t,"decline",this)},C.prototype.isOpened=function(){return this.sock&&this.sock.readyState===S},C.prototype.clear=function(){var e=this.context.appKey;if(this.errorType!=b.WEBIM_CONNCTION_DISCONNECTED&&this.logOut&&(this.unSendMsgArr=[],this.offLineSendConnecting=!1,this.context={status:b.STATUS_INIT,appKey:e}),this.intervalId&&clearInterval(this.intervalId),this.restIndex=0,this.hostIndex=0,this.errorType==b.WEBIM_CONNCTION_CLIENT_LOGOUT||-1==this.errorType){var t={type:b.WEBIM_CONNCTION_CLIENT_LOGOUT,message:"when login or sinup error",data:{data:"logout"}};this.onError(t)}},C.prototype.autoReconnectInterval=0,C.prototype.times=1,C.prototype.reconnect=function(e){if(v.debug("reconnect: time",this.hostIndex),this.sock.readyState!==S){var t=this;t.hostIndex<t.socketHost.length-1&&t.hostIndex++,setTimeout((function(){t._login({access_token:t.context.accessToken},t),t.autoReconnectInterval+=t.times*t.times,t.times++}),1e3*(0==this.autoReconnectNumTotal?0:t.autoReconnectInterval)),this.autoReconnectNumTotal++}},C.prototype.closed=function(){var e={data:{data:"Closed error"},type:b.WEBIM_CONNECTION_CLOSED,message:"closed error"};this.onError(e),this.stopHeartBeat()},C.prototype.addToBlackList=function(e){h.default.operatRoster({to:e.name},"ban",this)},C.prototype.removeFromBlackList=function(e){h.default.operatRoster({to:e.name},"allow",this)},(0,a.default)(C.prototype,_.default),y.connection=C,y.doQuery=function(e,t,n){void 0!==window.cefQuery&&window.cefQuery({request:e,persistent:!1,onSuccess:t,onFailure:n})},y.debug=function(e){};var E=y;n.default=E},function(e,t,n){"use strict";function i(){return e.exports=i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},i.apply(this,arguments)}e.exports=i},function(e,t,n){"use strict";function i(e){this.array=void 0===e?[]:new Array(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i.prototype={length:function(){return this.array.length},at:function(e){return this.array[e]},set:function(e,t){this.array[e]=t},push:function(e){return this.array.push(e)},slice:function(e,t){return this.array=this.array.slice(e,t)},concat:function(e){this.array=this.array.concat(e)},remove:function(e,t){t=void 0===t?1:t,this.array.splice(e,t)},join:function(e){return this.array.join(e)},clear:function(){this.array.length=0}};var o=function(){this._array_h=new i};o.prototype={_index:0,push:function(e){this._array_h.push(e)},pop:function(){var e=null;return this._array_h.length()&&(e=this._array_h.at(this._index),2*++this._index>=this._array_h.length()&&(this._array_h.slice(this._index),this._index=0)),e},head:function(){var e=null,t=this._array_h.length();return t&&(e=this._array_h.at(t-1)),e},tail:function(){var e=null;return this._array_h.length()&&(e=this._array_h.at(this._index)),e},length:function(){return this._array_h.length()-this._index},empty:function(){return 0===this._array_h.length()},clear:function(){this._array_h.clear()}};var r=o;t.default=r},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traceForIE=function(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()},t.isIE=void 0;var i="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent);t.isIE=i},function(e,t,n){"use strict";var i=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,s,a,c=i(n(5));Object.keys||(Object.keys=(o=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),a=(s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!==(0,c.default)(e)&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var t,n,i=[];for(t in e)o.call(e,t)&&i.push(t);if(r)for(n=0;n<a;n++)o.call(e,s[n])&&i.push(s[n]);return i}));var u={emptyfn:function(){},stringify:function(e){if("undefined"!=typeof JSON&&JSON.stringify)return JSON.stringify(e);var t="",n=[];return function e(i){var o=!1;for(var r in"[object Array]"===Object.prototype.toString.call(i)?(n.push("]","["),o=!0):"[object Object]"===Object.prototype.toString.call(i)&&n.push("}","{"),i)"[object Null]"===Object.prototype.toString.call(i[r])?i[r]="null":"[object Undefined]"===Object.prototype.toString.call(i[r])&&(i[r]="undefined"),i[r]&&"object"===(0,c.default)(i[r])?t+=","+(o?"":'"'+r+'":'+(o?'"':""))+e(i[r]):t+=',"'+(o?"":r+'":"')+i[r]+'"';return""!=t&&(t=t.slice(1)),n.pop()+t+n.pop()}(e)},getFileSize:function(e){var t=this.getFileLength(e);if(t>1e7)return!1;var n=Math.round(t/1e3);if(n<1e3)t=n+" KB";else if(n>=1e3){var i=n/1e3;t=i<1e3?i.toFixed(1)+" MB":(i/1e3).toFixed(1)+" GB"}return t},trim:function(e){return(e="string"==typeof e?e:"").trim?e.trim():e.replace(/^\s|\s$/g,"")},parseTextMessage:function(e,t){if("string"==typeof e){if("[object Object]"!==Object.prototype.toString.call(t))return{isemoji:!1,body:[{type:"txt",data:e}]};var n=e,i=[],o=n.match(/\[[^[\]]{2,3}\]/gm);if(!o||o.length<1)return{isemoji:!1,body:[{type:"txt",data:e}]};for(var r=!1,s=0;s<o.length;s++){var a=n.substring(0,n.indexOf(o[s])),c=WebIM.Emoji.map[o[s]];if(a&&i.push({type:"txt",data:a}),c){var u=WebIM.Emoji.map?WebIM.Emoji.path+c:null;u?(r=!0,i.push({type:"emoji",data:u})):i.push({type:"txt",data:o[s]});var d=n.indexOf(o[s])+o[s].length;n=n.substring(d)}else i.push({type:"txt",data:o[s]})}return n&&i.push({type:"txt",data:n}),r?{isemoji:r,body:i}:{isemoji:!1,body:[{type:"txt",data:e}]}}},ts:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),i=e.getSeconds();return(t<10?"0"+t:t)+":"+(n<10?"0"+n:n)+":"+(i<10?"0"+i:i)+":"+e.getMilliseconds()+" "},getObjectKey:function(e,t){for(var n in e)if(e[n]==t)return n;return""},sprintf:function(){var e,t,n=arguments,i=n[0]||"";for(e=1,t=n.length;e<t;e++)i=i.replace(/%s/,n[e]);return i},reverse:function(e){var t=[];if(Array.prototype.reverse)t=e.reverse();else for(var n=0;n<e.length;n++)t.unshift(e[n]);return t},checkArray:function(e,t){var n="off";if(e.forEach((function(e,i){if(e.name===t.name)return n="on",i})),"off"==n)return!1}},d=u;t.default=d},function(e,n,i){"use strict";var o=i(0);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(i(8)),s=function(e,n,i){var o=i.context.root.lookup("easemob.pb.MUCBody").decode(e.payload);new r.default(e.id.low,e.id.high,e.id.unsigned).toString(),function(e){var n={type:"",owner:o.from.name,gid:o.mucId.name,from:o.from.name,fromJid:o.from,to:o.to.length?o.to[0].name:"",toJid:o.to,chatroom:o.isChatroom,status:o.status};({32:function(){n.type=o.isChatroom?"rmChatRoomMute":"rmGroupMute",i.onPresence(n)},31:function(){n.type=o.isChatroom?"muteChatRoom":"muteGroup",i.onPresence(n)},30:function(){n.type=o.isChatroom?"rmUserFromChatRoomWhiteList":"rmUserFromGroupWhiteList",i.onPresence(n)},29:function(){n.type=o.isChatroom?"addUserToChatRoomWhiteList":"addUserToGroupWhiteList",i.onPresence(n)},28:function(){n.type="deleteFile",i.onPresence(n)},27:function(){n.type="uploadFile",i.onPresence(n)},26:function(){n.type="deleteAnnouncement",i.onPresence(n)},25:function(){n.type="updateAnnouncement",i.onPresence(n)},24:function(){n.type="removeMute",i.onPresence(n)},23:function(){n.type="addMute",i.onPresence(n)},22:function(){n.type="removeAdmin",i.onPresence(n)},21:function(){n.type="addAdmin",i.onPresence(n)},20:function(){n.type="changeOwner",i.onPresence(n)},19:function(){n.type="direct_joined",i.onPresence(n)},18:function(){n.type=o.isChatroom?"leaveChatRoom":"leaveGroup",i.onPresence(n)},17:function(){n.type=o.isChatroom?"memberJoinChatRoomSuccess":"memberJoinPublicGroupSuccess",i.onPresence(n)},16:function(){n.type="unblock",i.onPresence(n)},15:function(){n.type="block",i.onPresence(n)},14:function(){n.type="update",i.onPresence(n)},13:function(){n.type="allow",n.reason=o.reason,i.onPresence(n)},12:function(){n.type="ban",i.onPresence(n)},11:function(){n.type="getBlackList",i.onPresence(n)},10:function(){n.type="removedFromGroup",n.kicked=n.to,i.onPresence(n)},9:function(){n.type="invite_decline",n.kicked=n.to,i.onPresence(n)},8:function(){n.type="invite_accept",n.kicked=n.to,i.onPresence(n)},7:function(){n.type="invite",n.kicked=n.to,i.onPresence(n)},6:function(){n.type="joinPublicGroupDeclined",i.onPresence(n)},5:function(){n.type="joinPublicGroupSuccess",i.onPresence(n)},4:function(){n.type="joinGroupNotifications",n.reason=o.reason,i.onPresence(n)},3:function(){n.type="leave",i.onPresence(n)},2:function(){n.type="join",i.onPresence(n)},1:function(){n.type="deleteGroupChat",i.onPresence(n)}}[e]||function(){t("log","%c\u6ca1\u6709\u5339\u914d".concat(e,"\u7c7b\u578b"),"background: green"," at newSDK/wxsdk3.4.0.js:1")})()}(o.operation)};n.default=s},function(e,n,i){"use strict";var o=i(0);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(i(8)),s={handleMessage:function(e,n,i){var o=i.context.root.lookup("easemob.pb.RosterBody").decode(e.payload),s=(new r.default(e.id.low,e.id.high,e.id.unsigned).toString(),{to:o.to[0].name,from:o.from.name,status:o.reason});switch(o.operation){case 0:break;case 2:s.type="subscribe",i.onContactInvited(s),t("warn","in onPresence function, case subscribe is no longer maintained from version 3.3.0.\n                Please use onContactInvited instead. \n                refer to the documentation for details: \n                http://docs-im.easemob.com/im/web/basics/buddy"," at newSDK/wxsdk3.4.0.js:1");break;case 3:s.type="unsubscribed",i.onContactDeleted(s),t("warn","in onPresence function, case unsubscribed is no longer maintained from version 3.3.0.\n                Please use onContactDeleted instead. \n                refer to the documentation for details: \n                http://docs-im.easemob.com/im/web/basics/buddy"," at newSDK/wxsdk3.4.0.js:1");break;case 4:s.type="subscribed",i.onContactAdded(s),t("warn","in onPresence function, case subscribed is no longer maintained from version 3.3.0.\n                Please use onContactAdded instead. \n                refer to the documentation for details: \n                http://docs-im.easemob.com/im/web/basics/buddy"," at newSDK/wxsdk3.4.0.js:1");break;case 5:s.type="unsubscribed",i.onContactRefuse(s),t("warn","in onPresence function, case unsubscribed is no longer maintained from version 3.3.0.\n                Please use onContactRefuse instead. \n                refer to the documentation for details: \n                http://docs-im.easemob.com/im/web/basics/buddy"," at newSDK/wxsdk3.4.0.js:1");break;case 6:case 7:i.getBlacklist();break;case 8:s.type="subscribed",i.onContactAgreed(s),t("warn","in onPresence function, case subscribed is no longer maintained from version 3.3.0.\n                Please use onContactAgreed instead. \n                refer to the documentation for details: \n                http://docs-im.easemob.com/im/web/basics/buddy"," at newSDK/wxsdk3.4.0.js:1");break;case 9:s.type="unsubscribed",i.onContactRefuse(s),t("warn","in onPresence function, case unsubscribed is no longer maintained from version 3.3.0.\n                Please use onContactRefuse instead. \n                refer to the documentation for details: \n                http://docs-im.easemob.com/im/web/basics/buddy"," at newSDK/wxsdk3.4.0.js:1")}i.onPresence(s)},operatRoster:function(e,t,n){var i=[],o=n.context.root.lookup("easemob.pb.RosterBody"),r=o.decode(i);"add"===t?r.operation=2:"remove"===t?r.operation=3:"accept"===t?r.operation=4:"decline"===t?r.operation=5:"ban"===t?r.operation=6:"allow"===t&&(r.operation=7),r.from=n.context.jid;var s=[];if("string"==typeof e.to)s.push({appKey:n.appKey||n.context.appKey,name:e.to,domain:"easemob.com"});else if(e.to instanceof Array)for(var a=0;a<e.to.length;a++)s.push({appKey:n.appKey,name:e.to[a],domain:"easemob.com"});r.to=s,r.reason=e.message,r=o.encode(r).finish();var c=n.context.root.lookup("easemob.pb.Meta").decode(i);c.id=e.id||n.getUniqueId(),c.from=n.context.jid,c.to={domain:"@easemob.com"},c.ns=3,c.payload=r;var u=n.context.root.lookup("easemob.pb.CommSyncUL"),d=u.decode(i);d.meta=c,d=u.encode(d).finish();var l=n.context.root.lookup("easemob.pb.MSync"),f=l.decode(i);f.version=n.version,f.encryptType=[0],f.command=0,f.guid=n.jid,f.payload=d,f=l.encode(f).finish(),n.sendMSync(f)}};n.default=s},function(e,t,n){"use strict";var i=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(8)),r=(0,i(n(7)).default)(),s=function(e,t,n){var i=n.context.root.lookup("easemob.pb.StatisticsBody").decode(e.payload);switch(new o.default(e.id.low,e.id.high,e.id.unsigned).toString(),i.operation){case 0:n.onStatisticMessage(i);break;case 1:var s={type:r.WEBIM_CONNCTION_USER_REMOVED,message:"user has been removed"};n.logOut=!0,n.onError(s);break;case 2:s={type:r.WEBIM_CONNCTION_USER_LOGIN_ANOTHER_DEVICE,message:"the user is already logged on another device"},n.logOut=!0,n.onError(s);break;case 3:s={type:r.WEBIM_CONNCTION_USER_KICKED_BY_CHANGE_PASSWORD,message:"the user was kicked by changing password"},n.logOut=!0,n.onError(s);break;case 4:s={type:r.WEBIM_CONNCTION_USER_KICKED_BY_OTHER_DEVICE,message:"the user was kicked by other device"},n.logOut=!0,n.onError(s)}};t.default=s},function(e,n,i){"use strict";var o=i(0);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,s=o(i(64)),a=o(i(32)),c=o(i(7)),u=o(i(28)),d=(0,c.default)(),l=(r={mr_cache:[],_fetchMessages:function(e,n){var i=e.accessToken||n.context.accessToken;if(n._utils.isCanSetRequestHeader)if(i){var o=n.apiUrl||this.apiUrl,r=n.context.appName,s=n.context.orgName;if(!r||!s)return void n.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"});if(!e.queue)return void n.onError({type:d.SDK_RUNTIME_ERROR,message:"queue is not specified"});var c=e.queue,l=this.mr_cache[c]||(this.mr_cache[c]={msgs:[]}),f=n.context.userId,p=-1;if(l.msgs.length>=e.count||l.is_last)return void("function"==typeof e.success&&e.success(l));l&&l.next_key&&(p=l.next_key);var h={queue:c+(e.isGroup?"@conference.easemob.com":"@easemob.com"),start:p,end:-1},m={url:o+"/"+s+"/"+r+"/users/"+f+"/messageroaming",dataType:"json",type:"POST",headers:{Authorization:"Bearer "+i},data:JSON.stringify(h),success:function(i,o){if(i&&i.data){var r=i.data;if(!i.data.msgs)return"function"==typeof e.success&&e.success(l),l.is_last=!0,void(l.next_key="");var s=r.msgs,c=s.length;l.is_last=r.is_last,l.next_key=r.next_key;var d=function(e){for(var t=[],i=0,o=(e=u.default.atob(e)).length;i<o;++i)t.push(e.charCodeAt(i));var r=n.context.root.lookup("easemob.pb.Meta");if(1==(r=r.decode(t)).ns)return(0,a.default)(r,{errorCode:0,reason:""},n,!0)};try{for(var f=0;f<c;f++){var p=d(s[f].msg);p&&l.msgs.push(p)}}catch(e){t("log",e," at newSDK/wxsdk3.4.0.js:1")}finally{"function"==typeof e.success&&e.success(l)}}}||n._utils.emptyfn,error:function(e,t){e.error&&e.error_description&&n.onError({type:d.WEBIM_CONNCTION_LOAD_CHATROOM_ERROR,message:"fetch history messages error",msg:e.error_description,data:e})}||n._utils.emptyfn};n._utils.ajax(m)}else n.onError({type:d.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"});else n.onError({type:d.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR,message:"current environment can not set request header"})},fetchHistoryMessages:function(e){var t=this;return new Promise((function(n,i){if(e.queue){var o=e.count||20;!function r(){t._fetchMessages({count:o,isGroup:!!e.isGroup,queue:e.queue,success:function(i){if(i.msgs.length>=o||i.is_last){var s=t._utils.reverse(i.msgs.splice(0,o));e.success&&e.success(s),n(s)}else r()},fail:function(t){i(t),e.fail&&e.fail(t)}},t)}()}else t.onError({type:d.SDK_RUNTIME_ERROR,message:"queue is not specified"})}))},getChatRooms:function(e){var t=this,n=e.accessToken||this.context.accessToken;if(t._utils.isCanSetRequestHeader){if(n){var i=e.apiUrl||this.apiUrl,o=this.context.appName,r=this.context.orgName;if(!o||!r)return void t.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"});var s={url:i+"/"+r+"/"+o+"/chatrooms",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+n},data:{pagenum:parseInt(e.pagenum)||1,pagesize:parseInt(e.pagesize)||20},success:function(t,n){"function"==typeof e.success&&e.success(t)}||t._utils.emptyfn,error:function(e,n,i){e.error&&e.error_description&&t.onError({type:d.WEBIM_CONNCTION_LOAD_CHATROOM_ERROR,message:e.error_description,data:e,xhr:n})}||t._utils.emptyfn};return t._utils.ajax(s)}t.onError({type:d.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"})}else t.onError({type:d.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR,message:"current environment can not set request header"})},createChatRoom:function(e){if(e=e||{},this._utils.isCanSetRequestHeader){var t=this,n=e.accessToken||this.token,i=t.user;if(n){var o=e.apiUrl||this.apiUrl,r=this.context.appName,s=this.context.orgName;if(!r||!s)return void t.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"});var a={name:e.name,description:e.description,maxusers:e.maxusers,owner:i,members:e.members},c={url:o+"/"+s+"/"+r+"/chatrooms",dataType:"json",type:"POST",data:JSON.stringify(a),headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"},success:function(t,n){"function"==typeof e.success&&e.success(t)}||t._utils.emptyfn,error:function(t,n,i){"function"==typeof e.error&&e.error(t)}||t._utils.emptyfn};return t._utils.ajax(c)}t.onError({type:d.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"})}else t.onError({type:d.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR,message:"current environment can not set request header"})},destroyChatRoom:function(e){if(e=e||{},this._utils.isCanSetRequestHeader){var t=this,n=e.accessToken||this.token;if(n){var i=e.apiUrl||this.apiUrl,o=this.context.appName,r=this.context.orgName,s=e.chatRoomId;if(!o||!r)return void t.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"});var a={url:i+"/"+r+"/"+o+"/chatrooms/"+s,dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+n},success:function(t,n){"function"==typeof e.success&&e.success(t)}||t._utils.emptyfn,error:function(t,n,i){"function"==typeof e.error&&e.error(t)}||t._utils.emptyfn};return t._utils.ajax(a)}t.onError({type:d.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"})}else t.onError({type:d.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR,message:"current environment can not set request header"})},getChatRoomDetails:function(e){var t=e.chatRoomId,n=this.context.appName,i=this.context.orgName;if(n&&i){var o={url:(e.apiUrl||this.apiUrl)+"/"+i+"/"+n+"/chatrooms/"+t,dataType:"json",type:"GET",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return o.success=e.success||this._utils.emptyfn,o.error=e.error||this._utils.emptyfn,this._utils.ajax(o)}conn.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"})},modifyChatRoom:function(e){var t=e.chatRoomId,n={groupname:e.chatRoomName,description:e.description,maxusers:e.maxusers},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t,type:"PUT",data:JSON.stringify(n),dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)},removeSingleChatRoomMember:function(e){var t=e.chatRoomId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)},removeMultiChatRoomMember:function(e){var t=e.chatRoomId,n=e.users.join(","),i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)},addUsersToChatRoom:function(e){var t=e.chatRoomId,n={usernames:e.users},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/users",type:"POST",data:JSON.stringify(n),dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)},joinChatRoom:function(e){if(e=e||{},this._utils.isCanSetRequestHeader){var t=this,n=e.accessToken||this.token;if(n){var i=e.apiUrl||this.apiUrl,o=this.context.appName,r=this.context.orgName,s=e.roomId,a=e.message||"";if(!o||!r)return void t.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"});var c={url:i+"/"+r+"/"+o+"/chatrooms/"+s+"/apply",dataType:"json",type:"POST",data:JSON.stringify({message:a}),headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"},success:function(t,n){"function"==typeof e.success&&e.success(t)}||t._utils.emptyfn,error:function(t,n,i){"function"==typeof e.error&&e.error(t)}||t._utils.emptyfn};return t._utils.ajax(c)}t.onError({type:d.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"})}else t.onError({type:d.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR,message:"current environment can not set request header"})},quitChatRoom:function(e){if(e=e||{},this._utils.isCanSetRequestHeader){var t=this,n=e.accessToken||this.token;if(n){var i=e.apiUrl||this.apiUrl,o=this.context.appName,r=this.context.orgName,s=e.roomId;if(!o||!r)return void t.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"});var a={url:i+"/"+r+"/"+o+"/chatrooms/"+s+"/quit",dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+n},success:function(t,n){"function"==typeof e.success&&e.success(t)}||t._utils.emptyfn,error:function(t,n,i){"function"==typeof e.error&&e.error(t)}||t._utils.emptyfn};return t._utils.ajax(a)}t.onError({type:d.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"})}else t.onError({type:d.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR,message:"current environment can not set request header"})},createGroupNew:function(e){if(e&&e.data){e.data.owner=this.user,e.data.hasOwnProperty("inviteNeedConfirm")&&(e.data.invite_need_confirm=e.data.inviteNeedConfirm,delete e.data.inviteNeedConfirm);var t={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups",dataType:"json",type:"POST",data:JSON.stringify(e.data),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return t.success=function(t){e.success(t),this.onCreateGroup(t)}.bind(this),t.error=e.error||this._utils.emptyfn,this._utils.ajax(t)}},blockGroup:function(e){var t=e.groupId;t="notification_ignore_"+t;var n={entities:[]};n.entities[0]={},n.entities[0][t]=!0;var i={type:"PUT",url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/users/"+this.user,data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)},listGroups:function(e){var t=[];if(t.limit=e.limit,t.cursor=e.cursor,t.cursor||delete t.cursor,isNaN(e.limit))throw'The parameter "limit" should be a number';var n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/publicchatgroups",type:"GET",dataType:"json",data:t,headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)},getGroup:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/users/"+this.user+"/joined_chatgroups",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return t.success=e.success||this._utils.emptyfn,t.error=e.error||this._utils.emptyfn,this._utils.ajax(t)},changeOwner:function(e){var t={newowner:e.newOwner},n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+e.groupId,type:"PUT",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"},data:JSON.stringify(t)};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)},getGroupInfo:function(e){var t={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+e.groupId+"?joined_time=true",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return t.success=e.success||this._utils.emptyfn,t.error=e.error||this._utils.emptyfn,this._utils.ajax(t)},modifyGroup:function(e){var t=e.groupId,n={groupname:e.groupName,description:e.description},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t,type:"PUT",data:JSON.stringify(n),dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)},listGroupMember:function(e){if(isNaN(e.pageNum)||e.pageNum<=0)throw'The parameter "pageNum" should be a positive number';if(isNaN(e.pageSize)||e.pageSize<=0)throw'The parameter "pageSize" should be a positive number';if(null===e.groupId&&void 0===e.groupId)throw'The parameter "groupId" should be added';var t=[],n=e.groupId;t.pagenum=e.pageNum,t.pagesize=e.pageSize;var i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+n+"/users",dataType:"json",type:"GET",data:t,headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)}},(0,s.default)(r,"listGroupMember",(function(e){if(isNaN(e.pageNum)||e.pageNum<=0)throw'The parameter "pageNum" should be a positive number';if(isNaN(e.pageSize)||e.pageSize<=0)throw'The parameter "pageSize" should be a positive number';if(null===e.groupId&&void 0===e.groupId)throw'The parameter "groupId" should be added';var t=[],n=e.groupId;t.pagenum=e.pageNum,t.pagesize=e.pageSize;var i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+n+"/users",dataType:"json",type:"GET",data:t,headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"listChatRoomMember",(function(e){if(isNaN(e.pageNum)||e.pageNum<=0)throw'The parameter "pageNum" should be a positive number';if(isNaN(e.pageSize)||e.pageSize<=0)throw'The parameter "pageSize" should be a positive number';if(null===e.chatRoomId&&void 0===e.chatRoomId)throw'The parameter "chatRoomId" should be added';var t=[],n=e.chatRoomId;t.pagenum=e.pageNum,t.pagesize=e.pageSize;var i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+n+"/users",dataType:"json",type:"GET",data:t,headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"getGroupAdmin",(function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/admin",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"getChatRoomAdmin",(function(e){var t=e.chatRoomId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/admin",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"setAdmin",(function(e){var t=e.groupId,n={newadmin:e.username},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/admin",type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"setChatRoomAdmin",(function(e){var t=e.chatRoomId,n={newadmin:e.username},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/admin",type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeAdmin",(function(e){var t=e.groupId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/admin/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeChatRoomAdmin",(function(e){var t=e.chatRoomId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/admin/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"dissolveGroup",(function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"?version=v3",type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"quitGroup",(function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/quit",type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"inviteToGroup",(function(e){var t=e.groupId,n={usernames:e.users},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/invite",type:"POST",data:JSON.stringify(n),dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"joinGroup",(function(e){var t={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+e.groupId+"/apply",type:"POST",dataType:"json",data:JSON.stringify({message:"join group"}),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return t.success=e.success||this._utils.emptyfn,t.error=e.error||this._utils.emptyfn,this._utils.ajax(t)})),(0,s.default)(r,"agreeJoinGroup",(function(e){var t=e.groupId,n={applicant:e.applicant,verifyResult:!0,reason:"no clue"},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/apply_verify",type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"rejectJoinGroup",(function(e){var t=e.groupId,n={applicant:e.applicant,verifyResult:!1,reason:"no clue"},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/apply_verify",type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"agreeInviteIntoGroup",(function(e){var t=e.groupId,n={invitee:e.invitee,verifyResult:!0},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/invite_verify",type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"rejectInviteIntoGroup",(function(e){var t=e.groupId,n={invitee:e.invitee,verifyResult:!1},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/invite_verify",type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeSingleGroupMember",(function(e){var t=e.groupId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeMultiGroupMember",(function(e){var t=e.groupId,n=e.users.join(","),i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"mute",(function(e){var t=e.groupId,n={usernames:[e.username],mute_duration:e.muteDuration},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/mute",dataType:"json",type:"POST",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"},data:JSON.stringify(n)};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"muteChatRoomMember",(function(e){var t=e.chatRoomId,n={usernames:[e.username],mute_duration:e.muteDuration},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/mute",dataType:"json",type:"POST",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"},data:JSON.stringify(n)};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeMute",(function(e){var t=e.groupId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/mute/"+n,dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeMuteChatRoomMember",(function(e){var t=e.chatRoomId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/mute/"+n,dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"getMuted",(function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/mute",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"getChatRoomMuted",(function(e){var t=e.chatRoomId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/mute",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"groupBlockSingle",(function(e){var t=e.groupId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users/"+n,type:"POST",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"chatRoomBlockSingle",(function(e){var t=e.chatRoomId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/blocks/users/"+n,type:"POST",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"groupBlockMulti",(function(e){var t=e.groupId,n={usernames:e.usernames},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users",data:JSON.stringify(n),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"chatRoomBlockMulti",(function(e){var t=e.chatRoomId,n={usernames:e.usernames},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/blocks/users",data:JSON.stringify(n),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeGroupBlockSingle",(function(e){var t=e.groupId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeChatRoomBlockSingle",(function(e){var t=e.chatRoomId,n=e.username,i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/blocks/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeGroupBlockMulti",(function(e){var t=e.groupId,n=e.usernames.join(","),i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"removeChatRoomBlockMulti",(function(e){var t=e.chatRoomId,n=e.usernames.join(","),i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/blocks/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"getGroupBlacklistNew",(function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"getChatRoomBlacklistNew",(function(e){var t=e.chatRoomId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/blocks/users",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"disableSendGroupMsg",(function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/ban",type:"POST",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"disableSendChatRoomMsg",(function(e){var t=e.chatRoomId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/ban",type:"POST",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"enableSendGroupMsg",(function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/ban",type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"enableSendChatRoomMsg",(function(e){var t=e.chatRoomId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/ban",type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"addUsersToGroupWhitelist",(function(e){var t=e.groupId,n={usernames:e.users},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/white/users",type:"POST",data:JSON.stringify(n),dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"addUsersToChatRoomWhitelist",(function(e){var t=e.chatRoomId,n={usernames:e.users},i={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/white/users",type:"POST",data:JSON.stringify(n),dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return i.success=e.success||this._utils.emptyfn,i.error=e.error||this._utils.emptyfn,this._utils.ajax(i)})),(0,s.default)(r,"rmUsersFromGroupWhitelist",(function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/white/users/"+e.userName,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"rmUsersFromChatRoomWhitelist",(function(e){var t=e.chatRoomId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/white/users/"+e.userName,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"getGroupWhitelist",(function(e){var t=e.groupId,n=(e.users,{url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/white/users",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}});return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"getChatRoomWhitelist",(function(e){var t=e.chatRoomId,n=(e.users,{url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/white/users",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}});return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"isGroupWhiteUser",(function(e){var t=e.groupId,n=(e.users,{url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/white/users/"+e.userName,type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}});return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"isChatRoomWhiteUser",(function(e){var t=e.chatRoomId,n=(e.users,{url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatrooms/"+t+"/white/users/"+e.userName,type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}});return n.success=e.success||this._utils.emptyfn,n.error=e.error||this._utils.emptyfn,this._utils.ajax(n)})),(0,s.default)(r,"getGroupMsgReadUser",(function(e){var t=this;if(e=e||{},this._utils.isCanSetRequestHeader){var n=e.accessToken||this.token;if(n){var i=t.apiUrl,o=t.context.appName,r=t.context.orgName;if(!o||!r)return void t.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"});var s={url:i+"/"+r+"/"+o+"/chatgroups/"+e.groupId+"/acks/"+e.msgId,dataType:"json",type:"GET",data:{limit:500,key:void 0},headers:{Authorization:"Bearer "+n},success:function(t){"function"==typeof e.success&&e.success(t)}||this._utils.emptyfn,error:function(t){"function"==typeof e.error&&e.error(t)}||this._utils.emptyfn};return this._utils.ajax(s)}t.onError({type:d.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"})}else conn.onError({type:d.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR,message:"current environment can not set request header"})})),(0,s.default)(r,"getBlacklist",(function(e){var t=this;if(e=e||{},this._utils.isCanSetRequestHeader){var n=this,i=e.accessToken||this.token;if(i){var o=e.apiUrl||this.apiUrl,r=this.context.appName,s=this.context.orgName;if(!r||!s)return void n.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"});var a={url:o+"/"+s+"/"+r+"/users/"+this.user+"/blocks/users",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+i},success:function(n,i){var o={};n.data.forEach((function(e,t){o[e]={name:e}})),t.onBlacklistUpdate(o),"function"==typeof e.success&&e.success(n)}||this._utils.emptyfn,error:function(n,i,o){t.onBlacklistUpdate([]),"function"==typeof e.error&&e.error(n)}||this._utils.emptyfn};return this._utils.ajax(a)}n.onError({type:d.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"})}else n.onError({type:d.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR,message:"current environment can not set request header"})})),(0,s.default)(r,"getRoster",(function(e){e=e||{};var t=this;if(this._utils.isCanSetRequestHeader){var n=this,i=e.accessToken||this.token;if(i){var o=e.apiUrl||this.apiUrl,r=this.context.appName,s=this.context.orgName;if(!r||!s)return void n.onError({type:d.WEBIM_CONNCTION_AUTH_ERROR,message:"appName or orgName is illegal"});var a={url:o+"/"+s+"/"+r+"/users/"+this.user+"/contacts/users",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+i},success:function(n,i){var o=[];n.data.forEach((function(e,n){o.push({name:e,subscription:"both",jid:t.context.jid})})),"function"==typeof e.success&&e.success(o),t.onRoster&&t.onRoster(o)}||this._utils.emptyfn,error:function(t,n,i){"function"==typeof e.error&&e.error(t)}||this._utils.emptyfn};return this._utils.ajax(a)}n.onError({type:d.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR,message:"token not assign error"})}else n.onError({type:d.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR,message:"current environment can not set request header"})})),(0,s.default)(r,"fetchGroupAnnouncement",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.groupId,r={url:"".concat(t,"/").concat(i,"/").concat(n,"/chatgroups/").concat(o,"/announcement"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return r.success=e.success||this._utils.emptyfn,r.error=e.error||this._utils.emptyfn,this._utils.ajax(r)})),(0,s.default)(r,"fetchChatRoomAnnouncement",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.roomId,r={url:"".concat(t,"/").concat(i,"/").concat(n,"/chatrooms/").concat(o,"/announcement"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return r.success=e.success||this._utils.emptyfn,r.error=e.error||this._utils.emptyfn,this._utils.ajax(r)})),(0,s.default)(r,"updateGroupAnnouncement",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.groupId,r={announcement:e.announcement},s={url:"".concat(t,"/").concat(i,"/").concat(n,"/chatgroups/").concat(o,"/announcement"),type:"POST",dataType:"json",data:JSON.stringify(r),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return s.success=e.success||this._utils.emptyfn,s.error=e.error||this._utils.emptyfn,this._utils.ajax(s)})),(0,s.default)(r,"updateChatRoomAnnouncement",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.roomId,r={announcement:e.announcement},s={url:"".concat(t,"/").concat(i,"/").concat(n,"/chatrooms/").concat(o,"/announcement"),type:"POST",dataType:"json",data:JSON.stringify(r),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return s.success=e.success||this._utils.emptyfn,s.error=e.error||this._utils.emptyfn,this._utils.ajax(s)})),(0,s.default)(r,"uploadGroupSharedFile",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.groupId;this._utils.uploadFile({uploadUrl:"".concat(t,"/").concat(i,"/").concat(n,"/chatgroups/").concat(o,"/share_files"),onFileUploadProgress:e.onFileUploadProgress,onFileUploadComplete:e.onFileUploadComplete,onFileUploadError:e.onFileUploadError,onFileUploadCanceled:e.onFileUploadCanceled,accessToken:this.token,apiUrl:t,file:e.file,appKey:this.context.appKey})})),(0,s.default)(r,"uploadChatRoomSharedFile",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.roomId;this._utils.uploadFile({uploadUrl:"".concat(t,"/").concat(i,"/").concat(n,"/chatrooms/").concat(o,"/share_files"),onFileUploadProgress:e.onFileUploadProgress,onFileUploadComplete:e.onFileUploadComplete,onFileUploadError:e.onFileUploadError,onFileUploadCanceled:e.onFileUploadCanceled,accessToken:this.token,apiUrl:t,file:e.file,appKey:this.context.appKey})})),(0,s.default)(r,"deleteGroupSharedFile",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.groupId,r=e.fileId,s={url:"".concat(t,"/").concat(i,"/").concat(n,"/chatgroups/").concat(o,"/share_files/").concat(r),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return s.success=e.success||this._utils.emptyfn,s.error=e.error||this._utils.emptyfn,this._utils.ajax(s)})),(0,s.default)(r,"deleteChatRoomSharedFile",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.roomId,r=e.fileId,s={url:"".concat(t,"/").concat(i,"/").concat(n,"/chatrooms/").concat(o,"/share_files/").concat(r),type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return s.success=e.success||this._utils.emptyfn,s.error=e.error||this._utils.emptyfn,this._utils.ajax(s)})),(0,s.default)(r,"downloadGroupSharedFile",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.groupId,r=e.fileId;this._utils.download.call(this,{url:"".concat(t,"/").concat(i,"/").concat(n,"/chatgroups/").concat(o,"/share_files/").concat(r),onFileDownloadComplete:e.onFileDownloadComplete,onFileDownloadError:e.onFileDownloadError,accessToken:this.token,id:r,secret:""})})),(0,s.default)(r,"downloadChatRoomSharedFile",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.roomId,r=e.fileId;this._utils.download.call(this,{url:"".concat(t,"/").concat(i,"/").concat(n,"/chatrooms/").concat(o,"/share_files/").concat(r),onFileDownloadComplete:e.onFileDownloadComplete,onFileDownloadError:e.onFileDownloadError,accessToken:this.token,id:r,secret:""})})),(0,s.default)(r,"fetchGroupSharedFileList",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.groupId,r={url:"".concat(t,"/").concat(i,"/").concat(n,"/chatgroups/").concat(o,"/share_files"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return r.success=e.success||this._utils.emptyfn,r.error=e.error||this._utils.emptyfn,this._utils.ajax(r)})),(0,s.default)(r,"fetchChatRoomSharedFileList",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o=e.roomId,r={url:"".concat(t,"/").concat(i,"/").concat(n,"/chatrooms/").concat(o,"/share_files"),type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return r.success=e.success||this._utils.emptyfn,r.error=e.error||this._utils.emptyfn,this._utils.ajax(r)})),(0,s.default)(r,"uploadToken",(function(e){var t=e.apiUrl||this.apiUrl,n=this.context.appName,i=this.context.orgName,o={url:"".concat(t,"/").concat(i,"/").concat(n,"/users/").concat(this.user),type:"PUT",data:JSON.stringify({device_id:e.deviceId,device_token:e.deviceToken,notifier_name:e.notifierName}),dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};return o.success=e.success||this._utils.emptyfn,o.error=e.error||this._utils.emptyfn,this._utils.ajax(o)})),r);n.default=l},function(e,t,n){"use strict";e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){return{nested:{easemob:{nested:{pb:{nested:{MessageBody:{fields:{type:{type:"Type",id:1},from:{type:"JID",id:2},to:{type:"JID",id:3},contents:{rule:"repeated",type:"Content",id:4},ext:{rule:"repeated",type:"KeyValue",id:5},ackMessageId:{type:"uint64",id:6},msgConfig:{type:"MessageConfig",id:7},ackContent:{type:"string",id:8}},nested:{Content:{fields:{type:{type:"Type",id:1},text:{type:"string",id:2},latitude:{type:"double",id:3},longitude:{type:"double",id:4},address:{type:"string",id:5},displayName:{type:"string",id:6},remotePath:{type:"string",id:7},secretKey:{type:"string",id:8},fileLength:{type:"int32",id:9},action:{type:"string",id:10},params:{rule:"repeated",type:"KeyValue",id:11},duration:{type:"int32",id:12},size:{type:"Size",id:13},thumbnailRemotePath:{type:"string",id:14},thumbnailSecretKey:{type:"string",id:15},thumbnailDisplayName:{type:"string",id:16},thumbnailFileLength:{type:"int32",id:17},thumbnailSize:{type:"Size",id:18},customEvent:{type:"string",id:19},customExts:{rule:"repeated",type:"KeyValue",id:20}},nested:{Type:{values:{TEXT:0,IMAGE:1,VIDEO:2,LOCATION:3,VOICE:4,FILE:5,COMMAND:6,CUSTOM:7}},Size:{fields:{width:{type:"double",id:1},height:{type:"double",id:2}}}}},Type:{values:{NORMAL:0,CHAT:1,GROUPCHAT:2,CHATROOM:3,READ_ACK:4,DELIVER_ACK:5,RECALL:6}},MessageConfig:{fields:{allowGroupAck:{type:"bool",id:1}}}}},KeyValue:{oneofs:{value:{oneof:["varintValue","floatValue","doubleValue","stringValue"]}},fields:{key:{type:"string",id:1},type:{type:"ValueType",id:2},varintValue:{type:"int64",id:3},floatValue:{type:"float",id:4},doubleValue:{type:"double",id:5},stringValue:{type:"string",id:6}},nested:{ValueType:{values:{BOOL:1,INT:2,UINT:3,LLINT:4,FLOAT:5,DOUBLE:6,STRING:7,JSON_STRING:8}}}},JID:{fields:{appKey:{type:"string",id:1},name:{type:"string",id:2},domain:{type:"string",id:3},clientResource:{type:"string",id:4}}},ConferenceBody:{fields:{sessionId:{type:"string",id:1},operation:{type:"Operation",id:2},conferenceId:{type:"string",id:3},type:{type:"Type",id:4},content:{type:"string",id:5},network:{type:"string",id:6},version:{type:"string",id:7},identity:{type:"Identity",id:8},duration:{type:"string",id:9},peerName:{type:"string",id:10},endReason:{type:"EndReason",id:11},status:{type:"Status",id:12},isDirect:{type:"bool",id:13},controlType:{type:"StreamControlType",id:14},routeFlag:{type:"int32",id:15},routeKey:{type:"string",id:16}},nested:{Status:{fields:{errorCode:{type:"int32",id:1}}},Operation:{values:{JOIN:0,INITIATE:1,ACCEPT_INITIATE:2,ANSWER:3,TERMINATE:4,REMOVE:5,STREAM_CONTROL:6,MEDIA_REQUEST:7}},Type:{values:{VOICE:0,VIDEO:1}},Identity:{values:{CALLER:0,CALLEE:1}},EndReason:{values:{HANGUP:0,NORESPONSE:1,REJECT:2,BUSY:3,FAIL:4,UNSUPPORTED:5,OFFLINE:6}},StreamControlType:{values:{PAUSE_VOICE:0,RESUME_VOICE:1,PAUSE_VIDEO:2,RESUME_VIDEO:3}}}},MSync:{fields:{version:{type:"Version",id:1,options:{default:"MSYNC_V1"}},guid:{type:"JID",id:2},auth:{type:"string",id:3},compressAlgorimth:{type:"uint32",id:4},crypto:{type:"uint32",id:5},userAgent:{type:"string",id:6},pov:{type:"uint64",id:7},command:{type:"Command",id:8},deviceId:{type:"uint32",id:10},encryptType:{rule:"repeated",type:"EncryptType",id:11,options:{packed:!1}},encryptKey:{type:"string",id:12},payload:{type:"bytes",id:9}},nested:{Version:{values:{MSYNC_V1:0,MSYNC_V2:1}},Command:{values:{SYNC:0,UNREAD:1,NOTICE:2,PROVISION:3}}}},EncryptType:{values:{ENCRYPT_NONE:0,ENCRYPT_AES_128_CBC:1,ENCRYPT_AES_256_CBC:2}},CommSyncUL:{fields:{meta:{type:"Meta",id:1},key:{type:"uint64",id:2},queue:{type:"JID",id:3},isRoam:{type:"bool",id:4},lastFullRoamKey:{type:"uint64",id:5}}},CommSyncDL:{fields:{status:{type:"Status",id:1},metaId:{type:"uint64",id:2},serverId:{type:"uint64",id:3},metas:{rule:"repeated",type:"Meta",id:4},nextKey:{type:"uint64",id:5},queue:{type:"JID",id:6},isLast:{type:"bool",id:7},timestamp:{type:"uint64",id:8},isRoam:{type:"bool",id:9}}},CommNotice:{fields:{queue:{type:"JID",id:1}}},CommUnreadUL:{fields:{}},CommUnreadDL:{fields:{status:{type:"Status",id:1},unread:{rule:"repeated",type:"MetaQueue",id:2},timestamp:{type:"uint64",id:3}}},MetaQueue:{fields:{queue:{type:"JID",id:1},n:{type:"uint32",id:2}}},Meta:{fields:{id:{type:"uint64",id:1},from:{type:"JID",id:2},to:{type:"JID",id:3},timestamp:{type:"uint64",id:4},ns:{type:"NameSpace",id:5},payload:{type:"bytes",id:6},routetype:{type:"RouteType",id:7}},nested:{NameSpace:{values:{STATISTIC:0,CHAT:1,MUC:2,ROSTER:3,CONFERENCE:4}},RouteType:{values:{ROUTE_ALL:0,ROUTE_ONLINE:1}}}},Status:{fields:{errorCode:{type:"ErrorCode",id:1},reason:{type:"string",id:2},redirectInfo:{rule:"repeated",type:"RedirectInfo",id:3}},nested:{ErrorCode:{values:{OK:0,FAIL:1,UNAUTHORIZED:2,MISSING_PARAMETER:3,WRONG_PARAMETER:4,REDIRECT:5,TOKEN_EXPIRED:6,PERMISSION_DENIED:7,NO_ROUTE:8,UNKNOWN_COMMAND:9,PB_PARSER_ERROR:10,BIND_ANOTHER_DEVICE:11,IM_FORBIDDEN:12,TOO_MANY_DEVICES:13,PLATFORM_LIMIT:14,USER_MUTED:15,ENCRYPT_DISABLE:16,ENCRYPT_ENABLE:17,DECRYPT_FAILURE:18}}}},RedirectInfo:{fields:{host:{type:"string",id:1},port:{type:"uint32",id:2}}},Provision:{fields:{osType:{type:"OsType",id:1},version:{type:"string",id:2},networkType:{type:"NetworkType",id:3},appSign:{type:"string",id:4},compressType:{rule:"repeated",type:"CompressType",id:5,options:{packed:!1}},encryptType:{rule:"repeated",type:"EncryptType",id:6,options:{packed:!1}},encryptKey:{type:"string",id:7},status:{type:"Status",id:8},deviceUuid:{type:"string",id:9},isManualLogin:{type:"bool",id:10},password:{type:"string",id:11},deviceName:{type:"string",id:12},resource:{type:"string",id:13},auth:{type:"string",id:14}},nested:{OsType:{values:{OS_IOS:0,OS_ANDROID:1,OS_LINUX:2,OS_OSX:3,OS_WIN:4,OS_OTHER:16}},NetworkType:{values:{NETWORK_NONE:0,NETWORK_WIFI:1,NETWORK_4G:2,NETWORK_3G:3,NETWORK_2G:4,NETWORK_WIRE:5}},CompressType:{values:{COMPRESS_NONE:0,COMPRESS_ZLIB:1}}}},MUCBody:{fields:{mucId:{type:"JID",id:1},operation:{type:"Operation",id:2},from:{type:"JID",id:3},to:{rule:"repeated",type:"JID",id:4},setting:{type:"Setting",id:5},reason:{type:"string",id:6},isChatroom:{type:"bool",id:7},status:{type:"Status",id:8}},nested:{Operation:{values:{CREATE:0,DESTROY:1,JOIN:2,LEAVE:3,APPLY:4,APPLY_ACCEPT:5,APPLY_DECLINE:6,INVITE:7,INVITE_ACCEPT:8,INVITE_DECLINE:9,KICK:10,GET_BLACKLIST:11,BAN:12,ALLOW:13,UPDATE:14,BLOCK:15,UNBLOCK:16,PRESENCE:17,ABSENCE:18,DIRECT_JOINED:19,ASSIGN_OWNER:20,ADD_ADMIN:21,REMOVE_ADMIN:22,ADD_MUTE:23,REMOVE_MUTE:24,UPDATE_ANNOUNCEMENT:25,DELETE_ANNOUNCEMENT:26,UPLOAD_FILE:27,DELETE_FILE:28,ADD_USER_WHITE_LIST:29,REMOVE_USER_WHITE_LIST:30,BAN_GROUP:31,REMOVE_BAN_GROUP:32}},Setting:{fields:{name:{type:"string",id:1},desc:{type:"string",id:2},type:{type:"Type",id:3},maxUsers:{type:"int32",id:4},owner:{type:"string",id:5}},nested:{Type:{values:{PRIVATE_OWNER_INVITE:0,PRIVATE_MEMBER_INVITE:1,PUBLIC_JOIN_APPROVAL:2,PUBLIC_JOIN_OPEN:3,PUBLIC_ANONYMOUS:4}}}},Status:{fields:{errorCode:{type:"ErrorCode",id:1},description:{type:"string",id:2}},nested:{ErrorCode:{values:{OK:0,PERMISSION_DENIED:1,WRONG_PARAMETER:2,MUC_NOT_EXIST:3,USER_NOT_EXIST:4,UNKNOWN:5}}}}}},RosterBody:{fields:{operation:{type:"Operation",id:1},status:{type:"Status",id:2},from:{type:"JID",id:3},to:{rule:"repeated",type:"JID",id:4},reason:{type:"string",id:5},rosterVer:{type:"string",id:6},biDirection:{type:"bool",id:7}},nested:{Operation:{values:{GET_ROSTER:0,GET_BLACKLIST:1,ADD:2,REMOVE:3,ACCEPT:4,DECLINE:5,BAN:6,ALLOW:7,REMOTE_ACCEPT:8,REMOTE_DECLINE:9}},Status:{fields:{errorCode:{type:"ErrorCode",id:1},description:{type:"string",id:2}},nested:{ErrorCode:{values:{OK:0,USER_NOT_EXIST:1,USER_ALREADY_FRIEND:2,USER_ALREADY_BLACKLIST:3}}}}}},StatisticsBody:{fields:{operation:{type:"Operation",id:1},os:{type:"OsType",id:2},version:{type:"string",id:3},network:{type:"NetworkType",id:4},imTime:{type:"uint32",id:5},chatTime:{type:"uint32",id:6},location:{type:"string",id:7}},nested:{Operation:{values:{INFORMATION:0,USER_REMOVED:1,USER_LOGIN_ANOTHER_DEVICE:2,USER_KICKED_BY_CHANGE_PASSWORD:3,USER_KICKED_BY_OTHER_DEVICE:4}},OsType:{values:{OS_IOS:0,OS_ANDROID:1,OS_LINUX:2,OS_OSX:3,OS_WIN:4,OS_OTHER:16}},NetworkType:{values:{NETWORK_NONE:0,NETWORK_WIFI:1,NETWORK_4G:2,NETWORK_3G:3,NETWORK_2G:4,NETWORK_WIRE:5}}}}}}}}}}};t.default=i},function(e,t,n){"use strict";e.exports=o;var i=n(3);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var r=o.zero=new o(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return r;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new o(n,i)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if("string"==typeof e||e instanceof String){if(!i.Long)return o.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):r},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;o.fromHash=function(e){return e===s?r:new o((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){"use strict";var i=n(0)(n(5));e.exports=a;var o,r,s=n(16);function a(e,t,n,i,o,a){if(s.call(this,e,t,i,void 0,void 0,o,a),!r.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}((a.prototype=Object.create(s.prototype)).constructor=a).className="MapField",a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return r.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===o.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return s.prototype.resolve.call(this)},a.d=function(e,t,n){return"function"==typeof n?n=r.decorateType(n).name:n&&"object"===(0,i.default)(n)&&(n=r.decorateEnum(n).name),function(i,o){r.decorateType(i.constructor).add(new a(o,e,t,n))}},a._configure=function(){o=n(24),r=n(3)}},function(e,t,n){"use strict";e.exports=r;var i,o=n(23);function r(e,t,n,r,s,a,c,u){if(i.isObject(s)?(c=s,s=a=void 0):i.isObject(a)&&(c=a,a=void 0),void 0!==t&&!i.isString(t))throw TypeError("type must be a string");if(!i.isString(n))throw TypeError("requestType must be a string");if(!i.isString(r))throw TypeError("responseType must be a string");o.call(this,e,c),this.type=t||"rpc",this.requestType=n,this.requestStream=!!s||void 0,this.responseType=r,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=u}((r.prototype=Object.create(o.prototype)).constructor=r).className="Method",r.fromJSON=function(e,t){return new r(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},r.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0])},r.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),o.prototype.resolve.call(this))},r._configure=function(){i=n(3)}},function(e,t,n){"use strict";var i;function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}e.exports=o,o.create=function(e){return this.$type.create(e)},o.encode=function(e,t){return arguments.length?1==arguments.length?this.$type.encode(arguments[0]):this.$type.encode(arguments[0],arguments[1]):this.$type.encode(this)},o.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},o.decode=function(e){return this.$type.decode(e)},o.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},o.verify=function(e){return this.$type.verify(e)},o.fromObject=function(e){return this.$type.fromObject(e)},o.toObject=function(e,t){return e=e||this,this.$type.toObject(e,t)},o.prototype.toJSON=function(){return this.$type.toObject(this,i.toJSONOptions)},o.set=function(e,t){o[e]=t},o.get=function(e){return o[e]},o._configure=function(){i=n(3)}},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";e.exports=u;var i,o=n(3),r=n(39);function s(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function a(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new s(a,0,0),this.tail=this.head,this.states=null}function d(e,t,n){t[n]=255&e}function l(e,t){this.len=e,this.next=void 0,this.val=t}function f(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function p(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}u.create=o.Buffer?function(){return(u.create=function(){return new(void 0)})()}:function(){return new u},u.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(u.alloc=o.pool(u.alloc,o.Array.prototype.subarray)),u.prototype._push=function(e,t,n){return this.tail=this.tail.next=new s(e,t,n),this.len+=t,this},l.prototype=Object.create(s.prototype),l.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new l((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(f,10,i.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=i.from(e);return this._push(f,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(f,t.length(),t)},u.prototype.bool=function(e){return this._push(d,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(p,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=i.from(e);return this._push(p,4,t.lo)._push(p,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var h=o.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(d,1,0);if(o.isString(e)){var n=u.alloc(t=r.length(e));r.write(e,n,0),e=n}return this.uint32(t)._push(h,t,e)},u.prototype.string=function(e){var t=r.length(e);return t?this.uint32(t)._push(r.write,t,e):this._push(d,1,0)},u.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new s(a,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(a,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},u._configure=function(){i=n(66),n(96),r=n(39)}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";var i=e.exports;i.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var o=new Array(64),r=new Array(123),s=0;s<64;)r[o[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;i.encode=function(e,t,n){for(var i,r=null,s=[],a=0,c=0;t<n;){var u=e[t++];switch(c){case 0:s[a++]=o[u>>2],i=(3&u)<<4,c=1;break;case 1:s[a++]=o[i|u>>4],i=(15&u)<<2,c=2;break;case 2:s[a++]=o[i|u>>6],s[a++]=o[63&u],c=0}a>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=o[i],s[a++]=61,1===c&&(s[a++]=61)),r?(a&&r.push(String.fromCharCode.apply(String,s.slice(0,a))),r.join("")):String.fromCharCode.apply(String,s.slice(0,a))},i.decode=function(e,t,n){for(var i,o=n,s=0,a=0;a<e.length;){var c=e.charCodeAt(a++);if(61===c&&s>1)break;if(void 0===(c=r[c]))throw Error("invalid encoding");switch(s){case 0:i=c,s=1;break;case 1:t[n++]=i<<2|(48&c)>>4,i=c,s=2;break;case 2:t[n++]=(15&i)<<4|(60&c)>>2,i=c,s=3;break;case 3:t[n++]=(3&i)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return n-o},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){"use strict";var i,o,r,s,a,c,u,d,l,f,p;e.exports=C,C.filename=null,C.defaults={keepCase:!1};var h=/^[1-9][0-9]*$/,m=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,_=/^-?0[x][0-9a-fA-F]+$/,v=/^0[0-7]+$/,y=/^-?0[0-7]+$/,b=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,w=/^[a-zA-Z_][a-zA-Z_0-9]*$/,S=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,I=/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/;function C(e,t,n){t instanceof o||(n=t,t=new o),n||(n=C.defaults);var x,E,O,T,N,R=i(e,n.alternateCommentMode||!1),M=R.next,k=R.push,A=R.peek,j=R.skip,D=R.cmnt,P=!0,L=!1,$=t,U=n.keepCase?function(e){return e}:p.camelCase;function B(e,t,n){var i=C.filename;return n||(C.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(i?i+", ":"")+"line "+R.line+")")}function F(){var e,t=[];do{if('"'!==(e=M())&&"'"!==e)throw B(e);t.push(M()),j(e),e=A()}while('"'===e||"'"===e);return t.join("")}function W(e){var t=M();switch(t){case"'":case'"':return k(t),F();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e,t){var n=1;switch("-"===e.charAt(0)&&(n=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return n*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(h.test(e))return n*parseInt(e,10);if(g.test(e))return n*parseInt(e,16);if(v.test(e))return n*parseInt(e,8);if(b.test(e))return n*parseFloat(e);throw B(e,"number",t)}(t,!0)}catch(n){if(e&&S.test(t))return t;throw B(t,"value")}}function V(e,t){var n,i;do{!t||'"'!==(n=A())&&"'"!==n?e.push([i=G(M()),j("to",!0)?G(M()):i]):e.push(F())}while(j(",",!0));j(";")}function G(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw B(e,"id");if(m.test(e))return parseInt(e,10);if(_.test(e))return parseInt(e,16);if(y.test(e))return parseInt(e,8);throw B(e,"id")}function q(){if(void 0!==x)throw B("package");if(x=M(),!S.test(x))throw B(x,"name");$=$.define(x),j(";")}function H(){var e,t=A();switch(t){case"weak":e=O||(O=[]),M();break;case"public":M();default:e=E||(E=[])}t=F(),j(";"),e.push(t)}function J(){if(j("="),T=F(),!(L="proto3"===T)&&"proto2"!==T)throw B(T,"syntax");j(";")}function K(e,t){switch(t){case"option":return Y(e,t),j(";"),!0;case"message":return function(e,t){if(!w.test(t=M()))throw B(t,"type name");var n=new r(t);z(n,(function(e){if(!K(n,e))switch(e){case"map":!function(e){j("<");var t=M();if(void 0===f.mapKey[t])throw B(t,"type");j(",");var n=M();if(!S.test(n))throw B(n,"type");j(">");var i=M();if(!w.test(i))throw B(i,"name");j("=");var o=new a(U(i),G(M()),t,n);z(o,(function(e){if("option"!==e)throw B(e);Y(o,e),j(";")}),(function(){ee(o)})),e.add(o)}(n);break;case"required":case"optional":case"repeated":X(n,e);break;case"oneof":!function(e,t){if(!w.test(t=M()))throw B(t,"name");var n=new c(U(t));z(n,(function(e){"option"===e?(Y(n,e),j(";")):(k(e),X(n,"optional"))})),e.add(n)}(n,e);break;case"extensions":V(n.extensions||(n.extensions=[]));break;case"reserved":V(n.reserved||(n.reserved=[]),!0);break;default:if(!L||!S.test(e))throw B(e);k(e),X(n,"optional")}})),e.add(n)}(e,t),!0;case"enum":return function(e,t){if(!w.test(t=M()))throw B(t,"name");var n=new u(t);z(n,(function(e){switch(e){case"option":Y(n,e),j(";");break;case"reserved":V(n.reserved||(n.reserved=[]),!0);break;default:!function(e,t){if(!w.test(t))throw B(t,"name");j("=");var n=G(M(),!0),i={};z(i,(function(e){if("option"!==e)throw B(e);Y(i,e),j(";")}),(function(){ee(i)})),e.add(t,n,i.comment)}(n,e)}})),e.add(n)}(e,t),!0;case"service":return function(e,t){if(!w.test(t=M()))throw B(t,"service name");var n=new d(t);z(n,(function(e){if(!K(n,e)){if("rpc"!==e)throw B(e);!function(e,t){var n=t;if(!w.test(t=M()))throw B(t,"name");var i,o,r,s,a=t;if(j("("),j("stream",!0)&&(o=!0),!S.test(t=M()))throw B(t);if(i=t,j(")"),j("returns"),j("("),j("stream",!0)&&(s=!0),!S.test(t=M()))throw B(t);r=t,j(")");var c=new l(a,n,i,r,o,s);z(c,(function(e){if("option"!==e)throw B(e);Y(c,e),j(";")})),e.add(c)}(n,e)}})),e.add(n)}(e,t),!0;case"extend":return function(e,t){if(!S.test(t=M()))throw B(t,"reference");var n=t;z(null,(function(t){switch(t){case"required":case"repeated":case"optional":X(e,t,n);break;default:if(!L||!S.test(t))throw B(t);k(t),X(e,"optional",n)}}))}(e,t),!0}return!1}function z(e,t,n){var i=R.line;if(e&&(e.comment=D(),e.filename=C.filename),j("{",!0)){for(var o;"}"!==(o=M());)t(o);j(";",!0)}else n&&n(),j(";"),e&&"string"!=typeof e.comment&&(e.comment=D(i))}function X(e,t,n){var i=M();if("group"!==i){if(!S.test(i))throw B(i,"type");var o=M();if(!w.test(o))throw B(o,"name");o=U(o),j("=");var a=new s(o,G(M()),i,t,n);z(a,(function(e){if("option"!==e)throw B(e);Y(a,e),j(";")}),(function(){ee(a)})),e.add(a),L||!a.repeated||void 0===f.packed[i]&&void 0!==f.basic[i]||a.setOption("packed",!1,!0)}else!function(e,t){var n=M();if(!w.test(n))throw B(n,"name");var i=p.lcFirst(n);n===i&&(n=p.ucFirst(n)),j("=");var o=G(M()),a=new r(n);a.group=!0;var c=new s(i,o,n,t);c.filename=C.filename,z(a,(function(e){switch(e){case"option":Y(a,e),j(";");break;case"required":case"optional":case"repeated":X(a,e);break;default:throw B(e)}})),e.add(a).add(c)}(e,t)}function Y(e,t){var n=j("(",!0);if(!S.test(t=M()))throw B(t,"name");var i=t;n&&(j(")"),i="("+i+")",t=A(),I.test(t)&&(i+=t,M())),j("="),Z(e,i)}function Z(e,t){if(j("{",!0))do{if(!w.test(N=M()))throw B(N,"name");"{"===A()?Z(e,t+"."+N):(j(":"),"{"===A()?Z(e,t+"."+N):Q(e,t+"."+N,W(!0)))}while(!j("}",!0));else Q(e,t,W(!0))}function Q(e,t,n){e.setOption&&e.setOption(t,n)}function ee(e){if(j("[",!0)){do{Y(e,"option")}while(j(",",!0));j("]")}return e}for(;null!==(N=M());)switch(N){case"package":if(!P)throw B(N);q();break;case"import":if(!P)throw B(N);H();break;case"syntax":if(!P)throw B(N);J();break;case"option":if(!P)throw B(N);Y($,N),j(";");break;default:if(K($,N)){P=!1;continue}throw B(N)}return C.filename=null,{package:x,imports:E,weakImports:O,syntax:T,root:t}}C._configure=function(){i=n(98),o=n(40),r=n(22),s=n(16),a=n(67),c=n(34),u=n(10),d=n(41),l=n(68),f=n(24),p=n(3)}},function(e,t,n){"use strict";e.exports=p;var i=/[\s{}=;:[\],'"()<>]/g,o=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,r=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,s=/^ *[*/]+ */,a=/^\s*\*?\/*/,c=/\n/g,u=/\s/,d=/\\(.?)/g,l={0:"\0",r:"\r",n:"\n",t:"\t"};function f(e){return e.replace(d,(function(e,t){switch(t){case"\\":case"":return t;default:return l[t]||""}}))}function p(e,t){e=e.toString();var n=0,d=e.length,l=1,p=null,h=null,m=0,g=!1,_=[],v=null;function y(e){return Error("illegal "+e+" (line "+l+")")}function b(t){return e.charAt(t)}function w(n,i){p=e.charAt(n++),m=l,g=!1;var o,r=n-(t?2:3);do{if(--r<0||"\n"===(o=e.charAt(r))){g=!0;break}}while(" "===o||"\t"===o);for(var u=e.substring(n,i).split(c),d=0;d<u.length;++d)u[d]=u[d].replace(t?a:s,"").trim();h=u.join("\n").trim()}function S(t){var n=I(t),i=e.substring(t,n);return/^\s*\/{1,2}/.test(i)}function I(e){for(var t=e;t<d&&"\n"!==b(t);)t++;return t}function C(){if(_.length>0)return _.shift();if(v)return function(){var t="'"===v?r:o;t.lastIndex=n-1;var i=t.exec(e);if(!i)throw y("string");return n=t.lastIndex,x(v),v=null,f(i[1])}();var s,a,c,p,h;do{if(n===d)return null;for(s=!1;u.test(c=b(n));)if("\n"===c&&++l,++n===d)return null;if("/"===b(n)){if(++n===d)throw y("comment");if("/"===b(n))if(t){if(p=n,h=!1,S(n)){h=!0;do{if((n=I(n))===d)break;n++}while(S(n))}else n=Math.min(d,I(n)+1);h&&w(p,n),l++,s=!0}else{for(h="/"===b(p=n+1);"\n"!==b(++n);)if(n===d)return null;++n,h&&w(p,n-1),++l,s=!0}else{if("*"!==(c=b(n)))return"/";p=n+1,h=t||"*"===b(p);do{if("\n"===c&&++l,++n===d)throw y("comment");a=c,c=b(n)}while("*"!==a||"/"!==c);++n,h&&w(p,n-2),s=!0}}}while(s);var m=n;if(i.lastIndex=0,!i.test(b(m++)))for(;m<d&&!i.test(b(m));)++m;var g=e.substring(n,n=m);return'"'!==g&&"'"!==g||(v=g),g}function x(e){_.push(e)}function E(){if(!_.length){var e=C();if(null===e)return null;x(e)}return _[0]}return Object.defineProperty({next:C,peek:E,push:x,skip:function(e,t){var n=E();if(n===e)return C(),!0;if(!t)throw y("token '"+n+"', '"+e+"' expected");return!1},cmnt:function(e){var n=null;return void 0===e?m===l-1&&(t||"*"===p||g)&&(n=h):(m<e&&E(),m!==e||g||!t&&"/"!==p||(n=h)),n}},"line",{get:function(){return l}})}p.unescape=f},function(e,t,n){"use strict";e.exports=o;var i=n(3);function o(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(o.prototype=Object.create(i.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,n,o,r,s){if(!r)throw TypeError("request must be specified");var a=this;if(!s)return i.asPromise(e,a,t,n,o,r);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](r).finish(),(function(e,n){if(e)return a.emit("error",e,t),s(e);if(null!==n){if(!(n instanceof o))try{n=o[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",n,t),s(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){"use strict";e.exports=r;var i,o=/\/|\./;function r(e,t){o.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),r[e]=t}r("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),r("duration",{Duration:i={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),r("timestamp",{Timestamp:i}),r("empty",{Empty:{fields:{}}}),r("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),r("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),r("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),r.get=function(e){return r[e]||null}},function(e,n,i){"use strict";e.exports=c;var o,r,s=i(3);function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,d="undefined"!=typeof Uint8Array?function(e){return e instanceof Uint8Array||Array.isArray(e)?new c(e):("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&t("warn",'"illegal buffer"'," at newSDK/wxsdk3.4.0.js:1"),new c(new Uint8Array(e)))}:function(e){if(Array.isArray(e))return new c(e);t("warn",'"illegal buffer"'," at newSDK/wxsdk3.4.0.js:1")};function l(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new o(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}c.create=s.Buffer?function(e){return(c.create=function(e){return s.Buffer.isBuffer(e)?new(void 0)(e):d(e)})(e)}:d,c.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return r.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;;){if(4==(e=7&this.uint32()))break;this.skipType(e)}break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(){o=i(66),r=i(39);var e=s.Long?"toLong":"toNumber";s.merge(c.prototype,{int64:function(){return l.call(this)[e](!1)},uint64:function(){return l.call(this)[e](!0)},sint64:function(){return l.call(this).zzDecode()[e](!1)},fixed64:function(){return p.call(this)[e](!0)},sfixed64:function(){return p.call(this)[e](!1)}})}},function(e,t,n){"use strict";var i,o,r=n(0)(n(5));function s(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,n,r){var a=r.types;if(e.resolvedType)if(e.resolvedType instanceof i){if(Object.keys(e.resolvedType.values).indexOf(n)<0)return s(e,"enum value")}else{var c=a[t].verify(n);if(c)return e.name+"."+c}else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":if(!o.isInteger(n))return s(e,"integer");break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":if(!(o.isInteger(n)||n&&o.isInteger(n.low)&&o.isInteger(n.high)))return s(e,"integer|Long");break;case"float":case"double":if("number"!=typeof n)return s(e,"number");break;case"bool":if("boolean"!=typeof n)return s(e,"boolean");break;case"string":if(!o.isString(n))return s(e,"string");break;case"bytes":if(!(n&&"number"==typeof n.length||o.isString(n)))return s(e,"buffer")}}function c(e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":if(!o.key32Re.test(t))return s(e,"integer key");break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":if(!o.key64Re.test(t))return s(e,"integer|Long key");break;case"bool":if(!o.key2Re.test(t))return s(e,"boolean key")}}function u(e){return function(t){return function(n){var i;if("object"!==(0,r.default)(n)||null===n)return"object expected";var u,d={};e.oneofsArray.length&&(u={});for(var l=0;l<e.fieldsArray.length;++l){var f,p=e._fieldsArray[l].resolve(),h=n[p.name];if(!p.optional||null!=h&&n.hasOwnProperty(p.name))if(p.map){if(!o.isObject(h))return s(p,"object");var m=Object.keys(h);for(f=0;f<m.length;++f){if(i=c(p,m[f]))return i;if(i=a(p,l,h[m[f]],t))return i}}else if(p.repeated){if(!Array.isArray(h))return s(p,"array");for(f=0;f<h.length;++f)if(i=a(p,l,h[f],t))return i}else{if(p.partOf){var g=p.partOf.name;if(1===d[p.partOf.name]&&1===u[g])return p.partOf.name+": multiple values";u[g]=1}if(i=a(p,l,h,t))return i}}}}}e.exports=u,u._configure=function(){i=n(10),o=n(3)}},function(e,n,i){"use strict";var o,r;function s(e){return function(n){var i=n.Writer,s=n.types,a=n.util;return function(n,c){c=c||i.create();for(var u=e.fieldsArray.slice().sort(a.compareFieldsById),d=0;d<u.length;d++){var l=u[d],f=e._fieldsArray.indexOf(l),p=l.resolvedType instanceof o?"uint32":l.type,h=r.basic[p],m=n[l.name];if(l.resolvedType instanceof o&&"string"==typeof m&&(m=s[f].values[m]),l.map){if(null!=m&&n.hasOwnProperty(l.name))for(var g=Object.keys(m),_=0;_<g.length;++_)c.uint32((l.id<<3|2)>>>0).fork().uint32(8|r.mapKey[l.keyType])[l.keyType](g[_]),void 0===h?s[f].encode(m[g[_]],c.uint32(18).fork()).ldelim().ldelim():c.uint32(16|h)[p](m[g[_]]).ldelim()}else if(l.repeated){if(m&&m.length)if(l.packed&&void 0!==r.packed[p]){c.uint32((l.id<<3|2)>>>0).fork();for(var v=0;v<m.length;v++)c[p](m[v]);c.ldelim()}else for(var y=0;y<m.length;y++)void 0===h?l.resolvedType.group?s[f].encode(m[y],c.uint32((l.id<<3|3)>>>0)).uint32((l.id<<3|4)>>>0):s[f].encode(m[y],c.uint32((l.id<<3|2)>>>0).fork()).ldelim():c.uint32((l.id<<3|h)>>>0)[p](m[y])}else(!l.optional||null!=m&&n.hasOwnProperty(l.name))&&(l.optional||null!=m&&n.hasOwnProperty(l.name)||t("warn","\u6ce8\u610f\u5566!!!\u5f88\u5927\u6982\u7387\u4f1a\u62a5\u9519 \u7c7b\u578b:",n.$type?n.$type.name:"\u4e0d\u6653\u5f97","\u6ca1\u6709\u8bbe\u7f6e\u5bf9\u5e94\u7684\u5c5e\u6027:",l.name,"\u68c0\u67e5\u662f\u4e0d\u662fproto\u6587\u4ef6\u5c5e\u6027\u8bbe\u7f6e\u4e3a\u4e86required"," at newSDK/wxsdk3.4.0.js:1"),void 0===h?l.resolvedType.group?s[f].encode(m,c.uint32((l.id<<3|3)>>>0)).uint32((l.id<<3|4)>>>0):s[f].encode(m,c.uint32((l.id<<3|2)>>>0).fork()).ldelim():c.uint32((l.id<<3|h)>>>0)[p](m))}return c}}}e.exports=s,s._configure=function(){o=i(10),r=i(24)}},function(e,n,i){"use strict";var o,r,s,a=i(0)(i(5));function c(e){return"missing required '"+e.name+"'"}function u(e){return function(n){var i=n.Reader,u=n.types,d=n.util;return function(n,l){n instanceof i||(n=i.create(n));for(var f,p=void 0===l?n.len:n.pos+l,h=new this.ctor;n.pos<p;){var m=n.uint32();if(e.group&&4==(7&m))break;for(var g=m>>>3,_=0,v=!1;_<e.fieldsArray.length;++_){var y=e._fieldsArray[_].resolve(),b=y.name,w=y.resolvedType instanceof o?"int32":y.type;if(g==y.id){if(v=!0,y.map)n.skip().pos++,h[b]===d.emptyObject&&(h[b]={}),f=n[y.keyType](),n.pos++,null!=r.long[y.keyType]?null==r.basic[w]?h[b]["object"===(0,a.default)(f)?d.longToHash(f):f]=u[_].decode(n,n.uint32()):h[b]["object"===(0,a.default)(f)?d.longToHash(f):f]=n[w]():null==r.basic[w]?h[b]=u[_].decode(n,n.uint32()):h[b]=n[w]();else if(y.repeated)if(h[b]&&h[b].length||(h[b]=[]),null!=r.packed[w]&&2==(7&m))for(var S=n.uint32()+n.pos;n.pos<S;)h[b].push(n[w]());else null==r.basic[w]?y.resolvedType.group?h[b].push(u[_].decode(n)):h[b].push(u[_].decode(n,n.uint32())):h[b].push(n[w]());else null==r.basic[w]?y.resolvedType.group?h[b]=u[_].decode(n):h[b]=u[_].decode(n,n.uint32()):h[b]=n[w]();break}}v||(t("log","t",m," at newSDK/wxsdk3.4.0.js:1"),n.skipType(7&m))}for(_=0;_<e._fieldsArray.length;++_){var I=e._fieldsArray[_];if(I.required&&!h.hasOwnProperty(I.name))throw s.ProtocolError(c(I),{instance:h})}return h}}}e.exports=u,u._configure=function(){o=i(10),r=i(24),s=i(3)}},function(e,t,n){"use strict";var i,o=t;o[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=this.lookup(e["@type"]);if(t){var n="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return this.create({type_url:"/"+n,value:t.encode(t.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){if(t&&t.json&&e.type_url&&e.value){var n=e.type_url.substring(e.type_url.lastIndexOf("/")+1),o=this.lookup(n);o&&(e=o.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var r=e.$type.toObject(e,t);return r["@type"]=e.$type.fullName,r}return this.toObject(e,t)}},o._configure=function(){i=n(69)}},function(e,t,n){"use strict";var i,o,r=n(0)(n(5)),s=e.exports;function a(e,t,n,s){var a=s.m,c=s.d,u=s.types,d=s.ksi,l=void 0!==d;if(e.resolvedType)if(e.resolvedType instanceof i){for(var f=l?c[n][d]:c[n],p=e.resolvedType.values,h=Object.keys(p),m=0;m<h.length;m++)if(!(e.repeated&&p[h[m]]===e.typeDefault||h[m]!=f&&p[h[m]]!=f)){l?a[n][d]=p[h[m]]:a[n]=p[h[m]];break}}else{if("object"!==(0,r.default)(l?c[n][d]:c[n]))throw TypeError(e.fullName+": object expected");l?a[n][d]=u[t].fromObject(c[n][d]):a[n]=u[t].fromObject(c[n])}else{var g=!1;switch(e.type){case"double":case"float":l?a[n][d]=Number(c[n][d]):a[n]=Number(c[n]);break;case"uint32":case"fixed32":l?a[n][d]=c[n][d]>>>0:a[n]=c[n]>>>0;break;case"int32":case"sint32":case"sfixed32":l?a[n][d]=0|c[n][d]:a[n]=0|c[n];break;case"uint64":g=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":o.Long?l?a[n][d]=o.Long.fromValue(c[n][d]).unsigned=g:a[n]=o.Long.fromValue(c[n]).unsigned=g:"string"==typeof(l?c[n][d]:c[n])?l?a[n][d]=parseInt(c[n][d],10):a[n]=parseInt(c[n],10):"number"==typeof(l?c[n][d]:c[n])?l?a[n][d]=c[n][d]:a[n]=c[n]:"object"===(0,r.default)(l?c[n][d]:c[n])&&(l?a[n][d]=new o.LongBits(c[n][d].low>>>0,c[n][d].high>>>0).toNumber(g):a[n]=new o.LongBits(c[n].low>>>0,c[n].high>>>0).toNumber(g));break;case"bytes":"string"==typeof(l?c[n][d]:c[n])?l?o.base64.decode(c[n][d],a[n][d]=o.newBuffer(o.base64.length(c[n][d])),0):o.base64.decode(c[n],a[n]=o.newBuffer(o.base64.length(c[n])),0):(l?c[n][d]:c[n]).length&&(l?a[n][d]=c[n][d]:a[n]=c[n]);break;case"string":l?a[n][d]=String(c[n][d]):a[n]=String(c[n]);break;case"bool":l?a[n][d]=Boolean(c[n][d]):a[n]=Boolean(c[n])}}}function c(e,t,n,r){var s=r.m,a=r.d,c=r.types,u=r.ksi,d=r.o,l=void 0!==u;if(e.resolvedType)e.resolvedType instanceof i?l?a[n][u]=d.enums===String?c[t].values[s[n][u]]:s[n][u]:a[n]=d.enums===String?c[t].values[s[n]]:s[n]:l?a[n][u]=c[t].toObject(s[n][u],d):a[n]=c[t].toObject(s[n],d);else{var f=!1;switch(e.type){case"double":case"float":l?a[n][u]=d.json&&!isFinite(s[n][u])?String(s[n][u]):s[n][u]:a[n]=d.json&&!isFinite(s[n])?String(s[n]):s[n];break;case"uint64":f=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":"number"==typeof s[n][u]?l?a[n][u]=d.longs===String?String(s[n][u]):s[n][u]:a[n]=d.longs===String?String(s[n]):s[n]:l?a[n][u]=d.longs===String?o.Long.prototype.toString.call(s[n][u]):d.longs===Number?new o.LongBits(s[n][u].low>>>0,s[n][u].high>>>0).toNumber(f):s[n][u]:a[n]=d.longs===String?o.Long.prototype.toString.call(s[n]):d.longs===Number?new o.LongBits(s[n].low>>>0,s[n].high>>>0).toNumber(f):s[n];break;case"bytes":l?a[n][u]=d.bytes===String?o.base64.encode(s[n][u],0,s[n][u].length):d.bytes===Array?Array.prototype.slice.call(s[n][u]):s[n][u]:a[n]=d.bytes===String?o.base64.encode(s[n],0,s[n].length):d.bytes===Array?Array.prototype.slice.call(s[n]):s[n];break;default:l?a[n][u]=s[n][u]:a[n]=s[n]}}}s._configure=function(){i=n(10),o=n(3)},s.fromObject=function(e){var t=e.fieldsArray;return function(e){return function(n){if(n instanceof this.ctor)return n;if(!t.length)return new this.ctor;for(var s=new this.ctor,c=0;c<t.length;++c){var u,d=t[c].resolve(),l=d.name;if(d.map){if(n[l]){if("object"!==(0,r.default)(n[l]))throw TypeError(d.fullName+": object expected");s[l]={}}var f=Object.keys(n[l]);for(u=0;u<f.length;++u)a(d,c,l,o.merge(o.copy(e),{m:s,d:n,ksi:f[u]}))}else if(d.repeated){if(n[l]){if(!Array.isArray(n[l]))throw TypeError(d.fullName+": array expected");for(s[l]=[],u=0;u<n[l].length;++u)a(d,c,l,o.merge(o.copy(e),{m:s,d:n,ksi:u}))}}else(d.resolvedType instanceof i||null!=n[l])&&a(d,c,l,o.merge(o.copy(e),{m:s,d:n}))}return s}}},s.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);return function(n){return t.length?function(r,s){s=s||{};for(var a,u,d={},l=[],f=[],p=[],h=0;h<t.length;++h)t[h].partOf||(t[h].resolve().repeated?l:t[h].map?f:p).push(t[h]);if(l.length&&(s.arrays||s.defaults))for(h=0;h<l.length;++h)d[l[h].name]=[];if(f.length&&(s.objects||s.defaults))for(h=0;h<f.length;++h)d[f[h].name]={};if(p.length&&s.defaults)for(h=0;h<p.length;++h)if(u=(a=p[h]).name,a.resolvedType instanceof i)d[u]=s.enums=String?a.resolvedType.valuesById[a.typeDefault]:a.typeDefault;else if(a.long)if(o.Long){var m=new o.Long(a.typeDefault.low,a.typeDefault.high,a.typeDefault.unsigned);d[u]=s.longs===String?m.toString():s.longs===Number?m.toNumber():m}else d[u]=s.longs===String?a.typeDefault.toString():a.typeDefault.toNumber();else a.bytes?d[u]=s.bytes===String?String.fromCharCode.apply(String,a.typeDefault):Array.prototype.slice.call(a.typeDefault).join("*..*").split("*..*"):d[u]=a.typeDefault;var g=!1;for(h=0;h<t.length;++h){u=(a=t[h]).name;var _,v,y=e._fieldsArray.indexOf(a);if(a.map){if(g||(g=!0),r[u]&&(_=Object.keys(r[u]).length))for(d[u]={},v=0;v<_.length;++v)c(a,y,u,o.merge(o.copy(n),{m:r,d:d,ksi:_[v],o:s}))}else if(a.repeated){if(r[u]&&r[u].length)for(d[u]=[],v=0;v<r[u].length;++v)c(a,y,u,o.merge(o.copy(n),{m:r,d:d,ksi:v,o:s}))}else null!=r[u]&&r.hasOwnProperty(u)&&c(a,y,u,o.merge(o.copy(n),{m:r,d:d,o:s})),a.partOf&&s.oneofs&&(d[a.partOf.name]=u)}return d}:function(){return{}}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,n,i){"use strict";var o=i(0);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,s=o(i(38)),a=o(i(54)),c=o(i(8)),u=o(i(65)),d=o(i(158)),l=o(i(7)),f=o(i(165)),p=o(i(14)),h=o(i(28)),m=p.default.getLogger("IM-SDK-LOG"),g=(0,l.default)(),_=(0,u.default)(),v=a.default.connection.prototype.root=d.default.Root.fromJSON(_),y=f.default.getEnvInfo(),b=y.global;a.default.connection.prototype.getParams({root:v,utils:f.default});var w=function(e,t,n,i){var o={};if("zfb"===y.platform){for(var s="",a=0;a<e.length;a++)s+=String.fromCharCode(e[a]);o={data:s=h.default.btoa(s),isBuffer:!1,complete:function(e){},fail:function(e){"sendSocketMessage:fail taskID not exist"==e.errMsg&&t.reconnect(),t._msgHash[i]&&t._msgHash[i].fail({id:i})}}}else o={data:new Uint8Array(e).buffer,fail:function(e){"sendSocketMessage:fail taskID not exist"==e.errMsg&&t.reconnect(),t._msgHash[i]&&t._msgHash[i].fail({id:i})}};if(n)return o;try{r.send(o)}catch(e){t.onError({type:g.WEBIM_CONNCTION_USER_NOT_ASSIGN_ERROR,message:"send message error",data:e})}};b.onNetworkStatusChange((function(e){t("log","onNetworkStatusChange =>",e," at newSDK/wxsdk3.4.0.js:1"),e.isConnected?function(){if(a.default.conn.isDebug&&t("log","------- im online ------"," at newSDK/wxsdk3.4.0.js:1"),a.default.conn.netStatus="online",!a.default.conn.isOpened())if(a.default.conn.context.accessToken)C({access_token:a.default.conn.context.accessToken},a.default.conn);else{var e={type:g.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected"};a.default.conn.onError(e)}}():(a.default.conn.netStatus="offline",a.default.conn.isDebug&&t("log","------- im offline -----"," at newSDK/wxsdk3.4.0.js:1"))}));var S=function e(t){(0,s.default)(this,e),this.onOpen=my.onSocketOpen,this.onClose=my.onSocketClose,this.onMessage=my.onSocketMessage,this.onError=my.onSocketError,this.close=my.closeSocket,this.send=my.sendSocketMessage,this.connectSocket=my.connectSocket,this.readyState="",this.connect=function(){my.connectSocket({url:t.url,header:{"content-type":"application/json"},success:function(e){m.debug("websocket connect success")},fail:function(){m.debug("websocket connect fail")}})}};function I(e){return b.connectSocket({url:e.url,header:{"content-type":"application/json"},success:function(e){m.debug("socket\u8fde\u63a5\u6210\u529f",e)},fail:function(e){e.errMsg.indexOf("suspend")},complete:function(){}})}var C=function(e,n){var i;e&&"offline"!=a.default.conn.netStatus&&(r="zfb"===y.platform?new S(n):I(n),a.default.connection.prototype.sock=r,r.onOpen((function(){m.debug("onOpen ----"),r.readyState=1,n.autoReconnectInterval=0,n.times=1,n.autoReconnectNumTotal=0;var i=[],o=(new Date).valueOf(),s=v.lookup("easemob.pb.Provision"),c=s.decode(i),u="",d="",l="";"webim"===n.deviceId?(l=o.toString(),u=a.default.connection.deviceId+"_"+l,d=a.default.connection.deviceId):u=d=l=a.default.connection.deviceId+"_"+n.deviceId,n.context.jid.clientResource=u,c.compressType=n.compressType,c.encryptType=n.encryptType,c.osType=n.osType,c.version=n.version,c.deviceName=d,c.resource=u,c.deviceUuid=u,c.auth="$t$"+e.access_token,n.isDebug&&t("log","onOpen:",c," at newSDK/wxsdk3.4.0.js:1"),c=s.encode(c).finish();var f=v.lookup("easemob.pb.MSync"),p=f.decode(i);if(p.version=n.version,p.guid=n.context.jid,p.auth="$t$"+e.access_token,p.command=3,p.deviceId=d,p.encryptType=n.encryptType,p.payload=c,p=f.encode(p).finish(),w(p),n.logOut=!1,n.offLineSendConnecting=!1,n.unSendMsgArr.length>0){for(var h=0;h<n.unSendMsgArr.length;h++){var g=n.unSendMsgArr[h];n.sendMSync(g)}n.unSendMsgArr=[]}})),r.onClose((function(e){if(r.readyState=3,!n.logOut&&n.autoReconnectNumTotal<n.autoReconnectNumMax&&(n.autoReconnectNumTotal<=n.socketHost.length&&n.isHttpDNS||!n.isHttpDNS)){n.reconnect();var t={type:g.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected"};n.onError(t)}else n.logOut?(n.clear(),n.onClosed()):(t={type:g.WEBIM_CONNCTION_DISCONNECTED,message:"websocket has been disconnected"},n.onError(t),n.onClosed())})),r.onMessage((function(e){if("zfb"===y.platform){for(var o=h.default.atob(e.data),r=[],s=0,a=o.length;s<a;++s)r.push(o.charCodeAt(s));var u=v.lookup("easemob.pb.MSync").decode(r)}else u=v.lookup("easemob.pb.MSync").decode(e.data);switch(u.command){case 0:var d=v.lookup("easemob.pb.CommSyncDL");d=d.decode(u.payload);var l=new c.default(d.serverId.low,d.serverId.high,d.serverId.unsigned).toString(),p=new c.default(d.metaId.low,d.metaId.high,d.metaId.unsigned).toString();if(0!==d.metas.length)n._metapayload(d.metas,d.status,n),n._lastsession(d.nextKey,d.queue,n);else if(d.isLast){var m=f.default.checkArray(n._queues,d.queue);!1!==m&&n._queues.splice(m,1),n._queues.length>0&&(n._backqueue(n._queues[0],n),i&&clearTimeout(i))}else if(d.status&&0===d.status.errorCode){if(n._msgHash[p]){try{n._msgHash[p].success instanceof Function&&n._msgHash[p].success(p,l)}catch(e){n.onError({type:g.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,message:"when executing success function error",data:e})}n.onReceivedMessage({id:p,mid:l,to:n._msgHash[p].to}),delete n._msgHash[p]}}else if(d.status&&15===d.status.errorCode)n.onMutedMessage({mid:l});else if(d.status&&1===d.status.errorCode){var _="";switch(d.status.reason){case"blocked":_=g.PERMISSION_DENIED;break;case"group not found":_=g.GROUP_NOT_EXIST;break;case"not in group or chatroom":_=g.GROUP_NOT_JOINED;break;case"exceed recall time limit":_=g.MESSAGE_RECALL_TIME_LIMIT;break;case"message recall disabled":_=g.SERVICE_NOT_ENABLED;break;case"not in group or chatroom white list":_=g.SERVICE_NOT_ALLOW_MESSAGING;break;default:_=g.SERVER_UNKNOWN_ERROR}n._msgHash[p].fail instanceof Function&&n._msgHash[p].fail({type:_,reason:d.status.reason?d.status.reason:"",data:{id:p,mid:l}})}else if(d.status&&7===d.status.errorCode&&"sensitive words"===d.status.reason)n._msgHash[p].fail instanceof Function&&n._msgHash[p].fail({type:g.MESSAGE_INCLUDE_ILLEGAL_CONTENT,data:{id:p,mid:l}});else if(n._msgHash[p]){try{n._msgHash[p].fail instanceof Function&&n._msgHash[p].fail({type:g.WEBIM_LOAD_MSG_ERROR,data:{errorCode:d.status&&d.status.errorCode,reason:d.status&&d.status.reason}})}catch(e){n.onError({type:g.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,message:"when executing fail function error",data:e})}delete n._msgHash[p]}else n.onError({type:g.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,message:"on message error"});break;case 1:var b=v.lookup("easemob.pb.CommUnreadDL");if(b=b.decode(u.payload),n.isDebug&&t("log","\u4e0b\u884cCommUnreadDLMessage\uff1a",b," at newSDK/wxsdk3.4.0.js:1"),0===b.unread.length);else for(s=0;s<b.unread.length;s++)n._backqueue(b.unread[s].queue,n);n._rebuild();break;case 2:var w=v.lookup("easemob.pb.CommNotice").decode(u.payload);if(n.isDebug&&t("log","\u4e0b\u884cnoticeMessage\uff1a",w," at newSDK/wxsdk3.4.0.js:1"),!1!==f.default.checkArray(n._queues,w.queue))return;n._queues.push(w.queue),1==n._queues.length&&n._backqueue(w.queue,n),i&&clearTimeout(i),i=setTimeout((function(){var e=w.queue;!1!==f.default.checkArray(n._queues,e)&&(n._backqueue(e,n),n.isDebug&&t("log","\u4e0a\u884cq: ",e,n._queues,w.queue," at newSDK/wxsdk3.4.0.js:1"))}),2e4);break;case 3:n._receiveProvision(u,n),n.isDebug&&t("log","\u4e0b\u884cProvision\uff1a",u," at newSDK/wxsdk3.4.0.js:1")}})),r.onError((function(e){n.onError({type:g.WEBIM_CONNECTION_ERROR,message:"on socket error",data:e,failMsgs:n._msgHash}),n.reconnect()})),""!=(e.access_token||"")?(n.context.accessToken=e.access_token,r.connect&&r.connect()):n.onError({type:g.WEBIM_CONNCTION_OPEN_USERGRID_ERROR,message:"token not assign error",data:e}))};a.default.connection.prototype._base64transform=w,a.default.connection.prototype._getSock=I,a.default.connection.prototype._login=C,a.default.logger=m,a.default.connection.deviceId="miniProgram";var x=a.default;n.default=x},function(e,t,n){"use strict";e.exports=function(){var e={};function t(t,n,i){return"function"==typeof n?(i=n,n=new e.Root):n||(n=new e.Root),n.load(t,i)}function i(t,n){return n||(n=new e.Root),n.loadSync(t)}function o(t,n,i){return"function"==typeof n?(i=n,n=new e.Root):n||(n=new e.Root),n.parseFromPbString(t,i)}function r(){e.converter._configure(),e.decoder._configure(),e.encoder._configure(),e.Field._configure(),e.MapField._configure(),e.Message._configure(),e.Namespace._configure(),e.Method._configure(),e.ReflectionObject._configure(),e.OneOf._configure(),e.parse._configure(),e.Reader._configure(),e.Root._configure(),e.Service._configure(),e.verifier._configure(),e.Type._configure(),e.types._configure(),e.wrappers._configure(),e.Writer._configure()}if(e.build="minimal",e.Writer=n(94),e.encoder=n(103),e.Reader=n(101),e.util=n(3),e.rpc=n(99),e.roots=n(95),e.verifier=n(102),e.tokenize=n(98),e.parse=n(97),e.common=n(100),e.ReflectionObject=n(23),e.Namespace=n(33),e.Root=n(40),e.Enum=n(10),e.Type=n(22),e.Field=n(16),e.OneOf=n(34),e.MapField=n(67),e.Service=n(41),e.Method=n(68),e.converter=n(106),e.decoder=n(104),e.Message=n(69),e.wrappers=n(105),e.types=n(24),e.util=n(3),e.configure=r,e.load=t,e.loadSync=i,e.parseFromPbString=o,r(),arguments&&arguments.length)for(var s=0;s<arguments.length;s++){var a=arguments[s];if(a.hasOwnProperty("exports"))return void(a.exports=e)}return e}()},function(e,t,n){"use strict";e.exports=o;var i=null;try{i=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function o(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}o.prototype.__isLong__,Object.defineProperty(o.prototype,"__isLong__",{value:!0}),o.isLong=r;var s={},a={};function c(e,t){var n,i,o;return t?(o=0<=(e>>>=0)&&e<256)&&(i=a[e])?i:(n=d(e,(0|e)<0?-1:0,!0),o&&(a[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(i=s[e])?i:(n=d(e,e<0?-1:0,!1),o&&(s[e]=n),n)}function u(e,t){if(isNaN(e))return t?y:v;if(t){if(e<0)return y;if(e>=m)return C}else{if(e<=-g)return x;if(e+1>=g)return I}return e<0?u(-e,t).neg():d(e%h|0,e/h|0,t)}function d(e,t,n){return new o(e,t,n)}o.fromInt=c,o.fromNumber=u,o.fromBits=d;var l=Math.pow;function f(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return v;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return f(e.substring(1),t,n).neg();for(var o=u(l(n,8)),r=v,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+a),n);if(a<8){var d=u(l(n,a));r=r.mul(d).add(u(c))}else r=(r=r.mul(o)).add(u(c))}return r.unsigned=t,r}function p(e,t){return"number"==typeof e?u(e,t):"string"==typeof e?f(e,t):d(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}o.fromString=f,o.fromValue=p;var h=4294967296,m=h*h,g=m/2,_=c(1<<24),v=c(0);o.ZERO=v;var y=c(0,!0);o.UZERO=y;var b=c(1);o.ONE=b;var w=c(1,!0);o.UONE=w;var S=c(-1);o.NEG_ONE=S;var I=d(-1,2147483647,!1);o.MAX_VALUE=I;var C=d(-1,-1,!0);o.MAX_UNSIGNED_VALUE=C;var x=d(0,-2147483648,!1);o.MIN_VALUE=x;var E=o.prototype;E.toInt=function(){return this.unsigned?this.low>>>0:this.low},E.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},E.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(x)){var t=u(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=u(l(e,6),this.unsigned),r=this,s="";;){var a=r.div(o),c=(r.sub(a.mul(o)).toInt()>>>0).toString(e);if((r=a).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},E.getHighBits=function(){return this.high},E.getHighBitsUnsigned=function(){return this.high>>>0},E.getLowBits=function(){return this.low},E.getLowBitsUnsigned=function(){return this.low>>>0},E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(x)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},E.isZero=function(){return 0===this.high&&0===this.low},E.eqz=E.isZero,E.isNegative=function(){return!this.unsigned&&this.high<0},E.isPositive=function(){return this.unsigned||this.high>=0},E.isOdd=function(){return 1==(1&this.low)},E.isEven=function(){return 0==(1&this.low)},E.equals=function(e){return r(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},E.eq=E.equals,E.notEquals=function(e){return!this.eq(e)},E.neq=E.notEquals,E.ne=E.notEquals,E.lessThan=function(e){return this.comp(e)<0},E.lt=E.lessThan,E.lessThanOrEqual=function(e){return this.comp(e)<=0},E.lte=E.lessThanOrEqual,E.le=E.lessThanOrEqual,E.greaterThan=function(e){return this.comp(e)>0},E.gt=E.greaterThan,E.greaterThanOrEqual=function(e){return this.comp(e)>=0},E.gte=E.greaterThanOrEqual,E.ge=E.greaterThanOrEqual,E.compare=function(e){if(r(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},E.comp=E.compare,E.negate=function(){return!this.unsigned&&this.eq(x)?x:this.not().add(b)},E.neg=E.negate,E.add=function(e){r(e)||(e=p(e));var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,c=e.low>>>16,u=0,l=0,f=0,h=0;return f+=(h+=o+(65535&e.low))>>>16,l+=(f+=i+c)>>>16,u+=(l+=n+a)>>>16,u+=t+s,d((f&=65535)<<16|(h&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},E.subtract=function(e){return r(e)||(e=p(e)),this.add(e.neg())},E.sub=E.subtract,E.multiply=function(e){if(this.isZero())return v;if(r(e)||(e=p(e)),i)return d(i.mul(this.low,this.high,e.low,e.high),i.get_high(),this.unsigned);if(e.isZero())return v;if(this.eq(x))return e.isOdd()?x:v;if(e.eq(x))return this.isOdd()?x:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(_)&&e.lt(_))return u(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,c=65535&e.high,l=e.low>>>16,f=65535&e.low,h=0,m=0,g=0,y=0;return g+=(y+=s*f)>>>16,m+=(g+=o*f)>>>16,g&=65535,m+=(g+=s*l)>>>16,h+=(m+=n*f)>>>16,m&=65535,h+=(m+=o*l)>>>16,m&=65535,h+=(m+=s*c)>>>16,h+=t*f+n*l+o*c+s*a,d((g&=65535)<<16|(y&=65535),(h&=65535)<<16|(m&=65535),this.unsigned)},E.mul=E.multiply,E.divide=function(e){if(r(e)||(e=p(e)),e.isZero())throw Error("division by zero");var t,n,o;if(i)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?d((this.unsigned?i.div_u:i.div_s)(this.low,this.high,e.low,e.high),i.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:v;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return w;o=y}else{if(this.eq(x))return e.eq(b)||e.eq(S)?x:e.eq(x)?b:(t=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?b:S:(n=this.sub(e.mul(t)),o=t.add(n.div(e)));if(e.eq(x))return this.unsigned?y:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=v}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),a=s<=48?1:l(2,s-48),c=u(t),f=c.mul(e);f.isNegative()||f.gt(n);)f=(c=u(t-=a,this.unsigned)).mul(e);c.isZero()&&(c=b),o=o.add(c),n=n.sub(f)}return o},E.div=E.divide,E.modulo=function(e){return r(e)||(e=p(e)),i?d((this.unsigned?i.rem_u:i.rem_s)(this.low,this.high,e.low,e.high),i.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},E.mod=E.modulo,E.rem=E.modulo,E.not=function(){return d(~this.low,~this.high,this.unsigned)},E.and=function(e){return r(e)||(e=p(e)),d(this.low&e.low,this.high&e.high,this.unsigned)},E.or=function(e){return r(e)||(e=p(e)),d(this.low|e.low,this.high|e.high,this.unsigned)},E.xor=function(e){return r(e)||(e=p(e)),d(this.low^e.low,this.high^e.high,this.unsigned)},E.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?d(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):d(0,this.low<<e-32,this.unsigned)},E.shl=E.shiftLeft,E.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?d(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):d(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},E.shr=E.shiftRight,E.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?d(this.low>>>e|t<<32-e,t>>>e,this.unsigned):d(32===e?t:t>>>e-32,0,this.unsigned)},E.shru=E.shiftRightUnsigned,E.shr_u=E.shiftRightUnsigned,E.toSigned=function(){return this.unsigned?d(this.low,this.high,!1):this},E.toUnsigned=function(){return this.unsigned?this:d(this.low,this.high,!0)},E.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},E.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},E.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},o.fromBytes=function(e,t,n){return n?o.fromBytesLE(e,t):o.fromBytesBE(e,t)},o.fromBytesLE=function(e,t){return new o(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},o.fromBytesBE=function(e,t){return new o(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t,n){"use strict";e.exports=function(e,t,n){var i=n||8192,o=i>>>1,r=null,s=i;return function(n){if(n<1||n>o)return e(n);s+n>i&&(r=e(i),s=0);var a=t.call(r,s,s+=n);return 7&s&&(s=1+(7|s)),a}}},function(e,t,n){"use strict";function i(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=128===n[3];function o(e,i,o){t[0]=e,i[o]=n[0],i[o+1]=n[1],i[o+2]=n[2],i[o+3]=n[3]}function r(e,i,o){t[0]=e,i[o]=n[3],i[o+1]=n[2],i[o+2]=n[1],i[o+3]=n[0]}function s(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t[0]}function a(e,i){return n[3]=e[i],n[2]=e[i+1],n[1]=e[i+2],n[0]=e[i+3],t[0]}e.writeFloatLE=i?o:r,e.writeFloatBE=i?r:o,e.readFloatLE=i?s:a,e.readFloatBE=i?a:s}():function(){function t(e,t,n,i){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,n,i);else if(isNaN(t))e(2143289344,n,i);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,n,i);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var r=Math.floor(Math.log(t)/Math.LN2);e((o<<31|r+127<<23|8388607&Math.round(t*Math.pow(2,-r)*8388608))>>>0,n,i)}}function n(e,t,n){var i=e(t,n),o=2*(i>>31)+1,r=i>>>23&255,s=8388607&i;return 255===r?s?NaN:o*(1/0):0===r?1401298464324817e-60*o*s:o*Math.pow(2,r-150)*(s+8388608)}e.writeFloatLE=t.bind(null,o),e.writeFloatBE=t.bind(null,r),e.readFloatLE=n.bind(null,s),e.readFloatBE=n.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=128===n[7];function o(e,i,o){t[0]=e,i[o]=n[0],i[o+1]=n[1],i[o+2]=n[2],i[o+3]=n[3],i[o+4]=n[4],i[o+5]=n[5],i[o+6]=n[6],i[o+7]=n[7]}function r(e,i,o){t[0]=e,i[o]=n[7],i[o+1]=n[6],i[o+2]=n[5],i[o+3]=n[4],i[o+4]=n[3],i[o+5]=n[2],i[o+6]=n[1],i[o+7]=n[0]}function s(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],n[4]=e[i+4],n[5]=e[i+5],n[6]=e[i+6],n[7]=e[i+7],t[0]}function a(e,i){return n[7]=e[i],n[6]=e[i+1],n[5]=e[i+2],n[4]=e[i+3],n[3]=e[i+4],n[2]=e[i+5],n[1]=e[i+6],n[0]=e[i+7],t[0]}e.writeDoubleLE=i?o:r,e.writeDoubleBE=i?r:o,e.readDoubleLE=i?s:a,e.readDoubleBE=i?a:s}():function(){function t(e,t,n,i,o,r){var s=i<0?1:0;if(s&&(i=-i),0===i)e(0,o,r+t),e(1/i>0?0:2147483648,o,r+n);else if(isNaN(i))e(0,o,r+t),e(2146959360,o,r+n);else if(i>17976931348623157e292)e(0,o,r+t),e((s<<31|2146435072)>>>0,o,r+n);else{var a;if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,o,r+t),e((s<<31|a/4294967296)>>>0,o,r+n);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=i*Math.pow(2,-c))>>>0,o,r+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,o,r+n)}}}function n(e,t,n,i,o){var r=e(i,o+t),s=e(i,o+n),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+r;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,o,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=n.bind(null,s,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function o(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=i(i)},function(e,t,n){"use strict";e.exports=function(e,t){for(var n=new Array(arguments.length-1),i=0,o=2,r=!0;o<arguments.length;)n[i++]=arguments[o++];return new Promise((function(o,s){n[i]=function(e){if(r)if(r=!1,e)s(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){r&&(r=!1,s(e))}}))}},function(e,t,n){"use strict";function i(){this._listeners={}}e.exports=i,i.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},i.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},i.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}},function(e,t,n){"use strict";var i=e.exports,o=i.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},r=i.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=o(e),i="";n&&(i=t.shift()+"/");for(var r=0;r<t.length;)".."===t[r]?r>0&&".."!==t[r-1]?t.splice(--r,2):n?t.splice(r,1):++r:"."===t[r]?t.splice(r,1):++r;return i+t.join("/")};i.resolve=function(e,t,n){return n||(t=r(t)),o(t)?t:(n||(e=r(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?r(e+"/"+t):t)}},function(e,t,i){"use strict";var o=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,s,a,c,u=o(i(5)),d=(0,o(i(7)).default)(),l="undefined"!=typeof FormData,f="undefined"!=typeof Blob,p=(!1).overrideMimeType||!1,h=l,m=h||!1,g=f||p,_=function(){},v="web",y="wx",b="zfb",w="tt",S="baidu",I="uni",C=function(e){for(var t=["canIUse","getSystemInfo"],n=0,i=t.length;n<i;n++)if(!e[t[n]])return!1;return!0};Object.keys||(Object.keys=(r=Object.prototype.hasOwnProperty,s=!{toString:null}.propertyIsEnumerable("toString"),c=(a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!==(0,u.default)(e)&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var t,n,i=[];for(t in e)r.call(e,t)&&i.push(t);if(s)for(n=0;n<c;n++)r.call(e,a[n])&&i.push(a[n]);return i}));var x={hasFormData:l,hasBlob:f,emptyfn:_,isCanSetRequestHeader:!0,hasOverrideMimeType:p,isCanUploadFileAsync:h,isCanUploadFile:m,isCanDownLoadFile:g,isSupportWss:!0,hasFlash:!1,xmlrequest:!1,stringify:function(e){if("undefined"!=typeof JSON&&JSON.stringify)return JSON.stringify(e);var t="",n=[];return function e(i){var o=!1;for(var r in"[object Array]"===Object.prototype.toString.call(i)?(n.push("]","["),o=!0):"[object Object]"===Object.prototype.toString.call(i)&&n.push("}","{"),i)"[object Null]"===Object.prototype.toString.call(i[r])?i[r]="null":"[object Undefined]"===Object.prototype.toString.call(i[r])&&(i[r]="undefined"),i[r]&&"object"===(0,u.default)(i[r])?t+=","+(o?"":'"'+r+'":'+(o?'"':""))+e(i[r]):t+=',"'+(o?"":r+'":"')+i[r]+'"';return""!=t&&(t=t.slice(1)),n.pop()+t+n.pop()}(e)},login:function(e){var t=(e=e||{}).success||_,n=e.error||_,i=(e.appKey||"").split("#");if(2!==i.length)return n({type:d.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR}),!1;var o=i[0],r=i[1],s=s||e.https,a=e.user||"",c=e.pwd||"",u=e.apiUrl,l={grant_type:"password",username:a,password:c,timestamp:+new Date};return e={url:u+"/"+o+"/"+r+"/token",dataType:"json",data:x.stringify(l),success:t,error:n},x.ajax(e)},getFileUrl:function(e){var t={url:"",filename:"",filetype:"",data:""},n="string"==typeof e?document.getElementById(e):e;if(!x.isCanUploadFileAsync||!n)return t;try{if(window.URL.createObjectURL){var i=n.files;if(i.length>0){var o=i.item(0);t.data=o,t.url=window.URL.createObjectURL(o),t.filename=o.name||""}}else{o=document.getElementById(e).value,t.url=o;var r=o.lastIndexOf("/"),s=o.lastIndexOf("\\"),a=Math.max(r,s);t.filename=a<0?o:o.substring(a+1)}var c=t.filename.lastIndexOf(".");return-1!=c&&(t.filetype=t.filename.substring(c+1).toLowerCase()),t}catch(e){throw e}},getFileSize:function(e){var t=document.getElementById(e),n=0;return t&&t.files&&t.files.length>0&&(n=t.files[0].size),n},trim:function(e){return(e="string"==typeof e?e:"").trim?e.trim():e.replace(/^\s|\s$/g,"")},parseLink:function(e){return e.replace(/(https?\:\/\/|www\.)([a-zA-Z0-9-]+(\.[a-zA-Z0-9]+)+)(\:[0-9]{2,4})?\/?((\.[:_0-9a-zA-Z-]+)|[:_0-9a-zA-Z-]*\/?)*\??[:_#@*&%0-9a-zA-Z-/=]*/gm,(function(e){return"<a href='"+(/^https?/gm.test(e)?e:"//"+e)+"' target='_blank'>"+e+"</a>"}))},parseJSON:function(e){if(window.JSON&&window.JSON.parse)return window.JSON.parse(e+"");var t,n=null,i=x.trim(e+"");return i&&!x.trim(i.replace(/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g,(function(e,i,o,r){return t&&i&&(n=0),0===n?e:(t=o||i,n+=!r-!o,"")})))?Function("return "+i)():Function("Invalid JSON: "+e)()},parseUploadResponse:function(e){return e.indexOf("callback")>-1?e.slice(9,-1):e},parseDownloadResponse:function(e){return e&&e.type&&"application/json"===e.type||0>Object.prototype.toString.call(e).indexOf("Blob")?this.url+"?token=":window.URL.createObjectURL(e)},uploadFile:function(e){(e=e||{}).onFileUploadProgress=e.onFileUploadProgress||_,e.onFileUploadComplete=e.onFileUploadComplete||_,e.onFileUploadError=e.onFileUploadError||_,e.onFileUploadCanceled=e.onFileUploadCanceled||_;var t=e.accessToken||this.context.accessToken;if(t){var n,i,o,r=e.appKey||this.context.appKey||"";if(r&&(n=(o=r.split("#"))[0],i=o[1]),n||i){var s=e.apiUrl;this.isHttpDNS&&(s=this.apiUrl);var a=e.uploadUrl||s+"/"+n+"/"+i+"/chatfiles";if(x.isCanUploadFileAsync)if((e.file.data?e.file.data.size:void 0)<=0)e.onFileUploadError({type:d.WEBIM_UPLOADFILE_ERROR,id:e.id});else{var c=x.xmlrequest();c.upload&&c.upload.addEventListener("progress",e.onFileUploadProgress,!1),c.addEventListener?(c.addEventListener("abort",e.onFileUploadCanceled,!1),c.addEventListener("load",(function(t){try{var n=x.parseJSON(c.responseText);try{e.onFileUploadComplete(n)}catch(t){e.onFileUploadError({type:d.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,data:t})}}catch(t){e.onFileUploadError({type:d.WEBIM_UPLOADFILE_ERROR,data:c.responseText,id:e.id,xhr:c})}}),!1),c.addEventListener("error",(function(t){e.onFileUploadError({type:d.WEBIM_UPLOADFILE_ERROR,id:e.id,xhr:c})}),!1)):c.onreadystatechange&&(c.onreadystatechange=function(){if(4===c.readyState)if(200===ajax.status)try{var t=x.parseJSON(c.responseText);e.onFileUploadComplete(t)}catch(t){e.onFileUploadError({type:d.WEBIM_UPLOADFILE_ERROR,data:c.responseText,id:e.id,xhr:c})}else e.onFileUploadError({type:d.WEBIM_UPLOADFILE_ERROR,data:c.responseText,id:e.id,xhr:c});else c.abort(),e.onFileUploadCanceled()}),c.open("POST",a),c.setRequestHeader("restrict-access","true"),c.setRequestHeader("Accept","*/*"),c.setRequestHeader("Authorization","Bearer "+t);var u=new FormData;u.append("file",e.file.data),window.XDomainRequest&&(c.readyState=2),c.send(u)}else x.hasFlash&&"function"==typeof e.flashUpload?e.flashUpload&&e.flashUpload(a,e):e.onFileUploadError({type:d.WEBIM_UPLOADFILE_BROWSER_ERROR,id:e.id})}else e.onFileUploadError({type:d.WEBIM_UPLOADFILE_ERROR,id:e.id})}else e.onFileUploadError({type:d.WEBIM_UPLOADFILE_NO_LOGIN,id:e.id})},download:function(e){e.onFileDownloadComplete=e.onFileDownloadComplete||_,e.onFileDownloadError=e.onFileDownloadError||_;var t=e.accessToken||this.context.accessToken,n=x.xmlrequest();if(t)if(x.isCanDownLoadFile){"addEventListener"in n?(n.addEventListener("load",(function(t){e.onFileDownloadComplete(n.response,n)}),!1),n.addEventListener("error",(function(t){e.onFileDownloadError({type:d.WEBIM_DOWNLOADFILE_ERROR,id:e.id,xhr:n})}),!1)):"onreadystatechange"in n&&(n.onreadystatechange=function(){4===n.readyState?200===ajax.status?e.onFileDownloadComplete(n.response,n):e.onFileDownloadError({type:d.WEBIM_DOWNLOADFILE_ERROR,id:e.id,xhr:n}):(n.abort(),e.onFileDownloadError({type:d.WEBIM_DOWNLOADFILE_ERROR,id:e.id,xhr:n}))});var i=e.method||"GET",o=e.responseType||"blob",r=e.mimeType||"text/plain; charset=x-user-defined";n.open(i,e.url),"undefined"!=typeof Blob?n.responseType=o:n.overrideMimeType(r);var s={"X-Requested-With":"XMLHttpRequest",Accept:"application/octet-stream","share-secret":e.secret,Authorization:"Bearer "+t},a=e.headers||{};for(var c in a)s[c]=a[c];for(var c in s)s[c]&&n.setRequestHeader(c,s[c]);window.XDomainRequest&&(n.readyState=2),n.send(null)}else e.onFileDownloadComplete();else e.onFileDownloadError({type:d.WEBIM_DOWNLOADFILE_NO_LOGIN,id:e.id})},parseTextMessage:function(e,t){if("string"==typeof e){if("[object Object]"!==Object.prototype.toString.call(t))return{isemoji:!1,body:[{type:"txt",data:e}]};var n=e,i=[],o=n.match(/\[[^[\]]{2,3}\]/gm);if(!o||o.length<1)return{isemoji:!1,body:[{type:"txt",data:e}]};for(var r=!1,s=0;s<o.length;s++){var a=n.substring(0,n.indexOf(o[s])),c=t.map[o[s]];if(a&&i.push({type:"txt",data:a}),c){var u=t.map?t.path+c:null;u?(r=!0,i.push({type:"emoji",data:u})):i.push({type:"txt",data:o[s]});var d=n.indexOf(o[s])+o[s].length;n=n.substring(d)}else i.push({type:"txt",data:o[s]})}return n&&i.push({type:"txt",data:n}),r?{isemoji:r,body:i}:{isemoji:!1,body:[{type:"txt",data:e}]}}},ajax:function(e){return new Promise((function(t,n){var i=e.success||_,o=e.error||_,r=e.type||"POST",s=e.data||null,a="",c=x.getEnvInfo();if("get"===r.toLowerCase()&&s){for(var u in s)s.hasOwnProperty(u)&&(a+=u+"="+s[u]+"&");a=a?a.slice(0,-1):a,e.url+=(e.url.indexOf("?")>0?"&":"?")+(a?a+"&":a)+"_v="+(new Date).getTime(),s=null,a=null}var d={url:e.url,data:e.data,method:r,success:function(e){"200"==e.statusCode||"200"==e.status?(i(e.data),t(e.data)):(o(e),n(e))},complete:function(){},fail:function(e){o(e),n(e)}};"zfb"===c.platform?d.headers=e.headers:d.header=e.headers,c.global.request(d)}))},ts:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),i=e.getSeconds();return(t<10?"0"+t:t)+":"+(n<10?"0"+n:n)+":"+(i<10?"0"+i:i)+":"+e.getMilliseconds()+" "},getObjectKey:function(e,t){for(var n in e)if(e[n]==t)return n;return""},sprintf:function(){var e,t,n=arguments,i=n[0]||"";for(e=1,t=n.length;e<t;e++)i=i.replace(/%s/,n[e]);return i},reverse:function(e){var t=[];if(Array.prototype.reverse)t=e.reverse();else for(var n=0;n<e.length;n++)t.unshift(e[n]);return t},getEnv:function(){var e=!0;try{e=!window||!navigator}catch(t){e=!0}return e},getEnvInfo:function(){return"undefined"!=typeof swan&&C(swan)?{platform:S,global:swan}:"undefined"!=typeof tt&&C(tt)?{platform:w,global:tt}:"undefined"!=typeof my&&C(my)?{platform:b,global:my}:"undefined"!=typeof n&&C(n)?{platform:y,global:n}:"undefined"!=typeof uni&&C(uni)?{platform:I,global:uni}:{platform:v,global:window}},checkArray:function(e,t){var n="off";if(e.forEach((function(e,i){if(e.name===t.name)return n="on",i})),"off"==n)return!1},_listenNetwork:function(e,t){}},E=x;t.default=E}])}))}).call(this,n("0de9")["default"],n("fe07")["default"])},f0c5:function(e,t,n){"use strict";function i(e,t,n,i,o,r,s,a,c,u){var d,l="function"===typeof e?e.options:e;if(c){l.components||(l.components={});var f=Object.prototype.hasOwnProperty;for(var p in c)f.call(c,p)&&!f.call(l.components,p)&&(l.components[p]=c[p])}if(u&&((u.beforeCreate||(u.beforeCreate=[])).unshift((function(){this[u.__module]=this})),(l.mixins||(l.mixins=[])).push(u)),t&&(l.render=t,l.staticRenderFns=n,l._compiled=!0),i&&(l.functional=!0),r&&(l._scopeId="data-v-"+r),s?(d=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=d):o&&(d=a?function(){o.call(this,this.$root.$options.shadowRoot)}:o),d)if(l.functional){l._injectStyles=d;var h=l.render;l.render=function(e,t){return d.call(t),h(e,t)}}else{var m=l.beforeCreate;l.beforeCreate=m?[].concat(m,d):[d]}return{exports:e,options:l}}n.d(t,"a",(function(){return i}))},f21b:function(e,t,n){"use strict";n.r(t);var i=n("b807"),o=n("4b97");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},f3d8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("0c53")["default"],o=n("01d4"),r={OPENED:"showEmoji",CLOSED:"emoji_list"},s={data:function(){return{show:r.CLOSED,emoji:i.Emoji,emojiObj:i.EmojiObj,interval:5e3,duration:1e3,autoplay:!1,indicatorDots:!0}},components:{},props:{},methods:{openEmoji:function(){this.setData({show:r.OPENED})},cancelEmoji:function(){this.setData({show:r.CLOSED})},sendEmoji:function(e){var t=e.target.dataset.emoji;this.$emit("newEmojiStr",{msg:t,type:o.EMOJI},{bubbles:!0,composed:!0})}}};t.default=s},f505:function(e,t,n){"use strict";n.r(t);var i=n("fc3f"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},f9c3:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("446c"));function o(e){return e&&e.__esModule?e:{default:e}}var r=n("92be"),s=n("25e4"),a={SHORT:"scroll_view_change",NORMAL:"scroll_view"},c=0,u="",d=!1,l={data:function(){return{view:a.NORMAL,toView:"",chatMsg:[],__visibility__:!1,isIPX:!1}},components:{audioMsg:i.default},props:{username:{type:Object,default:function(){return{}}}},created:function(){},beforeMount:function(){this.__visibility__=!0,0,c=0},moved:function(){},destroyed:function(){this.__visibility__=!1},mounted:function(e){var t=this;getApp().globalData.isIPX&&this.setData({isIPX:!0}),this.username=uni.username;var n=this.username,i=uni.getStorageSync("myUsername"),o=n.groupId?n.groupId+i:n.your+i,a=uni.getStorageSync(o)||[];this.renderMsg(null,null,a,o),uni.setStorageSync(o,null),s.on("em.error.sendMsgErr",(function(e){u=e.data.mid,d=!0})),r.on("newChatMsg",(function(e,i,r,s){t.curChatMsg=r,t.__visibility__&&(n.groupId?e.info.from!=n.groupId&&e.info.to!=n.groupId||s==o&&t.renderMsg(e,i,r,o,"newMsg"):e.info.from!=n.your&&e.info.to!=n.your||s==o&&t.renderMsg(e,i,r,o,"newMsg"))}))},methods:{normalScroll:function(){this.setData({view:a.NORMAL})},shortScroll:function(){this.setData({view:a.SHORT})},onTap:function(){this.$emit("msglistTap",null,{bubbles:!0})},previewImage:function(e){var t=e.target.dataset.url;uni.previewImage({urls:[t]})},getHistoryMsg:function(){var e=this,t=this.username,n=uni.getStorageSync("myUsername"),i=t.groupId?t.groupId+n:t.your+n,o=uni.getStorageSync("rendered_"+i)||[];if(c<o.length){var r=o.slice(-c-10,-c);this.setData({chatMsg:r.concat(e.chatMsg),toView:r[r.length-1].mid}),c+=r.length,10==r.length&&0,uni.stopPullDownRefresh()}},renderMsg:function(t,n,i,o,r){var s=uni.getStorageSync("rendered_"+o)||[];if(s=s.concat(i),s.length){"newMsg"==r?this.setData({chatMsg:this.chatMsg.concat(i),toView:s[s.length-1].mid}):this.setData({chatMsg:s.slice(-10),toView:s[s.length-1].mid}),uni.setStorageSync("rendered_"+o,s);var a=uni.getStorageSync(o)||[];a.map((function(e,t){i.map((function(n,i){n.mid==e.mid&&a.splice(t,1)}))})),uni.setStorageSync(o,a),c=s.slice(-10).length,setTimeout((function(){uni.pageScrollTo({scrollTop:5e3,duration:300,fail:function(t){e("log","\u6eda\u5931\u8d25\u4e86",t," at components/chat/msglist/msglist.vue:272")},complete:function(t){e("log","\u6eda\u5b8c\u4e86",t," at components/chat/msglist/msglist.vue:275")}})}),100),d&&this.renderFail(o)}},renderFail:function(e){var t=this,n=t.chatMsg;n.map((function(e){e.mid.substring(e.mid.length-10)==u.substring(u.length-10)&&(e.msg.data[0].isFail=!0,e.isFail=!0,t.setData({chatMsg:n}))})),t.curChatMsg[0].mid==u&&(t.curChatMsg[0].msg.data[0].isShow=!1,t.curChatMsg[0].isShow=!1),uni.setStorageSync("rendered_"+e,n),d=!1},clickMsg:function(e){"object"==typeof e.target.dataset.msg&&e.target.dataset.msg.msg.ext&&e.target.dataset.msg.msg.ext.msg_extension&&this.$emit("clickMsg",e.target.dataset.msg.msg.ext)}}};t.default=l}).call(this,n("0de9")["default"])},fc17:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i="1.8.2",o={v:i,version:i,type:["primary","success","info","error","warning"]};t.default=o},fc21:function(e,t,n){"use strict";function i(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rgb(0, 0, 0)",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgb(255, 255, 255)",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=o(e,!1),s=i[0],a=i[1],c=i[2],u=o(t,!1),d=u[0],l=u[1],f=u[2],p=(d-s)/n,h=(l-a)/n,m=(f-c)/n,g=[],_=0;_<n;_++){var v=r("rgb("+Math.round(p*_+s)+","+Math.round(h*_+a)+","+Math.round(m*_+c)+")");g.push(v)}return g}function o(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(e=e.toLowerCase(),e&&n.test(e)){if(4===e.length){for(var i="#",o=1;o<4;o+=1)i+=e.slice(o,o+1).concat(e.slice(o,o+1));e=i}for(var r=[],s=1;s<7;s+=2)r.push(parseInt("0x"+e.slice(s,s+2)));return t?"rgb(".concat(r[0],",").concat(r[1],",").concat(r[2],")"):r}if(/^(rgb|RGB)/.test(e)){var a=e.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(",");return a.map((function(e){return Number(e)}))}return e}function r(e){var t=e,n=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgb|RGB)/.test(t)){for(var i=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),o="#",r=0;r<i.length;r++){var s=Number(i[r]).toString(16);s=1==String(s).length?"0"+s:s,"0"===s&&(s+=s),o+=s}return 7!==o.length&&(o=t),o}if(!n.test(t))return t;var a=t.replace(/#/,"").split("");if(6===a.length)return t;if(3===a.length){for(var c="#",u=0;u<a.length;u+=1)c+=a[u]+a[u];return c}}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3;e=r(e);var n=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,i=e.toLowerCase();if(i&&n.test(i)){if(4===i.length){for(var o="#",s=1;s<4;s+=1)o+=i.slice(s,s+1).concat(i.slice(s,s+1));i=o}for(var a=[],c=1;c<7;c+=2)a.push(parseInt("0x"+i.slice(c,c+2)));return"rgba("+a.join(",")+","+t+")"}return i}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={colorGradient:i,hexToRgb:o,rgbToHex:r,colorToRgba:s};t.default=a},fc3f:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("25e4"),o={data:function(){return{messageNum:0,unReadSpotNum:0,groupInviteNum:0,unReadTotalNotNum:0,isIPX:!1}},components:{},props:{},mounted:function(){},onLoad:function(e){var t=this;i.on("em.subscribe",(function(){t.setData({messageNum:getApp().globalData.saveFriendList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length})})),i.on("em.unreadspot",(function(){t.setData({unReadSpotNum:getApp().globalData.unReadMessageNum})})),i.on("em.invite.joingroup",(function(){t.setData({groupInviteNum:getApp().globalData.saveGroupInvitedList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length})})),uni.setStorageSync("friendNotiData",getApp().globalData.saveFriendList),uni.setStorageSync("groupNotiData",getApp().globalData.saveGroupInvitedList)},onShow:function(){uni.hideHomeButton(),this.setData({messageNum:getApp().globalData.saveFriendList.length,unReadSpotNum:getApp().globalData.unReadMessageNum>99?"99+":getApp().globalData.unReadMessageNum,groupInviteNum:getApp().globalData.saveGroupInvitedList.length,unReadTotalNotNum:getApp().globalData.saveFriendList.length+getApp().globalData.saveGroupInvitedList.length}),getApp().globalData.isIPX&&this.setData({isIPX:!0})},methods:{into_friendNot:function(){uni.redirectTo({url:"../notification_friendDetail/friendDetail?myName="+uni.getStorageSync("myUsername")})},into_groupNot:function(){uni.redirectTo({url:"../notification_groupDetail/groupDetail?myName="+uni.getStorageSync("myUsername")})},tab_contact:function(){uni.redirectTo({url:"../main/main?myName="+uni.getStorageSync("myUsername")})},tab_chat:function(){uni.redirectTo({url:"../chat/chat"})},tab_setting:function(){uni.redirectTo({url:"../setting/setting"})}}};t.default=o},fe07:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Behavior=Ne,t.Component=Te,t.Page=Ee,t.nextTick=t.default=void 0;var i,o=r(n("8bbf"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return f(e)||l(e,t)||u(e,t)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,o=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done);i=!0)if(n.push(s.value),t&&n.length===t)break}catch(c){o=!0,r=c}finally{try{i||null==a["return"]||a["return"]()}finally{if(o)throw r}}return n}}function f(e){if(Array.isArray(e))return e}function p(e,t){e&&(t.mpOptions.data=e)}function h(t){t.components=e.__wxVueOptions.components}var m=Object.prototype.toString,g=Object.prototype.hasOwnProperty;function _(e){return"function"===typeof e}function v(e){return"[object Object]"===m.call(e)}function y(e,t){return g.call(e,t)}function b(){}function w(e){var t=Object.create(null);return function(n){var i=t[n];return i||(t[n]=e(n))}}var S=/-(\w)/g,I=w((function(e){return e.replace(S,(function(e,t){return t?t.toUpperCase():""}))})),C="__data__",x={created:"onServiceCreated",attached:"onServiceAttached",ready:"mounted",moved:"moved",detached:"destroyed"},E=Object.keys(x),O={show:"onPageShow",hide:"onPageHide",resize:"onPageResize"},T=Object.keys(O),N=["onLoad","onShow","onReady","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onPageScroll","onResize","onTabItemTap"];function R(e,t){var n=Object.create(null);Object.keys(e).forEach((function(t){var i=e[t];_(i)&&-1===N.indexOf(t)&&(n[t]=i)})),t.methods=n}function M(e,t){Object.keys(e).forEach((function(n){-1!==N.indexOf(n)&&(t[n]=e[n])}))}function k(e){var t={mixins:[],mpOptions:{}};return h(t),p(e.data,t),R(e,t),M(e,t),t}function A(e,t){e&&(t.mpOptions.properties=e)}function j(e,t){e&&(t.mpOptions.options=e)}function D(e,t){e&&(e.$emit&&(console.warn('Method "$emit" conflicts with an existing Vue instance method'),delete e.$emit),t.methods=e)}function P(e,t){E.forEach((function(n){y(e,n)&&(t[x[n]]||(t[x[n]]=[])).push(e[n])}))}var L={"wx://form-field":{},"wx://component-export":{}};function $(e){var t=e.behaviors,n=e.definitionFilter,i=[];if(Array.isArray(t)&&t.forEach((function(t){t="string"===typeof t?L[t]:t,t.definitionFilter&&(i.push(t.definitionFilter),t.definitionFilter.call(null,e,[]))})),_(n))return function(e){n(e,i)}}function U(e,t){$(e)}function B(e){var t=e.data,n=e.methods,i=e.behaviors,o=e.properties,r={watch:{},mpOptions:{mpObservers:[]}};return p(t,r),D(n,r),W(i,r),A(o,r),P(e,r),U(e),r}var F={"wx://form-field":{beforeCreate:function(){var e=this.$options.mpOptions;e.properties||(e.properties=Object.create(null));var t=e.properties;y(t,"name")||(t.name={type:String}),y(t,"value")||(t.value={type:String})}}};function W(e,t){e&&e.forEach((function(e){"string"===typeof e?F[e]&&t.mixins.push(F[e]):t.mixins.push(B(e))}))}function V(e){return e.split(".")}function G(e){return e.split(",").map((function(e){return V(e)}))}function q(e,t){if(e){var n=t.mpOptions.mpObservers;Object.keys(e).forEach((function(t){n.push({paths:G(t),observer:e[t]})}))}}function H(e,t){0===t.indexOf("/")&&(e="");var n=e.split("/"),i=t.split("/");n.pop();while(i.length){var o=i.shift();""!==o&&"."!==o&&(".."!==o?n.push(o):n.pop())}return n.join("/")}function J(t,n){t&&(Object.keys(t).forEach((function(n){var i=t[n];i.name=n,i.target=i.target?String(i.target):H(e.__wxRoute,n)})),n.mpOptions.relations=t)}function K(e,t){e&&(Array.isArray(e)||(e=[e]),t.mpOptions.externalClasses=e,t.mpOptions.properties||(t.mpOptions.properties=Object.create(null)),e.forEach((function(e){t.mpOptions.properties[I(e)]={type:String,value:""}})))}function z(e,t){e&&P(e,t)}function X(e,t){e&&T.forEach((function(n){var i=e[n];_(i)&&(t[O[n]]=i)}))}function Y(e){var t=e.data,n=e.options,i=e.methods,o=e.behaviors,r=e.lifetimes,s=e.observers,a=e.relations,c=e.properties,u=e.pageLifetimes,d=e.externalClasses,l={mixins:[],props:{},watch:{},mpOptions:{mpObservers:[]}};return h(l),p(t,l),j(n,l),D(i,l),W(o,l),z(r,l),q(s,l),J(a,l),A(c,l),X(u,l),K(d,l),P(e,l),U(e),l}function Z(e,t,n,i){if(t){var o="_$".concat(e,"Handlers");(i[o]||(i[o]=[])).push((function(){t.call(i,n)}))}}function Q(e,t,n){var i="linked",o=e.name,r=n._$relationNodes||(n._$relationNodes=Object.create(null));(r[o]||(r[o]=[])).push(t),Z(i,e[i],t,n)}function ee(e,t,n){var i="unlinked";Z(i,e[i],t,n)}function te(e,t,n){var i=e&&e.$options.mpOptions&&e.$options.mpOptions.relations;if(!i)return[];var o=Object.keys(i).find((function(e){var o=i[e];return o.target===t&&o.type===n}));return o?[i[o],e]:[]}function ne(e,t,n){var i=n(e,e.$options.mpOptions.path),o=a(i,2),r=o[0],s=o[1];r&&(Q(r,e,s),Q(t,s,e),ee(r,e,s),ee(t,s,e))}function ie(e,t){var n=e.type;"parent"===n?ne(t,e,(function(e,t){return te(e.$parent,t,"child")})):"ancestor"===n&&ne(t,e,(function(e,t){var n=e.$parent;while(n){var i=te(n,t,"descendant");if(i.length)return i;n=n.$parent}return[]}))}function oe(e){var t=e.$options.mpOptions||{},n=t.relations;n&&Object.keys(n).forEach((function(t){ie(n[t],e)}))}function re(e,t){var n=e["_$".concat(t,"Handlers")];n&&n.forEach((function(e){return e()}))}var se={enumerable:!0,configurable:!0,get:b,set:b};function ae(e,t,n){se.get=function(){return this[t][n]},se.set=function(e){this[t][n]=e},Object.defineProperty(e,n,se)}function ce(e,t,n){var i=e.replace(/\[(\d+?)\]/g,".$1").split(".");return i.reduce((function(e,n,o){if(o!==i.length-1)return"undefined"===typeof e[n]&&(e[n]={}),e[n];e[n]=t}),n),1===i.length}function ue(e,t){var n=this;v(e)&&(Object.keys(e).forEach((function(t){ce(t,e[t],n.data)&&!y(n,t)&&ae(n,C,t)})),this.$forceUpdate(),_(t)&&this.$nextTick(t))}var de=Object.prototype.toString,le=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,i=de.call(n);if("[object Array]"===i)return t=n.slice(0),t;if("[object Object]"===i){for(var o in n)t[o]=e(t[o],n[o]);return t}if("[object Date]"===i)return new Date(n.getTime());if("[object RegExp]"===i){var r=String(n),s=r.lastIndexOf("/");return new RegExp(r.slice(1,s),r.slice(s+1))}return n},fe=function(e){return le("[object Array]"===de.call(e)?[]:{},e)},pe=(i={},s(i,String,""),s(i,Number,0),s(i,Boolean,!1),s(i,Object,null),s(i,Array,[]),s(i,null,null),i);function he(e){return pe[e]}function me(e){return v(e)?y(e,"value")?e.value:he(e.type):he(e)}function ge(e){return v(e)?e.type:e}function _e(e,t,n,i){var o=n[e];if(void 0!==o){var r=t[e],s=ge(r);o=ve(o,s);var a=r&&r.observer;return a&&setTimeout((function(){ye(a,i,o)}),4),o}return me(t[e])}function ve(e,t){return t===Boolean?!!e:t===String?String(e):e}function ye(e,t,n,i){try{"function"===typeof e?e.call(t,n,i):"string"===typeof e&&"function"===typeof t[e]&&t[e](n,i)}catch(o){console.error("execute observer ".concat(e," callback fail! err: ").concat(o))}}function be(e,t){var n=e.$options.mpOptions.properties;if(n){var i=fe(e.$options.propsData)||{},o=function(o){var r=!!v(n[o])&&n[o].observer,s=_e(o,n,i,e);Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:function(){return s},set:function(t){var n=s;t===s||t!==t&&s!==s||(s=Array.isArray(t)?t.slice(0):t,r&&ye(r,e,t,n),e.$forceUpdate())}})};for(var r in n)o(r)}}function we(e){var t=e.$options.mpOptions&&e.$options.mpOptions.properties,n=e.$options.propsData;n&&t&&Object.keys(t).forEach((function(i){y(n,i)&&(e[i]=ve(n[i],ge(t[i])))}))}function Se(e){var t=JSON.parse(JSON.stringify(e.$options.mpOptions.data||{}));e[C]=t;var n={get:function(){return e[C]},set:function(t){e[C]=t}};Object.defineProperties(e,{data:n,properties:n}),e.setData=ue,be(e,t),Object.keys(t).forEach((function(t){ae(e,C,t)}))}function Ie(e){var t=e.$emit;e.triggerEvent=function(n,i,o){var r={dataset:e.$el.dataset},s={target:r,currentTarget:r,detail:i,preventDefault:b,stopPropagation:b};t.call(e,n,s)},e.$emit=function(){e.triggerEvent.apply(e,arguments)},e.getRelationNodes=function(t){return(e._$relationNodes&&e._$relationNodes[t]||[]).filter((function(e){return!e._isDestroyed}))},e._$updateProperties=we}function Ce(e){var t=e.$options.watch;t&&Object.keys(t).forEach((function(n){var i=t[n];if(i.mounted){var o=e[n],r=i.handler;"string"===typeof r&&(r=e[r]),r&&r.call(e,o,o)}}))}var xe={beforeCreate:function(){this._renderProxy=this,this._$self=this,this._$noop=b},created:function(){Se(this),Ie(this),oe(this)},mounted:function(){Ce(this)},destroyed:function(){re(this,"unlinked")}};function Ee(t){var n=k(t);n.mixins.unshift(xe),n.mpOptions.path=e.__wxRoute,e.__wxComponents[e.__wxRoute]=n}function Oe(e){e.onServiceAttached||(e.onServiceAttached=[]),e.onServiceAttached.push((function(){re(this,"linked")}))}function Te(t){var n=Y(t);n.mixins.unshift(xe),n.mpOptions.path=e.__wxRoute,Oe(n),e.__wxComponents[e.__wxRoute]=n}function Ne(e){return e}e.__wxRoute="",e.__wxComponents=Object.create(null),e.__wxVueOptions=Object.create(null);var Re=o.default.nextTick;t.nextTick=Re;var Me=uni.__$wx__,ke=Me;t.default=ke}).call(this,n("c8ba"))},fe6f:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("view",[e._$s(2,"i",e.search_btn)?n("view",{staticClass:e._$s(2,"sc","search"),attrs:{_i:2}},[n("view",{attrs:{_i:3},on:{click:e.openSearch}},[n("icon",{}),n("text")])]):e._e()]),n("view",{staticClass:e._$s(6,"sc","main_body"),attrs:{_i:6}},[n("view",[n("scroll-view",{class:e._$s(8,"c","content "+(e.gotop?e.isIPX?"goTopX":"goTop":"goback")),style:e._$s(8,"s","padding-bottom: "+(e.isIPX?"270rpx":"226rpx")),attrs:{"scroll-into-view":e._$s(8,"a-scroll-into-view",e.toView),_i:8}},[e._$s(9,"i",e.search_friend)?n("view",{staticClass:e._$s(9,"sc","search_input"),attrs:{_i:9}},[n("view",[n("icon",{}),n("input",{attrs:{value:e._$s(12,"a-value",e.input_code),_i:12},on:{confirm:e.onSearch,input:e.onInput}}),e._$s(13,"i",e.show_clear)?n("icon",{attrs:{_i:13},on:{click:function(t){return t.stopPropagation(),e.clearInput(t)}}}):e._e()]),n("text",{attrs:{_i:14},on:{click:e.cancel}})]):e._e(),n("view",{staticClass:e._$s(15,"sc","contain"),attrs:{_i:15}},[n("view",{staticClass:e._$s(16,"sc","otherItem"),attrs:{_i:16},on:{click:e.add_new}},[n("image",{attrs:{_i:17}}),n("text")]),n("view",{staticClass:e._$s(19,"sc","otherItem"),attrs:{_i:19},on:{click:e.into_groups}},[n("image",{attrs:{_i:20}}),n("text")])]),e._l(e._$s(22,"f",{forItems:e.listMain}),(function(t,i,o,r){return n("view",{key:e._$s(22,"f",{forIndex:o,key:i}),attrs:{id:e._$s("22-"+r,"a-id","inToView"+t.id),"data-id":e._$s("22-"+r,"a-data-id",t.id),_i:"22-"+r}},[n("view",{staticClass:e._$s("23-"+r,"sc","address_top"),attrs:{_i:"23-"+r}},[e._v(e._$s("23-"+r,"t0-0",e._s(t.region)))]),e._l(e._$s("24-"+r,"f",{forItems:t.brands}),(function(t,i,o,s){return n("view",{key:e._$s("24-"+r,"f",{forIndex:o,key:i}),attrs:{"data-username":e._$s("24-"+r+"-"+s,"a-data-username",t.name),_i:"24-"+r+"-"+s},on:{click:function(t){return t.stopPropagation(),e.delete_friend(t)}}},[n("swipe-delete",{attrs:{_i:"25-"+r+"-"+s}},[n("view",{staticClass:e._$s("26-"+r+"-"+s,"sc","tap_mask"),attrs:{"data-username":e._$s("26-"+r+"-"+s,"a-data-username",t.name),_i:"26-"+r+"-"+s},on:{click:function(t){return t.stopPropagation(),e.into_room(t)}}},[n("view",{staticClass:e._$s("27-"+r+"-"+s,"sc","address_bottom"),attrs:{"data-username":e._$s("27-"+r+"-"+s,"a-data-username",t.name),_i:"27-"+r+"-"+s},on:{click:function(t){return t.stopPropagation(),e.into_room(t)}}},[n("image",{attrs:{"data-username":e._$s("28-"+r+"-"+s,"a-data-username",t.name),_i:"28-"+r+"-"+s},on:{click:function(t){return t.stopPropagation(),e.into_room(t)}}}),n("text",{attrs:{"data-username":e._$s("29-"+r+"-"+s,"a-data-username",t.name),_i:"29-"+r+"-"+s},on:{click:function(t){return t.stopPropagation(),e.into_room(t)}}},[e._v(e._$s("29-"+r+"-"+s,"t0-0",e._s(t.name)))])])])])],1)}))],2)}))],2),n("view",{staticClass:e._$s(30,"sc","orientation_region"),attrs:{_i:30}},[e._l(e._$s(31,"f",{forItems:e.listMain}),(function(t,i,o,r){return[n("view",{key:e._$s(31,"f",{forIndex:o,keyIndex:0,key:i+"_0"}),class:e._$s("32-"+r,"c","orientation_city "+(e.isActive==t.id?"active":"")),attrs:{"data-id":e._$s("32-"+r,"a-data-id",t.id),_i:"32-"+r},on:{click:e.scrollToViewFn}},[e._v(e._$s("32-"+r,"t0-0",e._s(t.region)))])]}))],2)])]),n("view",{class:e._$s(33,"c",e.isIPX?"chatRoom_tab_X":"chatRoom_tab"),attrs:{_i:33}},[n("view",{staticClass:e._$s(34,"sc","tableBar"),attrs:{_i:34},on:{click:e.tab_chat}},[e._$s(35,"i",e.unReadSpotNum>0||"99+"==e.unReadSpotNum)?n("view",{class:e._$s(35,"c","em-unread-spot "+("99+"==e.unReadSpotNum?"em-unread-spot-litleFont":"")),attrs:{_i:35}},[e._v(e._$s(35,"t0-0",e._s("99+"==e.unReadSpotNum?e.unReadSpotNum:e.unReadSpotNum+e.unReadTotalNotNum)))]):e._e(),n("image",{class:e._$s(36,"c",e.unReadSpotNum>0||"99+"==e.unReadSpotNum?"haveSpot":""),attrs:{_i:36}}),n("text")]),n("view",{staticClass:e._$s(38,"sc","tableBar"),attrs:{_i:38}},[n("image",{attrs:{_i:39}}),n("text",{staticClass:e._$s(40,"sc","activeText"),attrs:{_i:40}})]),n("view",{staticClass:e._$s(41,"sc","tableBar"),attrs:{_i:41},on:{click:e.tab_setting}},[n("image",{attrs:{_i:42}}),n("text")])])])},r=[]},feef:function(e,t,n){"use strict";n.r(t);var i=n("2c05"),o=n("c033");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=c.exports},ff9a:function(e,t,n){"use strict";n.r(t);var i=n("6765"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a}},[["7617","app-config"]]]);